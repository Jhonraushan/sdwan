import{S as o}from"./firewall-C9mbeSo1.js";import{bU as l,u as b,cm as d}from"./index-BlEQ5104.js";function c(e,r){return r=typeof r=="function"?r:void 0,e&&e.length?l(e,void 0,r):[]}function u(e){return e[".type"]==="interface"?e:e.iface}function Z(e){return f(e)?e.openvpn_rw.ns_description:u(e)?u(e)[".name"]:""}function g(e,r){var t;if(!r)return;const n=u(e);if(n)return(t=r.interface)==null?void 0:t.find(s=>s.device===`@${n[".name"]}`)}function z(e,r){var n;if(r){const t=(n=r.zone)==null?void 0:n.find(s=>{var a;return(a=s.network)==null?void 0:a.includes(e[".name"])});if(t)return t}}function A(e,r){for(const n of r)for(const t of n.devices)if(t===x(e))return n.name}function B(e){const{t:r}=b();switch(e){case"lan":return"Green";case"wan":return"Red";case"guest":return"Blue";case"dmz":return"Orange";case"hotspot":case"vpn":case"unknown":case"unassigned":return"";default:return r("standalone.interfaces_and_devices.custom_zone")}}function F(e){switch(e){case"wan":return"bg-rose-100 text-rose-700 dark:bg-rose-700 dark:text-rose-50";case"lan":return"bg-green-100 text-green-700 dark:bg-green-700 dark:text-green-50";case"guest":return"bg-blue-100 text-blue-700 dark:bg-blue-700 dark:text-blue-50";case"dmz":case"unknown":return"bg-amber-100 text-amber-700 dark:bg-amber-700 dark:text-amber-50";case"hotspot":return"bg-sky-100 text-sky-700 dark:bg-sky-700 dark:text-sky-50";case"rwopenvpn":case"openvpn":case"ipsec":case"vpn":return"bg-teal-100 text-teal-700 dark:bg-teal-700 dark:text-teal-50";case"unassigned":return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-50";default:return"bg-violet-100 text-violet-700 dark:bg-violet-700 dark:text-violet-50"}}function W(e){switch(e){case"lan":return"border-green-700 dark:border-green-700";case"wan":return"border-rose-700 dark:border-rose-700";case"guest":return"border-blue-700 dark:border-blue-700";case"dmz":case"unknown":return"border-amber-700 dark:border-amber-700";case"hotspot":return"border-sky-700 dark:border-sky-700";case"vpn":return"border-teal-700 dark:border-teal-700";case"unassigned":return"border-gray-500 dark:border-gray-500";default:return"border-violet-700 dark:border-violet-700"}}function _(e){switch(e){case"lan":return"location-dot";case"wan":return"earth-americas";case"guest":return"users";case"dmz":return"shield";case"hotspot":return"wifi";case"rwopenvpn":case"openvpn":case"ipsec":case"vpn":return"globe";case"unassigned":return"unlock";case"unknown":return"warning";default:return"star"}}function D(e){if(!e)return"bg-gray-100 dark:bg-gray-500";switch(e){case"lan":return"bg-green-100 dark:bg-green-700";case"wan":return"bg-rose-100 dark:bg-rose-700";case"guest":return"bg-blue-100 dark:bg-blue-700";case"dmz":case"unknown":return"bg-amber-100 dark:bg-amber-700";case"hotspot":return"bg-sky-100 dark:bg-sky-700";case"vpn":return"bg-teal-100 dark:bg-teal-700";case"unassigned":return"bg-gray-100 dark:bg-gray-500";default:return"bg-violet-100 dark:bg-violet-700"}}function U(e){if(!e)return"text-gray-500 dark:text-gray-50";switch(e){case"lan":return"text-green-700 dark:text-green-50";case"wan":return"text-rose-700 dark:text-rose-50";case"guest":return"text-blue-700 dark:text-blue-50";case"dmz":return"text-amber-700 dark:text-amber-50";case"hotspot":return"text-sky-700 dark:text-sky-50";case"vpn":return"text-teal-700 dark:text-teal-50";default:return"text-violet-700 dark:text-violet-50"}}function p(e){return!!e.vid}function V(e){return(e==null?void 0:e.type)==="bridge"}function i(e){var r;return(e==null?void 0:e.proto)==="bonding"||((r=e.name)==null?void 0:r.startsWith("bond-"))&&!p(e)}function q(e){return i(e)&&!e.iface}function v(e){return i(e)&&e.iface}function k(e){return e.zone==="ipsec"}function m(e){return e.openvpn}function f(e){return e.openvpn_rw}function N(e){return m(e)||f(e)||k(e)}function S(e){return e.hotspot}function x(e){return e[".type"]==="interface"?e[".name"]||"-":e.name||"-"}function T(e,r){if(e.name!=o.WAN)return r.filter(n=>n.source==e.name).map(n=>n.destination).some(n=>n==o.WAN)}function C(e,r){return r.filter(n=>n.source==e.name&&n.destination!=o.WAN)}function E(e,r){return r.filter(n=>n.destination==e.name)}function R(e,r){if(!r)return[];const n=[],t=u(e),s=g(e,r);if(e.ipaddrs&&e.ipaddrs.length>0)for(const a of e.ipaddrs)(!s||!s.ipaddr||!s.ipaddr.includes(a.address))&&n.push(a.address);return t!=null&&t.ipaddr&&(!s||!s.ipaddr||!s.ipaddr.includes(t.ipaddr))&&n.push(t.ipaddr),i(e)&&n.length>0&&n.splice(0,1),c(n,d)}function j(e,r){if(!r)return[];if(e.ipv6!=="1")return[];const n=[],t=u(e),s=g(e,r);if(e.ip6addrs&&e.ip6addrs.length>0)for(const a of e.ip6addrs)(!s||!s.ip6addr||!s.ip6addr.includes(a.address))&&n.push(a.address);if(t!=null&&t.ip6addr){let a=t.ip6addr;a instanceof Array&&(a=a[0]),(!s||!s.ip6addr||!s.ip6addr.includes(a))&&n.push(a)}return c(n,d)}function G(e,r){if(p(e)){const n=y(e,r);return n==null?void 0:n.up}return e==null?void 0:e.up}function y(e,r){const n=e.ifname;return r.find(s=>s.name===n)}function H(e){const r=u(e);return e.ipv6==="1"||r.proto==="pppoe"&&e.ipv6==="auto"}export{E as A,T as B,F as C,H as D,_ as a,x as b,i as c,u as d,q as e,p as f,B as g,v as h,V as i,g as j,z as k,f as l,m,k as n,Z as o,S as p,R as q,j as r,N as s,G as t,A as u,W as v,D as w,U as x,y,C as z};
