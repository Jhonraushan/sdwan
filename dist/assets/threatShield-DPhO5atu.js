import{bR as he,u as ge,U as ye,ac as pe,r as s,c as Be,e as o,b$ as T,V as r,ag as H}from"./index-BlEQ5104.js";const Se=he("threatShield",()=>{const{t:n,te:q}=ge(),c=ye(),J=pe(),d=s([]),M=s(),O=s([]),Q=s([]),W=s([]),u=s(!1),v=s(!1),D=s(!1),f=s(!1),h=s(!1),g=s(!1),y=s(!1),p=s(!1),B=s(!1),k=s(!1),X=s(!1),S=s(""),m=s(""),_=s(""),w=s(""),b=s(""),L=s(""),E=s(""),C=s(""),Z=s(""),A=s(""),R=s(""),z=s(""),I=s(""),N=s(""),U=s(""),$=s(""),j=s(""),x=s(""),K=s(""),P=s(""),V=s(""),F=s(""),ee=Be(()=>d.value.some(e=>e.type==="enterprise"));async function se(){u.value=!0,S.value="",m.value="";try{const t=(await o("ns.threatshield","dns-list-blocklist")).data.data;d.value=t.sort(T("name")).reverse().sort(T("type")).reverse()}catch(e){console.error(e),S.value=n(r(e)),m.value=e.toString()}finally{u.value=!1}}async function te(){y.value=!0,I.value="",N.value="";try{const e=await o("ns.threatshield","dns-list-bypass");Q.value=e.data.data}catch(e){console.error(e),I.value=n(r(e)),N.value=e.toString()}finally{y.value=!1}}async function ne(e){p.value=!0,U.value="",$.value="";try{await o("ns.threatshield","dns-add-bypass",{address:e}),c.getChanges()}catch(t){throw console.error(t),t instanceof H||(U.value=n(r(t)),$.value=t.toString()),t}finally{p.value=!1}}async function ae(){v.value=!0,_.value="",w.value="";try{const e=await o("ns.threatshield","dns-list-blocked");W.value=e.data.data}catch(e){console.error(e),_.value=n(r(e)),w.value=e.toString()}finally{v.value=!1}}async function le(e,t=!1){k.value=!0,K.value="",P.value="";const l=t?"dns-edit-blocked":"dns-add-blocked";try{await o("ns.threatshield",l,e),t||J.createNotification({kind:"success",title:n("standalone.threat_shield_dns.blocked_domain_added_title"),description:n("standalone.threat_shield_dns.blocked_domain_added_description",{domain:e.address})})}catch(a){throw console.error(a),a instanceof H||(K.value=n(r(a)),P.value=a.toString()),a}finally{k.value=!1}}async function oe(e){B.value=!0,j.value="",x.value="";try{await o("ns.threatshield","dns-delete-bypass",{address:e}),c.getChanges()}catch(t){throw console.error(t),j.value=n(r(t)),x.value=t.toString(),t}finally{B.value=!1}}async function re(e){X.value=!0,V.value="",F.value="";try{await o("ns.threatshield","dns-delete-blocked",{address:e}),J.createNotification({kind:"success",title:n("standalone.threat_shield_dns.blocked_domain_deleted_title"),description:n("standalone.threat_shield_dns.blocked_domain_deleted_description",{domain:e})})}catch(t){throw console.error(t),V.value=n(r(t)),F.value=t.toString(),t}finally{X.value=!1}}async function ie(){D.value=!0,b.value="",L.value="";try{const e=await o("ns.threatshield","dns-list-settings");M.value=e.data.data}catch(e){console.error(e),b.value=n(r(e)),L.value=e.toString()}finally{D.value=!1}}async function ce(){f.value=!0,E.value="",C.value="";try{const e=await o("ns.threatshield","dns-list-zones");O.value=e.data.data}catch(e){console.error(e),E.value=n(r(e)),C.value=e.toString()}finally{f.value=!1}}async function de(e){h.value=!0,Z.value="",A.value="";try{await o("ns.threatshield","dns-edit-settings",e),c.getChanges()}catch(t){throw console.error(t),t instanceof H||(Z.value=n(r(t)),A.value=t.toString()),t}finally{h.value=!1}}async function ue(e,t){g.value=!0,R.value="",z.value="";try{await o("ns.threatshield","dns-edit-blocklist",{blocklist:e,enabled:t}),c.getChanges()}catch(l){throw console.error(l),R.value=n(r(l)),z.value=l.toString(),l}finally{g.value=!1}}function ve(e,t){var Y;const l=/[^a-zA-Z0-9-_]/g;t=t.replace(l,"");let a=!1;if(a=["name","type"].some(fe=>{const G=e[fe];return new RegExp(t,"i").test(G==null?void 0:G.replace(l,""))}),a)return a;const i=`standalone.threat_shield_dns.description_${e.name}`;return q(i)&&(a=new RegExp(t,"i").test((Y=n(i))==null?void 0:Y.replace(l,"")),a)?a:!1}function De(e,t){const l=/[^a-zA-Z0-9-_\\.]/g;return t=t.replace(l,""),["address","description"].some(a=>{const i=e[a];return new RegExp(t,"i").test(i==null?void 0:i.replace(l,""))})}return{dnsBlocklists:d,dnsSettings:M,dnsZones:O,dnsBypasses:Q,dnsBlockedDomains:W,isEnterprise:ee,loadingListDnsBlocklists:u,loadingListDnsSettings:D,loadingListDnsZones:f,loadingEditDnsSettings:h,loadingEditDnsBlocklist:g,loadingListDnsBypass:y,loadingAddDnsBypass:p,loadingDeleteDnsBypass:B,loadingListDnsBlockedDomains:v,loadingSaveDnsBlockedDomain:k,errorListDnsBlocklists:S,errorListDnsBlocklistsDetails:m,errorListDnsSettings:b,errorListDnsSettingsDetails:L,errorListDnsZones:E,errorListDnsZonesDetails:C,errorEditDnsSettings:Z,errorEditDnsSettingsDetails:A,errorEditDnsBlocklist:R,errorEditDnsBlocklistDetails:z,errorListDnsBypass:I,errorListDnsBypassDetails:N,errorListDnsBlockedDomains:_,errorListDnsBlockedDomainsDetails:w,errorAddDnsBypass:U,errorDeleteDnsBypass:j,errorDeleteDnsBypassDetails:x,errorAddDnsBypassDetails:$,errorSaveDnsBlockedDomain:K,errorSaveDnsBlockedDomainDetails:P,listDnsBlocklist:se,listDnsSettings:ie,listDnsZones:ce,listDnsBlockedDomains:ae,editDnsSettings:de,addDnsBypass:ne,deleteDnsBypass:oe,editDnsBlocklist:ue,listDnsBypass:te,saveDnsBlockedDomain:le,deleteDnsBlockedDomain:re,searchStringInDnsBlocklist:ve,searchStringInDnsBlockedDomain:De,errorDeleteDnsBlockedDomain:V,errorDeleteDnsBlockedDomainDetails:F}});export{Se as u};
