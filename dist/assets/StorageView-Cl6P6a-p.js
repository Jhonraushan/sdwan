import{d as F,u as K,r as p,c as H,o as R,g as U,h as r,q as m,k as g,w as v,m as i,t as o,l as e,W as D,j as t,i as x,L as j,n as f,y as A,av as G,H as L,_ as O,z as T,ar as J,aj as Q,Y as W,e as E,V as B}from"./index-BlEQ5104.js";const X={class:"flex flex-col gap-y-6"},Z={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},ee={key:2},ae={class:"flex max-w-3xl flex-row items-center rounded-md bg-white p-6 transition-colors duration-200 dark:bg-gray-800 sm:shadow"},te={class:"flex flex-col items-center justify-center self-stretch border-r pr-6 md:flex-row"},oe={class:"text-center text-sm md:text-start"},se={class:"font-semibold"},le={class:"ml-6 flex grow flex-col justify-between sm:flex-row sm:items-center"},ne={class:"text-sm"},re={key:0},ie={key:1},de={class:"max-w-5xl"},ue={class:"flex flex-col text-left text-sm"},ce={class:"mb-1 flex flex-row"},ge={class:"font-semibold"},me={class:"ml-2 text-gray-500 dark:text-gray-400"},ve={class:"font-semibold"},fe={key:0},_e={class:"font-semibold"},pe={key:1},ye={class:"font-semibold"},be={class:"list-disc"},ke={key:0},he={key:1},Ce=F({__name:"StorageView",setup(xe){const{t:a}=K(),V=p(!0),u=p(!1),c=p({fetchError:"",modalError:""}),_=p([]),y=p(""),d=p(null),z=p(!1),S=p(!1),M=H(()=>_.value.map(n=>({id:n.path,label:n.name,icon:n.type=="disk"?"database":"hard-drive",type:n.type}))),w=H(()=>{var n;return(n=_.value.find(l=>l.path===y.value))==null?void 0:n.type});async function $(){try{V.value=!0,_.value=(await E("ns.storage","list-devices")).data.devices,d.value=(await E("ns.storage","get-configuration")).data,V.value=!1}catch(n){c.value.fetchError=a(B(n))}}function C(){z.value=!1,S.value=!1,c.value.modalError=""}async function Y(){try{u.value=!0,await E("ns.storage","add-storage",{device:y.value,type:w.value}),C(),await $()}catch(n){c.value.modalError=a(B(n))}finally{u.value=!1}}async function q(){try{u.value=!0,await E("ns.storage","remove-storage"),C(),await $()}catch(n){c.value.modalError=a(B(n))}finally{u.value=!1}}return R(()=>{$()}),(n,l)=>{var I;const N=U("font-awesome-icon");return r(),m(T,null,[g(e(D),{tag:"h3",class:"mb-7"},{default:v(()=>[i(o(e(a)("standalone.storage.title")),1)]),_:1}),t("div",X,[t("p",Z,o(e(a)("standalone.storage.description")),1),c.value.fetchError?(r(),x(e(j),{key:0,kind:"error",title:e(a)("error.cannot_retrieve_storage_configuration"),description:c.value.fetchError},null,8,["title","description"])):f("",!0),V.value?(r(),x(e(A),{key:1,lines:10})):(I=d.value)!=null&&I.name?(r(),m("div",ee,[g(e(D),{tag:"h6",class:"mb-1.5"},{default:v(()=>[i(o(e(a)("standalone.storage.storage_configuration")),1)]),_:1}),t("div",ae,[t("div",te,[g(N,{icon:d.value.type=="disk"?["fas","database"]:["fas","hard-drive"],"aria-hidden":"true",class:G("mb-2 h-5 w-5 rounded-full bg-gray-100 p-4 text-gray-500 dark:bg-gray-500 dark:text-gray-50 md:mb-0 md:mr-5")},null,8,["icon"]),t("div",oe,[t("p",se,o(e(a)("standalone.storage."+d.value.type)),1),t("p",null,o(d.value.path),1)])]),t("div",le,[t("div",ne,[t("p",null,[t("strong",null,o(e(a)("standalone.storage.size"))+":",1),i(" "+o(e(L)(parseInt(d.value.size??"0"))??e(a)("standalone.storage.unknown")),1)]),d.value.type=="disk"?(r(),m("p",re,[t("strong",null,o(e(a)("standalone.storage.model"))+":",1),i(" "+o(d.value.model??e(a)("standalone.storage.unknown")),1)])):f("",!0),d.value.type=="disk"?(r(),m("p",ie,[t("strong",null,o(e(a)("standalone.storage.vendor"))+":",1),i(" "+o(d.value.vendor??e(a)("standalone.storage.unknown")),1)])):f("",!0)]),t("div",null,[g(e(O),{kind:"danger",onClick:l[0]||(l[0]=s=>z.value=!0),class:"mt-2 sm:mt-0"},{prefix:v(()=>[g(N,{icon:["fas","trash"],class:"h-4 w-4","aria-hidden":"true"})]),default:v(()=>[i(o(e(a)("standalone.storage.remove_storage")),1)]),_:1})])])])])):M.value.length>0?(r(),m(T,{key:3},[t("div",de,[g(e(D),{tag:"h6",class:"mb-1.5"},{default:v(()=>[i(o(e(a)("standalone.storage.select_device")),1)]),_:1}),g(e(J),{options:M.value,"grid-style":"grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3",modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=s=>y.value=s),card:!0,label:"","card-size":"lg"},{option:v(({option:s})=>{var k,b,P;return[t("div",ue,[t("div",ce,[t("p",ge,o(e(a)("standalone.storage."+s.type)),1),t("p",me,o(s.id),1)]),t("p",null,[t("span",ve,o(e(a)("standalone.storage.size"))+":",1),i(" "+o(e(L)(parseInt(((k=_.value.find(h=>h.name==s.label))==null?void 0:k.size)??"0"))??e(a)("standalone.storage.unknown")),1)]),s.type=="disk"?(r(),m("p",fe,[t("span",_e,o(e(a)("standalone.storage.model"))+":",1),i(" "+o(((b=_.value.find(h=>h.name==s.label))==null?void 0:b.model)??e(a)("standalone.storage.unknown")),1)])):f("",!0),s.type=="disk"?(r(),m("p",pe,[t("span",ye,o(e(a)("standalone.storage.vendor"))+":",1),i(" "+o(((P=_.value.find(h=>h.name==s.label))==null?void 0:P.vendor)??e(a)("standalone.storage.unknown")),1)])):f("",!0)])]}),_:1},8,["options","modelValue"])]),t("div",null,[g(e(O),{kind:"primary",size:"lg",disabled:y.value==="",onClick:l[2]||(l[2]=s=>S.value=!0)},{default:v(()=>[i(o(w.value=="disk"?e(a)("standalone.storage.format_configure_storage"):e(a)("standalone.storage.configure_storage")),1)]),_:1},8,["disabled"])])],64)):(r(),x(e(Q),{key:4,icon:["fas","database"],title:e(a)("standalone.storage.no_device_found")},null,8,["title"]))]),g(e(W),{"primary-label":e(a)("standalone.storage.format_and_configure"),title:e(a)("standalone.storage.format_configure_storage"),"primary-button-loading":u.value,"primary-button-disabled":u.value,"cancel-label":e(a)("common.cancel"),visible:S.value,kind:"warning","primary-button-kind":"danger","close-aria-label":e(a)("common.close"),onClose:l[3]||(l[3]=s=>u.value?void 0:C()),onPrimaryClick:l[4]||(l[4]=s=>Y())},{default:v(()=>{var s,k;return[t("ul",be,[w.value==="disk"?(r(),m("li",ke,o(e(a)("standalone.storage.format_storage_warning",{device:(s=_.value.find(b=>b.path===y.value))==null?void 0:s.name})),1)):f("",!0),w.value==="partition"?(r(),m("li",he,o(e(a)("standalone.storage.new_partition",{device:(k=_.value.find(b=>b.path===y.value))==null?void 0:k.name})),1)):f("",!0),t("li",null,[i(o(e(a)("standalone.storage.configure_storage_logs_description"))+" ",1),l[7]||(l[7]=t("code",{class:"inline"},"/mnt/data/logs/messages",-1))]),t("li",null,o(e(a)("standalone.storage.configure_storage_extra_data_description")),1)]),c.value.modalError?(r(),x(e(j),{key:0,title:e(a)("error.cannot_configure_storage"),description:c.value.modalError,kind:"error",class:"my-6"},null,8,["title","description"])):f("",!0)]}),_:1},8,["primary-label","title","primary-button-loading","primary-button-disabled","cancel-label","visible","close-aria-label"]),g(e(W),{"primary-label":e(a)("standalone.storage.remove_storage"),"primary-button-loading":u.value,"primary-button-disabled":u.value,title:e(a)("standalone.storage.remove_storage"),visible:z.value,kind:"warning","primary-button-kind":"danger","close-aria-label":e(a)("common.close"),onClose:l[5]||(l[5]=s=>u.value?void 0:C()),onPrimaryClick:l[6]||(l[6]=s=>q())},{default:v(()=>{var s;return[i(o(e(a)("standalone.storage.remove_storage_warning",{storage:(s=d.value)==null?void 0:s.name}))+" ",1),c.value.modalError?(r(),x(e(j),{key:0,title:e(a)("error.cannot_remove_storage"),description:c.value.modalError,kind:"error",class:"my-6"},null,8,["title","description"])):f("",!0)]}),_:1},8,["primary-label","primary-button-loading","primary-button-disabled","title","visible","close-aria-label"])],64)}}});export{Ce as default};
