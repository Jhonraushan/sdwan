import{d as j,O as Ae,u as M,r as y,aa as re,aZ as pe,J as je,g as J,h as f,i as k,w as i,l as e,L as H,M as Y,m as w,t as p,n as F,y as ce,q as T,k as r,a5 as oe,Q as G,s as X,j as C,_ as O,z as N,ai as me,e as U,V as z,ag as De,S as K,a_ as ie,a$ as Me,U as ae,c as _e,o as te,W as de,aj as Z,ad as ee,av as ue,B as Ne,x as ve,aI as ke,aK as Ce,ak as Se,al as q,am as $e,an as Le,ao as P,ap as ge,aq as xe,Y as Te,a3 as he,b0 as Oe,a as Ue,v as ze,b1 as qe,a4 as Pe,a9 as Ke}from"./index-BlEQ5104.js";import{_ as Ie}from"./NeMultiTextInput.vue_vue_type_script_setup_true_lang-DwfeP71-.js";import{u as ye}from"./firewall-C9mbeSo1.js";import{v as Ve}from"./network-qu7sidyZ.js";import{_ as Ee}from"./CannotDeleteObjectModal.vue_vue_type_script_setup_true_lang-CreS7bAa.js";import{_ as Ge}from"./NeTable.vue_vue_type_script_setup_true_lang-BDPau7Vg.js";/* empty css                                                */import{u as He}from"./useTabs-BeLQ169O.js";import"./isArrayLikeObject-CpCvCe5A.js";const Qe={key:2,class:"flex flex-col gap-y-6"},We={class:"flex justify-end"},Ye=j({__name:"EditDhcpInterfaceDrawer",props:{isShown:{type:Boolean},interfaceToEdit:{}},emits:["close","edit-interface"],setup(L,{emit:u}){const o=L,{isShown:s}=Ae(o),{t}=M(),_=u,c=y(!1),h=y(!0),d=y({notificationTitle:"",notificationDescription:"",notificationDetails:""}),a=y(new re),v=y([]),m=y([]),g=y(!1),I=y([]),V=y(""),E=y(!1),R=y(""),x=y(""),D=y(""),l=y([]),n=y(!0);async function b(){if(o.interfaceToEdit)try{h.value=!0;const $=(await U("ns.dhcp","get-interface",{interface:o.interfaceToEdit})).data;V.value=$.interface,R.value=$.first,x.value=$.last,D.value=$.leasetime,E.value=$.active,l.value=$.options.map(S=>{const W=Object.keys(S)[0];return{key:W,value:S[W]}}),n.value=$.force,h.value=!1}catch($){d.value.notificationTitle=t("error.cannot_retrieve_interface_details"),d.value.notificationDescription=$.response.data.message=="interface_not_found"?t("standalone.dns_dhcp.interface_not_found"):t(z($)),d.value.notificationDetails=$.toString()}else V.value="",E.value=!1,R.value="",x.value="",D.value="",l.value=[],n.value=!0}function A($,S){for(let W of $)W.valid||a.value.set(S,[W.errMessage]);return $.every(W=>W.valid)}async function Q(){try{h.value=!0;const $=(await U("ns.dhcp","list-dhcp-options")).data;I.value=Object.keys($).map(S=>({id:S,label:`${$[S]}: ${S}`})),h.value=!1}catch($){d.value.notificationTitle=t("error.cannot_retrieve_dhcp_options"),d.value.notificationDescription=t(z($)),d.value.notificationDetails=$.toString()}}function le(){a.value.clear(),v.value=[],l.value.forEach(()=>{v.value.push("")}),m.value=[],l.value.forEach(()=>{m.value.push("")});let $=!0;for(let[B,ne]of l.value.entries()){let se=K(ne.value);if(!se.valid){v.value[B]=t(se.errMessage),$=!1;break}}let S=!0;for(let[B,ne]of l.value.entries()){let se=K(ne.key);if(!se.valid){m.value[B]=t(se.errMessage),S=!1;break}}return[[[K(R.value),ie(R.value)],"first"],[[K(x.value),ie(x.value)],"last"],[[K(D.value),Me(D.value)],"leasetime"]].map(([B,ne])=>A(B,ne)).every(B=>B)&&$&&S}async function Be(){d.value.notificationTitle="",d.value.notificationDescription="",d.value.notificationDetails="";try{c.value=!0,le()&&(await U("ns.dhcp","edit-interface",{interface:V.value,first:R.value,last:x.value,active:E.value,leasetime:D.value,options:l.value.map($=>({[$.key]:$.value})),force:n.value}),_("edit-interface"),fe())}catch($){$ instanceof De?a.value=$.errorBag:(d.value.notificationTitle=t("error.cannot_edit_interface"),d.value.notificationDescription=$.response.data.message=="interface_not_found"?t("standalone.dns_dhcp.interface_not_found"):t(z($)),d.value.notificationDetails=$.toString())}finally{c.value=!1}}function fe(){a.value.clear(),d.value.notificationTitle="",d.value.notificationDescription="",d.value.notificationDetails="",v.value=[],m.value=[],_("close")}return pe(()=>{b()}),je(()=>o.isShown,()=>{o.isShown&&Q()}),($,S)=>{const W=J("font-awesome-icon");return f(),k(e(me),{"is-shown":e(s),onClose:S[9]||(S[9]=B=>fe()),closeAriaLabel:e(t)("common.shell.close_side_drawer"),title:e(t)("standalone.dns_dhcp.edit_interface",{interface:V.value})},{default:i(()=>[d.value.notificationDescription?(f(),k(e(H),{key:0,title:d.value.notificationTitle,description:d.value.notificationDescription,class:"mb-6",kind:"error"},Y({_:2},[d.value.notificationDetails?{name:"details",fn:i(()=>[w(p(d.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),h.value?(f(),k(e(ce),{key:1,lines:10})):(f(),T("div",Qe,[r(e(oe),{modelValue:E.value,"onUpdate:modelValue":S[0]||(S[0]=B=>E.value=B),label:e(t)("standalone.dns_dhcp.enable_dhcp")},null,8,["modelValue","label"]),r(e(G),{modelValue:R.value,"onUpdate:modelValue":S[1]||(S[1]=B=>R.value=B),label:e(t)("standalone.dns_dhcp.range_ip_start"),"invalid-message":e(t)(a.value.getFirstI18nKeyFor("first"))},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:x.value,"onUpdate:modelValue":S[2]||(S[2]=B=>x.value=B),label:e(t)("standalone.dns_dhcp.range_ip_end"),"invalid-message":e(t)(a.value.getFirstI18nKeyFor("last"))},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:D.value,"onUpdate:modelValue":S[3]||(S[3]=B=>D.value=B),label:e(t)("standalone.dns_dhcp.lease_time"),"invalid-message":e(t)(a.value.getFirstI18nKeyFor("leasetime"))},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(t)("standalone.dns_dhcp.lease_time_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","invalid-message"]),C("div",null,[r(e(O),{kind:"tertiary",onClick:S[4]||(S[4]=B=>g.value=!g.value)},{suffix:i(()=>[r(W,{icon:["fas",g.value?"chevron-up":"chevron-down"],class:"h-4 w-4","aria-hidden":"true"},null,8,["icon"])]),default:i(()=>[w(p(e(t)("standalone.dns_dhcp.advanced_settings"))+" ",1)]),_:1})]),g.value?(f(),T(N,{key:0},[r(e(oe),{modelValue:n.value,"onUpdate:modelValue":S[5]||(S[5]=B=>n.value=B),label:e(t)("standalone.dns_dhcp.force_start")},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(t)("standalone.dns_dhcp.force_start_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label"]),r(Ie,{modelValue:l.value,"onUpdate:modelValue":S[6]||(S[6]=B=>l.value=B),title:e(t)("standalone.dns_dhcp.dhcp_option"),"use-key-input":!0,"key-input-type":"combobox","add-item-label":e(t)("standalone.dns_dhcp.add_dhcp_option"),optional:!0,"optional-label":e(t)("common.optional"),"key-options":I.value,"invalid-messages":v.value,"invalid-key-messages":m.value,"key-input-placeholder":e(t)("standalone.dns_dhcp.dhcp_option_combobox_placeholder")},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(t)("standalone.dns_dhcp.dhcp_option_tooltip")),1)]),_:1})]),_:1},8,["modelValue","title","add-item-label","optional-label","key-options","invalid-messages","invalid-key-messages","key-input-placeholder"])],64)):F("",!0),S[10]||(S[10]=C("hr",null,null,-1)),C("div",We,[r(e(O),{kind:"tertiary",class:"mr-4",onClick:S[7]||(S[7]=B=>fe())},{default:i(()=>[w(p(e(t)("common.cancel")),1)]),_:1}),r(e(O),{kind:"primary",onClick:S[8]||(S[8]=B=>Be()),disabled:c.value,loading:c.value},{default:i(()=>[w(p(e(t)("common.save")),1)]),_:1},8,["disabled","loading"])])]))]),_:1},8,["is-shown","closeAriaLabel","title"])}}}),Je={class:"mb-4 flex flex-row items-center justify-between"},Xe={key:1,class:"grid grid-cols-1 gap-4 md:grid-cols-2 2xl:grid-cols-3"},Ze={class:"flex grow flex-col gap-y-4 p-5"},ea={class:"flex flex-col"},aa={class:"flex flex-row items-start justify-between"},ta={class:"text-sm"},na={class:"flex flex-row content-start items-center"},sa={class:"grow text-sm"},la={class:"flex flex-col gap-y-4 rounded-md bg-gray-100 p-3 dark:bg-gray-900"},oa=["onClick"],ia={key:0,class:"flex flex-col gap-y-2"},da=j({__name:"DhcpManager",setup(L){const{t:u}=M(),o=ae(),s=ye(),t=y(!0),_=y({notificationDescription:"",notificationDetails:""}),c=y(""),h=y(!1),d=y({}),a=y({}),v=_e(()=>Object.keys(a.value).every(D=>a.value[D]));async function m(){try{t.value=!0,d.value=(await U("ns.dhcp","list-interfaces")).data,a.value=Object.fromEntries(Object.keys(d.value).map(D=>[D,!1])),t.value=!1}catch(D){_.value.notificationDescription=u(z(D)),_.value.notificationDetails=D.toString()}}function g(D){const l=s.zones.find(n=>n.interfaces.includes(D));return Ve((l==null?void 0:l.name)??"")}function I(D){c.value=D,h.value=!0}function V(){c.value="",h.value=!1}function E(){let D={};for(let l of Object.keys(a.value))D[l]=!v.value;a.value=D}function R(D){a.value[D]=!a.value[D]}async function x(){await m(),await o.getChanges()}return te(()=>{(s.loading||s.error)&&s.fetch(),m()}),(D,l)=>{const n=J("font-awesome-icon");return f(),T(N,null,[_.value.notificationDescription||e(s).error?(f(),k(e(H),{key:0,kind:"error",title:e(s).error?e(u)("error.cannot_retrieve_zones"):e(u)("error.cannot_retrieve_dhcp_interfaces"),description:e(s).error?e(u)(e(z)(e(s).error)):_.value.notificationDescription},Y({_:2},[_.value.notificationDetails||e(s).error?{name:"details",fn:i(()=>[w(p(e(s).error?e(s).error.toString():_.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),t.value||e(s).loading?(f(),k(e(ce),{key:1,lines:10})):e(s).error?F("",!0):(f(),T(N,{key:2},[C("div",Je,[r(e(de),{tag:"h6",class:"mb-1.5 grow"},{default:i(()=>[w(p(e(u)("standalone.dns_dhcp.interfaces")),1)]),_:1}),Object.keys(d.value).length>0?(f(),k(e(O),{key:0,kind:"tertiary",onClick:l[0]||(l[0]=b=>E())},{prefix:i(()=>[r(n,{icon:["fas",v.value?"down-left-and-up-right-to-center":"up-right-and-down-left-from-center"],class:"h-4 w-4","aria-hidden":"true"},null,8,["icon"])]),default:i(()=>[w(p(v.value?e(u)("standalone.dns_dhcp.collapse_all_cards"):e(u)("standalone.dns_dhcp.expand_all_cards")),1)]),_:1})):F("",!0)]),Object.keys(d.value).length==0?(f(),k(e(Z),{key:0,title:e(u)("standalone.dns_dhcp.no_interface_configured"),icon:["fas","circle-info"]},null,8,["title"])):(f(),T("div",Xe,[(f(!0),T(N,null,ee(d.value,(b,A)=>(f(),T("div",{key:A,class:ue(`overflow-hidden rounded-md border-l-4 bg-white text-sm text-gray-700 dark:bg-gray-950 dark:text-gray-200 sm:rounded-lg sm:shadow ${g(A)}`)},[C("div",Ze,[C("div",ea,[C("div",aa,[C("p",ta,[C("strong",null,p(A),1),l[3]||(l[3]=C("br",null,null,-1)),w(" "+p(b.device),1)]),r(e(Ne),{size:"sm",text:b.active?e(u)("standalone.dns_dhcp.active"):e(u)("standalone.dns_dhcp.inactive"),kind:b.active?"success":"secondary"},null,8,["text","kind"])])]),C("div",na,[C("p",sa,p(b.first)+" - "+p(b.last),1),r(e(O),{size:"sm",kind:"tertiary",onClick:Q=>I(A)},{prefix:i(()=>[r(n,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(p(e(u)("common.edit")),1)]),_:2},1032,["onClick"])]),C("div",la,[C("div",{class:"flex cursor-pointer flex-row items-center",onClick:Q=>R(A)},[r(n,{icon:["fas",a.value[A]?"circle-chevron-up":"circle-chevron-down"],class:"mr-2 h-4 w-4","aria-hidden":"true"},null,8,["icon"]),C("p",null,p(e(u)("standalone.dns_dhcp.options")),1)],8,oa),a.value[A]?(f(),T("div",ia,[(f(!0),T(N,null,ee(b.options,(Q,le)=>(f(),T("div",{class:"text-sm",key:le},[C("strong",null,p(le)+":",1),w(" "+p(Q),1)]))),128))])):F("",!0)])])],2))),128))]))],64)),r(Ye,{"is-shown":h.value,"interface-to-edit":c.value,onClose:l[1]||(l[1]=b=>V()),onEditInterface:l[2]||(l[2]=b=>x())},null,8,["is-shown","interface-to-edit"])],64)}}}),ra={class:"flex flex-col gap-y-6"},ca={class:"flex flex-row items-center justify-between"},ua={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},fa={class:"ml-2 shrink-0"},be=j({__name:"FilterableListItemLayout",props:{fetchItemsFunction:{type:Function},applyFilterToItemsFunction:{type:Function},readonly:{type:Boolean},addItemButtonLabel:{},fetchErrorNotificationTitle:{},description:{},noItemsFoundMessage:{},noFilteredItemsFoundMessage:{},noFilteredItemsFoundDescription:{}},emits:["reload-items"],setup(L,{emit:u}){const o=L,s=u,{t}=M(),_=y(!1),c=y({notificationTitle:"",notificationDescription:"",notificationDetails:""}),h=y([]),d=y(""),a=y(!1),v=y(!1),m=y(),g=_e(()=>d.value===""?h.value:o.applyFilterToItemsFunction(h.value,d.value));async function I(){try{_.value=!0,h.value=await o.fetchItemsFunction(),_.value=!1}catch(l){c.value.notificationTitle=o.fetchErrorNotificationTitle,c.value.notificationDescription=t(z(l)),c.value.notificationDetails=l.toString()}}function V(l){m.value=l,a.value=!0}function E(){a.value=!1}function R(l){m.value=l,v.value=!0}function x(){v.value=!1}async function D(){await I(),s("reload-items")}return te(()=>{I()}),(l,n)=>{const b=J("font-awesome-icon");return f(),T(N,null,[C("div",ra,[C("div",ca,[C("p",ua,p(l.description),1),C("div",fa,[!l.readonly&&h.value.length>0?(f(),k(e(O),{key:0,kind:"secondary",onClick:n[0]||(n[0]=A=>V())},{prefix:i(()=>[r(b,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(" "+p(l.addItemButtonLabel),1)]),_:1})):F("",!0)])]),r(e(G),{class:"max-w-xs",placeholder:e(t)("common.filter"),modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=A=>d.value=A)},null,8,["placeholder","modelValue"]),c.value.notificationDescription?(f(),k(e(H),{key:0,kind:"error",title:c.value.notificationTitle,description:c.value.notificationDescription},Y({_:2},[c.value.notificationDetails?{name:"details",fn:i(()=>[w(p(c.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),_.value?(f(),k(e(ce),{key:1,lines:10})):(f(),T(N,{key:2},[h.value.length==0?(f(),k(e(Z),{key:0,title:l.noItemsFoundMessage,icon:["fas","circle-info"],class:ue([l.readonly?"pb-2":""])},{default:i(()=>[l.readonly?F("",!0):(f(),k(e(O),{key:0,kind:"primary",onClick:n[2]||(n[2]=A=>V())},{prefix:i(()=>[r(b,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(p(l.addItemButtonLabel),1)]),_:1}))]),_:1},8,["title","class"])):g.value.length==0?(f(),k(e(Z),{key:1,title:l.noFilteredItemsFoundMessage,description:l.noFilteredItemsFoundDescription,icon:["fas","circle-info"]},null,8,["title","description"])):ve(l.$slots,"item-list-view",{key:2,items:g.value,openDeleteModal:R,openEditItemDrawer:V})],64))]),l.readonly?F("",!0):ve(l.$slots,"create-edit-item-drawer",{key:0,isDrawerShown:a.value,itemToEdit:m.value,closeDrawer:E,reloadItems:D}),l.readonly?F("",!0):ve(l.$slots,"delete-item-modal",{key:1,isModalShown:v.value,closeModal:x,itemToDelete:m.value,reloadItems:D})],64)}}}),va={key:0},pa={key:1},ma={class:"align-center -ml-2.5 flex gap-2 xl:ml-0 xl:justify-end"},Re=j({__name:"LeasesTable",props:{leases:{},showDynamicLeases:{type:Boolean}},emits:["lease-delete","lease-edit","create-static-lease-from-dynamic"],setup(L,{emit:u}){const{t:o}=M(),s=L,t=u,_=y(10),{currentPage:c,paginatedItems:h}=ke(()=>s.leases,{itemsPerPage:_});function d(a){return s.showDynamicLeases?[{id:"create-static-lease",label:o("standalone.dns_dhcp.add_reservation"),iconStyle:"fas",icon:"circle-plus",action:()=>{t("create-static-lease-from-dynamic",a)}}]:[{id:"delete",label:o("common.delete"),iconStyle:"fas",icon:"trash",danger:!0,action:()=>{t("lease-delete",a)}}]}return(a,v)=>{const m=J("font-awesome-icon");return f(),k(e(xe),{ariaLabel:e(o)("standalone.dns_dhcp.tabs.static_leases"),cardBreakpoint:"xl"},{paginator:i(()=>[r(e(Ce),{"current-page":e(c),"total-rows":s.leases.length,"page-size":_.value,"nav-pagination-label":e(o)("ne_table.pagination"),"next-label":e(o)("ne_table.go_to_next_page"),"previous-label":e(o)("ne_table.go_to_previous_page"),"range-of-total-label":e(o)("ne_table.of"),"page-size-label":e(o)("ne_table.show"),onSelectPage:v[0]||(v[0]=g=>{c.value=g}),onSelectPageSize:v[1]||(v[1]=g=>{_.value=g})},null,8,["current-page","total-rows","page-size","nav-pagination-label","next-label","previous-label","range-of-total-label","page-size-label"])]),default:i(()=>[r(e(Se),null,{default:i(()=>[r(e(q),null,{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.hostname")),1)]),_:1}),a.showDynamicLeases?F("",!0):(f(),k(e(q),{key:0},{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.reservation_name")),1)]),_:1})),r(e(q),null,{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.interface")),1)]),_:1}),r(e(q),null,{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.ip_address")),1)]),_:1}),r(e(q),null,{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.mac_address")),1)]),_:1}),a.showDynamicLeases?(f(),k(e(q),{key:1},{default:i(()=>[w(p(e(o)("standalone.dns_dhcp.lease_expiration")),1)]),_:1})):F("",!0),r(e(q))]),_:1}),r(e($e),null,{default:i(()=>[(f(!0),T(N,null,ee(e(h),(g,I)=>(f(),k(e(Le),{key:I},{default:i(()=>[r(e(P),{"data-label":e(o)("standalone.dns_dhcp.hostname")},{default:i(()=>[w(p(g.hostname),1)]),_:2},1032,["data-label"]),a.showDynamicLeases?F("",!0):(f(),k(e(P),{key:0,"data-label":e(o)("standalone.dns_dhcp.reservation_name")},{default:i(()=>[w(p(g.description?g.description:"-"),1)]),_:2},1032,["data-label"])),r(e(P),{"data-label":e(o)("standalone.dns_dhcp.interface")},{default:i(()=>[!g.interface&&!g.device?(f(),T("p",va,"-")):(f(),T("p",pa,p(g.interface)+" ("+p(g.device)+")",1))]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(o)("standalone.dns_dhcp.ip_address")},{default:i(()=>[w(p(g.ipaddr),1)]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(o)("standalone.dns_dhcp.mac_address")},{default:i(()=>[w(p(g.macaddr),1)]),_:2},1032,["data-label"]),a.showDynamicLeases?(f(),k(e(P),{key:1,"data-label":e(o)("standalone.dns_dhcp.lease_expiration")},{default:i(()=>[w(p(new Date(Number.parseInt(g.timestamp)*1e3).toLocaleDateString())+" "+p(new Date(Number.parseInt(g.timestamp)*1e3).toLocaleTimeString()),1)]),_:2},1032,["data-label"])):F("",!0),r(e(P),{"data-label":e(o)("common.actions")},{default:i(()=>[C("div",ma,[a.showDynamicLeases?F("",!0):(f(),k(e(O),{key:0,kind:"tertiary",onClick:V=>t("lease-edit",g)},{prefix:i(()=>[r(m,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(" "+p(e(o)("common.edit")),1)]),_:2},1032,["onClick"])),r(e(ge),{items:d(g),"align-to-right":!0},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel"])}}}),_a=j({__name:"DeleteStaticLeaseModal",props:{visible:{type:Boolean},itemToDelete:{}},emits:["close","lease-deleted"],setup(L,{emit:u}){const{t:o}=M(),s=L,t=u,_=y({notificationDescription:"",notificationDetails:""}),c=y(!1);async function h(){if(s.itemToDelete){_.value={notificationDescription:"",notificationDetails:""},c.value=!0;try{await U("ns.dhcp","delete-static-lease",{lease:s.itemToDelete.lease}),t("lease-deleted"),t("close")}catch(a){_.value.notificationDescription=a.response.data.message=="lease_not_found"?o("standalone.dns_dhcp.lease_not_found"):o(z(a)),_.value.notificationDetails=a.toString()}finally{c.value=!1}}}function d(){_.value={notificationDescription:"",notificationDetails:""},t("close")}return(a,v)=>{var m,g,I;return f(),T("div",null,[(m=a.itemToDelete)!=null&&m.used?(f(),k(Ee,{key:0,visible:a.visible,objectName:(g=a.itemToDelete)==null?void 0:g.hostname,usageIds:(I=a.itemToDelete)==null?void 0:I.matches,showGoToObjectsButton:!0,onClose:d},null,8,["visible","objectName","usageIds"])):(f(),k(e(Te),{key:1,visible:a.visible,kind:"warning",title:e(o)("standalone.dns_dhcp.delete_reservation"),primaryLabel:e(o)("common.delete"),primaryButtonKind:"danger",primaryButtonDisabled:c.value,primaryButtonLoading:c.value,"close-aria-label":e(o)("common.close"),onPrimaryClick:v[0]||(v[0]=V=>h()),onClose:v[1]||(v[1]=V=>d())},{default:i(()=>{var V;return[w(p(e(o)("standalone.dns_dhcp.delete_reservation_message",{hostname:((V=a.itemToDelete)==null?void 0:V.hostname)??""}))+" ",1),_.value.notificationDescription?(f(),k(e(H),{key:0,kind:"error",title:e(o)("error.cannot_delete_reservation"),description:_.value.notificationDescription},Y({_:2},[_.value.notificationDetails?{name:"details",fn:i(()=>[w(p(_.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0)]}),_:1},8,["visible","title","primaryLabel","primaryButtonDisabled","primaryButtonLoading","close-aria-label"]))])}}}),ga={class:"font-semibold"},ha={class:"flex flex-col gap-y-6"},ya={class:"flex justify-end"},we=j({__name:"CreateOrEditStaticLeaseDrawer",props:{isShown:{type:Boolean},itemToEdit:{},importDynamicLease:{},importScanResult:{}},emits:["close","add-edit-lease"],setup(L,{emit:u}){const o=L,{t:s}=M(),t=u,_=y(!1),c=y({notificationTitle:"",notificationDescription:"",notificationDetails:""}),h=y(new re),d=y(""),a=y(""),v=y(""),m=y(""),g=y("");function I(){var l,n,b,A,Q;o.importDynamicLease?(d.value="",a.value=o.importDynamicLease.hostname,v.value=o.importDynamicLease.ipaddr,m.value=o.importDynamicLease.macaddr,g.value=""):o.importScanResult?(d.value="",a.value=o.importScanResult.hostname||"",v.value=o.importScanResult.ip,m.value=o.importScanResult.mac,g.value=""):(d.value=((l=o.itemToEdit)==null?void 0:l.lease)??"",a.value=((n=o.itemToEdit)==null?void 0:n.hostname)??"",v.value=((b=o.itemToEdit)==null?void 0:b.ipaddr)??"",m.value=((A=o.itemToEdit)==null?void 0:A.macaddr)??"",g.value=((Q=o.itemToEdit)==null?void 0:Q.description)??"")}function V(l,n){for(let b of l)b.valid||h.value.set(n,[b.errMessage]);return l.every(b=>b.valid)}function E(){return h.value.clear(),[[[K(a.value),he(a.value)],"hostname"],[[K(v.value),ie(v.value)],"ipaddr"],[[K(m.value),Oe(m.value)],"mac"]].map(([n,b])=>V(n,b)).every(n=>n)}async function R(){c.value.notificationTitle="",c.value.notificationDescription="",c.value.notificationDetails="";const l=d.value!="";try{_.value=!0;const n=l?"edit-static-lease":"add-static-lease";if(E()){let b={hostname:a.value,ipaddr:v.value,description:g.value,macaddr:m.value.replace(/-/g,":")};l&&(b.lease=d.value),await U("ns.dhcp",n,b),t("add-edit-lease"),x()}}catch(n){n instanceof De?h.value=n.errorBag:(c.value.notificationTitle=s(l?"error.cannot_edit_reservation":"error.cannot_create_reservation"),c.value.notificationDescription=n.response.data.message=="lease_not_found"?s("standalone.dns_dhcp.lease_not_found"):s(z(n)),c.value.notificationDetails=n.toString())}finally{_.value=!1}}function x(){h.value.clear(),c.value.notificationTitle="",c.value.notificationDescription="",c.value.notificationDetails="",I(),t("close")}pe(()=>{I()}),te(()=>{I()});function D(){const l=s("standalone.network.title"),n=s("standalone.dns_dhcp.title"),b=s("standalone.dns_dhcp.tabs.static_leases");return`${l} > ${n} > ${b}`}return(l,n)=>(f(),k(e(me),{"is-shown":l.isShown,onClose:n[6]||(n[6]=b=>x()),closeAriaLabel:e(s)("common.shell.close_side_drawer"),title:d.value?e(s)("standalone.dns_dhcp.edit_reservation"):e(s)("standalone.dns_dhcp.add_reservation")},{default:i(()=>[l.importDynamicLease||l.importScanResult?(f(),k(e(H),{key:0,kind:"info",closeAriaLabel:e(s)("common.close"),class:"mb-6"},{description:i(()=>[C("div",null,p(e(s)("standalone.dns_dhcp.reservation_location_info_description")),1),C("div",ga,p(D()),1)]),_:1},8,["closeAriaLabel"])):F("",!0),c.value.notificationTitle?(f(),k(e(H),{key:1,title:c.value.notificationTitle,description:c.value.notificationDescription,class:"mb-6",kind:"error"},Y({_:2},[c.value.notificationDetails?{name:"details",fn:i(()=>[w(p(c.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),C("div",ha,[r(e(G),{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=b=>a.value=b),label:e(s)("standalone.dns_dhcp.hostname"),"invalid-message":e(s)(h.value.getFirstI18nKeyFor("hostname"))},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=b=>v.value=b),label:e(s)("standalone.dns_dhcp.ip_address"),"invalid-message":e(s)(h.value.getFirstI18nKeyFor("ipaddr"))},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=b=>m.value=b),label:e(s)("standalone.dns_dhcp.mac_address"),"invalid-message":e(s)(h.value.getFirstI18nKeyFor("mac"))},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=b=>g.value=b),label:e(s)("standalone.dns_dhcp.reservation_name"),optional:!0,"optional-label":e(s)("common.optional")},null,8,["modelValue","label","optional-label"]),n[7]||(n[7]=C("hr",null,null,-1)),C("div",ya,[r(e(O),{kind:"tertiary",class:"mr-4",onClick:n[4]||(n[4]=b=>x())},{default:i(()=>[w(p(e(s)("common.cancel")),1)]),_:1}),r(e(O),{kind:"primary",onClick:n[5]||(n[5]=b=>R()),disabled:_.value,loading:_.value},{default:i(()=>[w(p(e(s)("common.save")),1)]),_:1},8,["disabled","loading"])])])]),_:1},8,["is-shown","closeAriaLabel","title"]))}}),ba=j({__name:"StaticLeases",setup(L){const{t:u}=M(),o=ae();async function s(){return(await U("ns.dhcp","list-static-leases")).data.leases}function t(c,h){const d=h.toLowerCase();return c.filter(a=>a.hostname.toLowerCase().includes(d)||a.ipaddr.toLowerCase().includes(d)||a.macaddr.toLowerCase().includes(d)||a.interface.toLowerCase().includes(d))}async function _(){await o.getChanges()}return(c,h)=>(f(),k(be,{"fetch-items-function":s,"add-item-button-label":e(u)("standalone.dns_dhcp.add_reservation"),"fetch-error-notification-title":e(u)("error.cannot_retrieve_reservations"),"apply-filter-to-items-function":t,readonly:!1,"no-items-found-message":e(u)("standalone.dns_dhcp.no_reservation_configured"),"no-filtered-items-found-message":e(u)("standalone.dns_dhcp.no_reservation_found"),"no-filtered-items-found-description":e(u)("standalone.dns_dhcp.filter_change_suggestion"),description:e(u)("standalone.dns_dhcp.static_leases_description"),onReloadItems:h[0]||(h[0]=d=>_())},{"item-list-view":i(({items:d,openDeleteModal:a,openEditItemDrawer:v})=>[r(Re,{leases:d,"show-dynamic-leases":!1,onLeaseDelete:a,onLeaseEdit:v},null,8,["leases","onLeaseDelete","onLeaseEdit"])]),"delete-item-modal":i(({isModalShown:d,closeModal:a,itemToDelete:v,reloadItems:m})=>[r(_a,{"item-to-delete":v,visible:d,onClose:a,onLeaseDeleted:m},null,8,["item-to-delete","visible","onClose","onLeaseDeleted"])]),"create-edit-item-drawer":i(({isDrawerShown:d,itemToEdit:a,closeDrawer:v,reloadItems:m})=>[r(we,{"is-shown":d,"item-to-edit":a,onClose:g=>v(),onAddEditLease:g=>m()},null,8,["is-shown","item-to-edit","onClose","onAddEditLease"])]),_:1},8,["add-item-button-label","fetch-error-notification-title","no-items-found-message","no-filtered-items-found-message","no-filtered-items-found-description","description"]))}}),wa=j({__name:"DynamicLeases",setup(L){const{t:u}=M(),o=ae(),s=Ue(),t=y(),_=y(!1);function c(a){t.value=a,_.value=!0}async function h(){return(await U("ns.dhcp","list-active-leases")).data.leases}function d(a,v){const m=v.toLowerCase();return a.filter(g=>g.hostname.toLowerCase().includes(m)||g.ipaddr.toLowerCase().includes(m)||g.macaddr.toLowerCase().includes(m)||g.interface.toLowerCase().includes(m))}return(a,v)=>(f(),T(N,null,[r(be,{"fetch-items-function":h,"fetch-error-notification-title":e(u)("error.cannot_retrieve_dynamic_leases"),"apply-filter-to-items-function":d,readonly:!0,"no-items-found-message":e(u)("standalone.dns_dhcp.no_dynamic_lease_found"),"no-filtered-items-found-message":e(u)("standalone.dns_dhcp.no_dynamic_lease_found"),"no-filtered-items-found-description":e(u)("standalone.dns_dhcp.filter_change_suggestion"),description:e(u)("standalone.dns_dhcp.dynamic_leases_description")},{"item-list-view":i(({items:m})=>[r(Re,{leases:m,"show-dynamic-leases":!0,onCreateStaticLeaseFromDynamic:c},null,8,["leases"])]),_:1},8,["fetch-error-notification-title","no-items-found-message","no-filtered-items-found-message","no-filtered-items-found-description","description"]),r(we,{"is-shown":_.value,"import-dynamic-lease":t.value,onClose:v[0]||(v[0]=m=>_.value=!1),onAddEditLease:v[1]||(v[1]=()=>{_.value=!1,e(o).getChanges(),e(s).push(`${e(ze)()}/network/dns-dhcp?tab=static-leases`)})},null,8,["is-shown","import-dynamic-lease"])],64))}}),Da={class:"flex max-w-xl flex-col gap-y-8"},ka={class:"flex justify-end"},Ca=j({__name:"DnsManager",setup(L){const{t:u}=M(),o=ae(),s=y(!0),t=y({notificationTitle:"",notificationDescription:"",notificationDetails:""}),_=y(!1),c=y(""),h=y([]),d=y(!1),a=y(new re),v=y([]);function m(){v.value=[]}function g(){a.value.clear(),m(),h.value.forEach(()=>{v.value.push("")});let E=!0;for(let[x,D]of h.value.entries())for(let l of[K(D),qe(D)])if(!l.valid){v.value[x]=u(l.errMessage),E=!1;break}const R=[K(c.value),he(c.value)];return R.forEach(x=>{x.valid||a.value.set("dnsDomain",[u(x.errMessage)])}),E&&R.every(x=>x.valid)}async function I(){try{s.value=!0;const E=await U("ns.dns","get-config");c.value=E.data.domain,h.value=E.data.server,d.value=E.data.logqueries,s.value=!1}catch(E){t.value.notificationTitle=u("error.cannot_retrieve_dns_configuration"),t.value.notificationDescription=u(z(E)),t.value.notificationDetails=E.toString()}}async function V(){if(t.value.notificationTitle="",t.value.notificationDescription="",t.value.notificationDetails="",!!g())try{_.value=!0,await U("ns.dns","set-config",{domain:c.value,logqueries:d.value,server:h.value}),await o.getChanges()}catch(E){t.value.notificationTitle=u("error.cannot_update_dns_configuration"),t.value.notificationDescription=u(z(E)),t.value.notificationDetails=E.toString()}finally{_.value=!1}}return te(()=>{I()}),(E,R)=>{const x=J("font-awesome-icon");return f(),T("div",Da,[t.value.notificationTitle?(f(),k(e(H),{key:0,kind:"error",title:t.value.notificationTitle,description:t.value.notificationDescription},Y({_:2},[t.value.notificationDetails?{name:"details",fn:i(()=>[w(p(t.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),s.value?(f(),k(e(ce),{key:1,lines:15})):(f(),T(N,{key:2},[r(Ie,{modelValue:h.value,"onUpdate:modelValue":R[0]||(R[0]=D=>h.value=D),"add-item-label":e(u)("standalone.dns_dhcp.add_dns_server"),title:e(u)("standalone.dns_dhcp.dns_forwarding_servers"),"invalid-messages":v.value},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(u)("standalone.dns_dhcp.dns_forwarding_servers_tooltip")),1)]),_:1})]),_:1},8,["modelValue","add-item-label","title","invalid-messages"]),r(e(G),{label:e(u)("standalone.dns_dhcp.dns_domain"),modelValue:c.value,"onUpdate:modelValue":R[1]||(R[1]=D=>c.value=D),"invalid-message":a.value.getFirstFor("dnsDomain")},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(u)("standalone.dns_dhcp.dns_domain_tooltip")),1)]),_:1})]),_:1},8,["label","modelValue","invalid-message"]),r(e(oe),{label:e(u)("standalone.dns_dhcp.log_dns_queries"),modelValue:d.value,"onUpdate:modelValue":R[2]||(R[2]=D=>d.value=D)},null,8,["label","modelValue"]),R[3]||(R[3]=C("hr",null,null,-1)),C("div",ka,[r(e(O),{kind:"primary",onClick:V,disabled:_.value,loading:_.value},{prefix:i(()=>[r(x,{icon:["fas","floppy-disk"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(p(e(u)("common.save")),1)]),_:1},8,["disabled","loading"])])],64))])}}}),Sa={class:ue(["flex","flex-row","items-center"])},$a={class:"align-center flex justify-end"},La=j({__name:"DnsRecordsTable",props:{dnsRecords:{}},emits:["record-delete","record-edit"],setup(L,{emit:u}){const{t:o}=M(),s=u,t=[{label:o("standalone.dns_dhcp.hostname"),key:"name"},{label:o("standalone.dns_dhcp.name"),key:"description"},{label:o("standalone.dns_dhcp.ip_address"),key:"ip"},{label:o("standalone.dns_dhcp.wildcard_dns_record"),key:"wildcard"},{label:"",key:"menu"}];function _(c){return[{id:"delete",label:o("common.delete"),iconStyle:"fas",icon:"trash",danger:!0,action:()=>{s("record-delete",c)}}]}return(c,h)=>{const d=J("font-awesome-icon");return f(),k(Ge,{data:c.dnsRecords,headers:t,class:"z-10"},{description:i(({item:a})=>[w(p(a.description?a.description:"-"),1)]),wildcard:i(({item:a})=>[C("div",Sa,[r(d,{icon:["fas",a.wildcard?"circle-check":"circle-xmark"],class:"mr-2 h-5 w-5","aria-hidden":"true"},null,8,["icon"]),w(" "+p(a.wildcard?e(o)("standalone.dns_dhcp.enabled"):e(o)("standalone.dns_dhcp.disabled")),1)])]),menu:i(({item:a})=>[C("div",$a,[r(e(O),{kind:"tertiary",onClick:v=>s("record-edit",a)},{prefix:i(()=>[r(d,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(" "+p(e(o)("common.edit")),1)]),_:2},1032,["onClick"]),r(e(ge),{items:_(a),"align-to-right":!0},null,8,["items"])])]),_:1},8,["data"])}}}),xa={class:"font-semibold"},Ta={class:"flex flex-col gap-y-6"},Ia={class:"flex justify-end"},Fe=j({__name:"CreateOrEditDnsRecordDrawer",props:{isShown:{type:Boolean},itemToEdit:{},importScanResult:{}},emits:["close","add-edit-record"],setup(L,{emit:u}){const o=L,{t:s}=M(),t=u,_=y(!1),c=y({notificationTitle:"",notificationDescription:"",notificationDetails:""}),h=y(new re),d=y(""),a=y(""),v=y(""),m=y(""),g=y(!1);function I(){var l,n,b,A,Q;o.importScanResult?(d.value="",a.value=o.importScanResult.hostname||"",v.value=o.importScanResult.ip,m.value="",g.value=!1):(d.value=((l=o.itemToEdit)==null?void 0:l.record)??"",a.value=((n=o.itemToEdit)==null?void 0:n.name)??"",v.value=((b=o.itemToEdit)==null?void 0:b.ip)??"",m.value=((A=o.itemToEdit)==null?void 0:A.description)??"",g.value=((Q=o.itemToEdit)==null?void 0:Q.wildcard)??!1)}function V(l,n){for(let b of l)b.valid||h.value.set(n,[s(b.errMessage)]);return l.every(b=>b.valid)}function E(){return h.value.clear(),[[[K(a.value),he(a.value)],"hostname"],[[K(v.value),ie(v.value)],"ipAddress"]].map(([n,b])=>V(n,b)).every(n=>n)}async function R(){c.value.notificationTitle="",c.value.notificationDescription="",c.value.notificationDetails="";const l=d.value!="";try{_.value=!0;const n=l?"edit-record":"add-record";if(E()){let b={name:a.value,ip:v.value,description:m.value,wildcard:g.value};l&&(b.record=d.value),await U("ns.dns",n,b),t("add-edit-record"),x()}}catch(n){c.value.notificationTitle=s(l?"error.cannot_edit_dns_record":"error.cannot_create_dns_record"),c.value.notificationDescription=n.response.data.message=="record_not_found"?s("standalone.dns_dhcp.record_not_found"):s(z(n)),c.value.notificationDetails=n.toString()}finally{_.value=!1}}function x(){h.value.clear(),c.value.notificationTitle="",c.value.notificationDescription="",c.value.notificationDetails="",I(),t("close")}pe(()=>{I()}),te(()=>{I()});function D(){const l=s("standalone.network.title"),n=s("standalone.dns_dhcp.title"),b=s("standalone.dns_dhcp.tabs.dns_records");return`${l} > ${n} > ${b}`}return(l,n)=>(f(),k(e(me),{"is-shown":l.isShown,onClose:n[6]||(n[6]=b=>x()),closeAriaLabel:e(s)("common.shell.close_side_drawer"),title:d.value?e(s)("standalone.dns_dhcp.edit_dns_record"):e(s)("standalone.dns_dhcp.add_dns_record")},{default:i(()=>[l.importScanResult?(f(),k(e(H),{key:0,kind:"info",closeAriaLabel:e(s)("common.close"),class:"mb-6"},{description:i(()=>[C("div",null,p(e(s)("standalone.dns_dhcp.dns_record_location_info_description")),1),C("div",xa,p(D()),1)]),_:1},8,["closeAriaLabel"])):F("",!0),c.value.notificationTitle?(f(),k(e(H),{key:1,title:c.value.notificationTitle,description:c.value.notificationDescription,class:"mb-6",kind:"error"},Y({_:2},[c.value.notificationDetails?{name:"details",fn:i(()=>[w(p(c.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),C("div",Ta,[r(e(G),{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=b=>a.value=b),label:e(s)("standalone.dns_dhcp.hostname"),"invalid-message":h.value.getFirstFor("hostname")},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=b=>v.value=b),label:e(s)("standalone.dns_dhcp.ip_address"),"invalid-message":h.value.getFirstFor("ipAddress")},null,8,["modelValue","label","invalid-message"]),r(e(G),{modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=b=>m.value=b),label:e(s)("standalone.dns_dhcp.name"),"invalid-message":h.value.getFirstFor("name"),optional:!0,"optional-label":e(s)("common.optional")},null,8,["modelValue","label","invalid-message","optional-label"]),r(e(oe),{modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=b=>g.value=b),label:e(s)("standalone.dns_dhcp.wildcard_dns_record")},{tooltip:i(()=>[r(e(X),null,{content:i(()=>[w(p(e(s)("standalone.dns_dhcp.wildcard_dns_record_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label"]),n[7]||(n[7]=C("hr",null,null,-1)),C("div",Ia,[r(e(O),{kind:"tertiary",class:"mr-4",onClick:n[4]||(n[4]=b=>x())},{default:i(()=>[w(p(e(s)("common.cancel")),1)]),_:1}),r(e(O),{kind:"primary",onClick:n[5]||(n[5]=b=>R()),disabled:_.value,loading:_.value},{default:i(()=>[w(p(e(s)("common.save")),1)]),_:1},8,["disabled","loading"])])])]),_:1},8,["is-shown","closeAriaLabel","title"]))}}),Va=j({__name:"DeleteDnsRecordModal",props:{visible:{type:Boolean},itemToDelete:{}},emits:["close","record-deleted"],setup(L,{emit:u}){const{t:o}=M(),s=L,t=u,_=y({notificationDescription:"",notificationDetails:""}),c=y(!1);async function h(){if(s.itemToDelete){_.value={notificationDescription:"",notificationDetails:""},c.value=!0;try{await U("ns.dns","delete-record",{record:s.itemToDelete.record}),t("record-deleted"),t("close")}catch(a){_.value.notificationDescription=a.response.data.message=="record_not_found"?o("standalone.dns_dhcp.record_not_found"):o(z(a)),_.value.notificationDetails=a.toString()}finally{c.value=!1}}}function d(){_.value={notificationDescription:"",notificationDetails:""},t("close")}return(a,v)=>{var m,g,I;return f(),T("div",null,[(m=a.itemToDelete)!=null&&m.used?(f(),k(Ee,{key:0,visible:a.visible,objectName:(g=a.itemToDelete)==null?void 0:g.name,usageIds:(I=a.itemToDelete)==null?void 0:I.matches,showGoToObjectsButton:!0,onClose:d},null,8,["visible","objectName","usageIds"])):(f(),k(e(Te),{key:1,visible:a.visible,kind:"warning",title:e(o)("standalone.dns_dhcp.delete_dns_record"),primaryLabel:e(o)("common.delete"),primaryButtonDisabled:c.value,primaryButtonLoading:c.value,"close-aria-label":e(o)("common.close"),onPrimaryClick:v[0]||(v[0]=V=>h()),onClose:v[1]||(v[1]=V=>d())},{default:i(()=>{var V;return[w(p(e(o)("standalone.dns_dhcp.delete_dns_record_message",{name:((V=a.itemToDelete)==null?void 0:V.name)??""}))+" ",1),_.value.notificationDescription?(f(),k(e(H),{key:0,kind:"error",title:e(o)("error.cannot_delete_dns_record"),description:_.value.notificationDescription},Y({_:2},[_.value.notificationDetails?{name:"details",fn:i(()=>[w(p(_.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0)]}),_:1},8,["visible","title","primaryLabel","primaryButtonDisabled","primaryButtonLoading","close-aria-label"]))])}}}),Ea=j({__name:"DnsRecords",setup(L){const{t:u}=M(),o=ae();async function s(){return(await U("ns.dns","list-records")).data.records}function t(c,h){const d=h.toLowerCase();return c.filter(a=>a.record.toLowerCase().includes(d)||a.ip.toLowerCase().includes(d)||a.name.toLowerCase().includes(d)||a.description.toLowerCase().includes(d))}async function _(){await o.getChanges()}return(c,h)=>(f(),k(be,{"fetch-items-function":s,"add-item-button-label":e(u)("standalone.dns_dhcp.add_dns_record"),"fetch-error-notification-title":e(u)("error.cannot_retrieve_dns_records"),"apply-filter-to-items-function":t,readonly:!1,"no-items-found-message":e(u)("standalone.dns_dhcp.no_dns_record_configured"),"no-filtered-items-found-message":e(u)("standalone.dns_dhcp.no_dns_record_found"),"no-filtered-items-found-description":e(u)("standalone.dns_dhcp.filter_change_suggestion"),description:e(u)("standalone.dns_dhcp.dns_records_description"),onReloadItems:h[0]||(h[0]=d=>_())},{"item-list-view":i(({items:d,openDeleteModal:a,openEditItemDrawer:v})=>[r(La,{"dns-records":d,onRecordDelete:a,onRecordEdit:v},null,8,["dns-records","onRecordDelete","onRecordEdit"])]),"delete-item-modal":i(({isModalShown:d,closeModal:a,itemToDelete:v,reloadItems:m})=>[r(Va,{visible:d,onClose:g=>a(),onRecordDeleted:g=>m(),"item-to-delete":v},null,8,["visible","onClose","onRecordDeleted","item-to-delete"])]),"create-edit-item-drawer":i(({isDrawerShown:d,itemToEdit:a,closeDrawer:v,reloadItems:m})=>[r(Fe,{"is-shown":d,"item-to-edit":a,onClose:g=>v(),onAddEditRecord:g=>m()},null,8,["is-shown","item-to-edit","onClose","onAddEditRecord"])]),_:1},8,["add-item-button-label","fetch-error-notification-title","no-items-found-message","no-filtered-items-found-message","no-filtered-items-found-description","description"]))}}),Ra={class:"flex grow flex-col gap-y-4 p-5"},Fa={class:"flex flex-col"},Ba={class:"flex flex-row items-center justify-between"},Aa={class:"text-sm"},ja=j({__name:"ScanInterfaceCard",props:{iface:{type:Object,required:!0},scanButtonLoading:{type:Boolean,default:!1},scanButtonDisabled:{type:Boolean,default:!1}},emits:["startScan"],setup(L,{emit:u}){const o=u,{t:s}=M(),t=ye();function _(c){const h=t.zones.find(d=>d.interfaces.includes(c));return Ve((h==null?void 0:h.name)??"")}return(c,h)=>{const d=J("font-awesome-icon");return f(),T("div",{class:ue(`overflow-hidden rounded-md border-l-4 bg-white text-sm text-gray-700 dark:bg-gray-950 dark:text-gray-200 sm:rounded-lg sm:shadow ${_(L.iface.name)}`)},[C("div",Ra,[C("div",Fa,[C("div",Ba,[C("p",Aa,[C("strong",null,p(L.iface.name),1),h[1]||(h[1]=C("br",null,null,-1)),w(" "+p(L.iface.device),1)]),r(e(O),{kind:"tertiary",onClick:h[0]||(h[0]=a=>o("startScan",L.iface)),loading:L.scanButtonLoading,disabled:L.scanButtonDisabled},{prefix:i(()=>[r(d,{icon:["fas","magnifying-glass"],class:"h-4 w-4","aria-hidden":"true"})]),default:i(()=>[w(" "+p(e(s)("standalone.dns_dhcp.scan_network")),1)]),_:1},8,["loading","disabled"])])])])],2)}}}),Ma={class:"flex justify-end"},Na=j({__name:"ScanResultsTable",props:{results:{type:Array,required:!0},loading:{type:Boolean,default:!1}},emits:["addIpReservation","addDnsRecord"],setup(L,{emit:u}){const o=L,s=u,{t}=M(),_=y(10),{currentPage:c,paginatedItems:h}=ke(()=>o.results,{itemsPerPage:_});function d(a){return[{id:"addIpReservation",label:t("standalone.dns_dhcp.add_reservation"),icon:"circle-plus",iconStyle:"fas",action:()=>s("addIpReservation",a)},{id:"addDnsRecord",label:t("standalone.dns_dhcp.add_dns_record"),icon:"circle-plus",iconStyle:"fas",action:()=>s("addDnsRecord",a)}]}return(a,v)=>(f(),k(e(xe),{ariaLabel:e(t)("standalone.dns_dhcp.scan_results"),cardBreakpoint:"xl",loading:L.loading,skeletonColumns:5,skeletonRows:5},{paginator:i(()=>[r(e(Ce),{"current-page":e(c),"total-rows":o.results.length,"page-size":_.value,"nav-pagination-label":e(t)("ne_table.pagination"),"next-label":e(t)("ne_table.go_to_next_page"),"previous-label":e(t)("ne_table.go_to_previous_page"),"range-of-total-label":e(t)("ne_table.of"),"page-size-label":e(t)("ne_table.show"),onSelectPage:v[0]||(v[0]=m=>{c.value=m}),onSelectPageSize:v[1]||(v[1]=m=>{_.value=m})},null,8,["current-page","total-rows","page-size","nav-pagination-label","next-label","previous-label","range-of-total-label","page-size-label"])]),default:i(()=>[r(e(Se),null,{default:i(()=>[r(e(q),null,{default:i(()=>[w(p(e(t)("standalone.dns_dhcp.ip_address")),1)]),_:1}),r(e(q),null,{default:i(()=>[w(p(e(t)("standalone.dns_dhcp.mac_address")),1)]),_:1}),r(e(q),null,{default:i(()=>[w(p(e(t)("standalone.dns_dhcp.hostname")),1)]),_:1}),r(e(q),null,{default:i(()=>[w(p(e(t)("standalone.dns_dhcp.description")),1)]),_:1}),r(e(q))]),_:1}),r(e($e),null,{default:i(()=>[(f(!0),T(N,null,ee(e(h),m=>(f(),k(e(Le),{key:m.ip},{default:i(()=>[r(e(P),{"data-label":e(t)("standalone.dns_dhcp.ip_address")},{default:i(()=>[w(p(m.ip||"-"),1)]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(t)("standalone.dns_dhcp.mac_address")},{default:i(()=>[w(p(m.mac||"-"),1)]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(t)("standalone.dns_dhcp.hostname")},{default:i(()=>[w(p(m.hostname||"-"),1)]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(t)("standalone.dns_dhcp.description")},{default:i(()=>[w(p(m.description||"-"),1)]),_:2},1032,["data-label"]),r(e(P),{"data-label":e(t)("common.actions")},{default:i(()=>[C("div",Ma,[r(e(ge),{items:d(m),alignToRight:!0},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel","loading"]))}}),Oa={class:"space-y-8"},Ua={class:"max-w-2xl text-gray-500 dark:text-gray-400"},za={key:2,class:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3 3xl:grid-cols-4"},qa={key:1},Pa={class:"z-0 -mb-1 table max-w-md rounded-se-md rounded-ss-md bg-indigo-300 p-2 text-sm dark:bg-indigo-800"},Ka=j({__name:"ScanNetwork",setup(L){const{t:u}=M(),o=ae(),s=ye(),t=y(""),_=y([]),c=y([]),h=y(!1),d=y(void 0),a=y(!1),v=y(!1),m=y({listInterfaces:!0,scanNetwork:!1}),g=y({listInterfaces:"",listInterfacesDetails:"",scanNetwork:"",scanNetworkDetails:""}),I=_e(()=>m.value.listInterfaces||s.loading);te(()=>{(s.loading||s.error)&&s.fetch(),V()});async function V(){m.value.listInterfaces=!0;try{const D=await U("ns.scan","list-interfaces");_.value=D.data.interfaces.map(l=>({name:l.interface,device:l.device}))}catch(D){g.value.listInterfaces=u(z(D)),g.value.listInterfacesDetails=D.toString()}finally{m.value.listInterfaces=!1}}async function E(D){g.value.scanNetwork="",g.value.scanNetworkDetails="",t.value=D.name,h.value=!0,m.value.scanNetwork=!0;try{const l=await U("ns.scan","scan",{device:D.device});c.value=l.data.hosts.map(n=>({ip:n.ip,mac:n.mac,hostname:n.hostname!==n.ip?n.hostname:"",description:n.description}))}catch(l){g.value.scanNetwork=u(z(l)),g.value.scanNetworkDetails=l.toString()}finally{m.value.scanNetwork=!1}}function R(D){d.value=D,a.value=!0}function x(D){d.value=D,v.value=!0}return(D,l)=>(f(),T("div",null,[C("div",Oa,[C("p",Ua,p(e(u)("standalone.dns_dhcp.scan_network_description")),1),g.value.listInterfaces?(f(),k(e(H),{key:0,kind:"error",title:e(u)("error.cannot_retrieve_interfaces"),description:g.value.listInterfaces,class:"mb-4"},Y({_:2},[g.value.listInterfacesDetails?{name:"details",fn:i(()=>[w(p(g.value.listInterfacesDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),C("div",null,[r(e(de),{tag:"h6",class:"mb-4"},{default:i(()=>[w(p(e(u)("standalone.dns_dhcp.interfaces")),1)]),_:1}),g.value.scanNetwork?(f(),k(e(H),{key:0,kind:"error",title:e(u)("error.cannot_scan_network"),description:g.value.scanNetwork,class:"mb-4"},Y({_:2},[g.value.scanNetworkDetails?{name:"details",fn:i(()=>[w(p(g.value.scanNetworkDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):F("",!0),!I.value&&Object.keys(_.value).length==0?(f(),k(e(Z),{key:1,title:e(u)("standalone.dns_dhcp.no_interface_configured"),icon:["fas","circle-info"]},null,8,["title"])):(f(),T("div",za,[I.value?(f(),T(N,{key:0},ee(8,n=>C("div",{key:n,class:"flex animate-pulse"},l[4]||(l[4]=[C("div",{class:"h-24 w-full bg-gray-300 dark:bg-gray-700 sm:rounded-lg"},null,-1)]))),64)):(f(!0),T(N,{key:1},ee(_.value,(n,b)=>(f(),k(ja,{key:b,iface:n,scanButtonLoading:m.value.scanNetwork&&t.value===n.name,scanButtonDisabled:m.value.scanNetwork&&t.value===n.name,onStartScan:E},null,8,["iface","scanButtonLoading","scanButtonDisabled"]))),128))]))]),I.value?F("",!0):(f(),T("div",qa,[r(e(de),{tag:"h6",class:"mb-4"},{default:i(()=>[w(p(e(u)("standalone.dns_dhcp.scan_results")),1)]),_:1}),!m.value.scanNetwork&&e(Pe)(c.value)?(f(),T(N,{key:0},[h.value?(f(),k(e(Z),{key:0,title:e(u)("standalone.dns_dhcp.scan_no_results_empty_state",{iface:t.value}),icon:["fas","circle-info"]},null,8,["title"])):(f(),k(e(Z),{key:1,title:e(u)("standalone.dns_dhcp.scan_not_requested_empty_state"),icon:["fas","network-wired"]},null,8,["title"]))],64)):(f(),T(N,{key:1},[C("p",Pa,p(e(u)("standalone.dns_dhcp.interface_name",{name:t.value})),1),r(Na,{results:c.value,loading:m.value.scanNetwork,onAddIpReservation:R,onAddDnsRecord:x},null,8,["results","loading"])],64))]))]),r(we,{isShown:a.value,importScanResult:d.value,onClose:l[0]||(l[0]=n=>a.value=!1),onAddEditLease:l[1]||(l[1]=n=>e(o).getChanges())},null,8,["isShown","importScanResult"]),r(Fe,{isShown:v.value,importScanResult:d.value,onClose:l[2]||(l[2]=n=>v.value=!1),onAddEditRecord:l[3]||(l[3]=n=>e(o).getChanges())},null,8,["isShown","importScanResult"])]))}}),at=j({__name:"DnsDhcpView",setup(L){const{t:u}=M(),{tabs:o,selectedTab:s}=He([{name:"dhcp",label:u("standalone.dns_dhcp.tabs.dhcp")},{name:"static-leases",label:u("standalone.dns_dhcp.tabs.static_leases")},{name:"dynamic-leases",label:u("standalone.dns_dhcp.tabs.dynamic_leases")},{name:"dns",label:u("standalone.dns_dhcp.tabs.dns")},{name:"dns-records",label:u("standalone.dns_dhcp.tabs.dns_records")},{name:"scan-network",label:u("standalone.dns_dhcp.tabs.scan_network")}]);return(t,_)=>(f(),T(N,null,[r(e(de),{tag:"h3",class:"mb-7"},{default:i(()=>[w(p(e(u)("standalone.dns_dhcp.title")),1)]),_:1}),C("div",null,[r(e(Ke),{selected:e(s),srSelectTabLabel:e(u)("ne_tabs.select_a_tab"),srTabsLabel:e(u)("ne_tabs.tabs"),tabs:e(o),class:"mb-8",onSelectTab:_[0]||(_[0]=c=>s.value=c)},null,8,["selected","srSelectTabLabel","srTabsLabel","tabs"]),e(s)==="dhcp"?(f(),k(da,{key:0})):e(s)==="static-leases"?(f(),k(ba,{key:1})):e(s)==="dynamic-leases"?(f(),k(wa,{key:2})):e(s)==="dns"?(f(),k(Ca,{key:3})):e(s)==="dns-records"?(f(),k(Ea,{key:4})):(f(),k(Ka,{key:5}))])],64))}});export{at as default};
