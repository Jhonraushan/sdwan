import{d as M,u as H,U as J,r as n,o as Q,g as Ie,h as i,q as F,k as a,w as s,i as k,l as e,y as G,R as te,L as W,V as X,n as E,a5 as De,z as U,ar as ae,m as c,t as r,j as h,Q as R,s as Pe,I as $e,_ as A,a6 as Fe,B as Le,D as Be,F as N,cS as Ke,e as q,ag as ne,J as he,aa as me,ai as ye,Y as ke,c as ee,aH as ie,aI as oe,b4 as se,aK as de,ak as re,al as j,am as ue,an as Z,ao as L,aj as Y,bZ as pe,ad as ce,ap as ve,aq as be,bY as le,aZ as fe,c_ as xe,a as Ue,v as je,bX as Ve,br as Ae,ah as Te,c$ as Ee,C as Re,W as Me,a9 as Oe}from"./index-BlEQ5104.js";import{u as qe}from"./useTabs-BeLQ169O.js";import{_ as He}from"./FormLayout.vue_vue_type_script_setup_true_lang-DaMAl8E3.js";import{u as Ce,_ as _e}from"./IpsEnabledBadge.vue_vue_type_script_setup_true_lang-CzpDSvPe.js";const Ne={class:"max-w-3xl"},We={class:"space-y-2"},Ye={class:"flex items-center gap-4"},Xe=M({__name:"IpsSettings",setup(C){const t=Ce(),{t:l}=H(),d=[{id:"connectivity",label:l("standalone.ips.connectivity"),description:l("standalone.ips.connectivity_description")},{id:"balanced",label:l("standalone.ips.balanced"),description:l("standalone.ips.balanced_description")},{id:"security",label:l("standalone.ips.security"),description:l("standalone.ips.security_description")}],$=J(),u=n(!0),v=n(),g=n(!1),m=n("connectivity"),b=n("");function y(){v.value=void 0,q("ns.snort","settings",{}).then(B=>{g.value=B.data.enabled,m.value=B.data.ns_policy,b.value=B.data.oinkcode}).catch(B=>{v.value=B}).finally(()=>{u.value=!1})}Q(()=>{y()});const _=n(!1),x=n();function S(){_.value=!0,x.value=void 0,q("ns.snort","save-settings",{enabled:g.value,ns_policy:m.value,oinkcode:b.value}).then(()=>{t.enabled=g.value,$.getChanges()}).catch(B=>{x.value=B}).finally(()=>{_.value=!1})}const P=n(!1),V=n(!1),f=n(!1);function z(){P.value=!0,v.value=void 0,V.value=!1,f.value=!1,q("ns.snort","check-oinkcode",{oinkcode:b.value}).then(()=>{V.value=!0,setTimeout(()=>{V.value=!1},5e3)}).catch(B=>{B instanceof ne?f.value=!0:v.value=B}).finally(()=>{P.value=!1})}return(B,I)=>{const O=Ie("i18n-t");return i(),F("div",Ne,[a(He,{description:e(l)("standalone.ips.ips_settings_description"),title:e(l)("standalone.ips.ips_status")},{default:s(()=>[u.value?(i(),k(e(G),{key:0,lines:10})):(i(),F("form",{key:1,class:"space-y-8",onSubmit:te(S,["prevent"])},[x.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(x.value)),title:e(l)("error.cannot_open_unit"),kind:"error"},null,8,["description","title"])):E("",!0),a(e(De),{modelValue:g.value,"onUpdate:modelValue":I[0]||(I[0]=w=>g.value=w),disabled:_.value,label:g.value?e(l)("common.enabled"):e(l)("common.disabled"),"top-label":e(l)("common.status")},null,8,["modelValue","disabled","label","top-label"]),g.value?(i(),F(U,{key:1},[m.value!="max-detect"?(i(),k(e(ae),{key:0,modelValue:m.value,"onUpdate:modelValue":I[1]||(I[1]=w=>m.value=w),disabled:_.value,options:d},{label:s(()=>[c(r(e(l)("standalone.ips.policy")),1)]),_:1},8,["modelValue","disabled"])):(i(),k(e(W),{key:1,kind:"info",title:e(l)("standalone.ips.max_detect_info"),description:e(l)("standalone.ips.max_detect_description")},null,8,["title","description"])),h("div",We,[a(e(R),{modelValue:b.value,"onUpdate:modelValue":I[2]||(I[2]=w=>b.value=w),disabled:_.value,"invalid-message":f.value?e(l)("standalone.ips.oinkcode_invalid"):"",label:e(l)("standalone.ips.oinkcode"),autocomplete:"off","is-password":""},{tooltip:s(()=>[a(e(Pe),null,{content:s(()=>[a(O,{keypath:"standalone.ips.oinkcode_tooltip",tag:"p"},{default:s(()=>[a(e($e),{href:"https://www.snort.org/",target:"_blank","inverted-theme":""},{default:s(()=>I[3]||(I[3]=[c(" https://www.snort.org ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label"]),h("div",Ye,[a(e(A),{disabled:P.value,loading:P.value,onClick:z},{default:s(()=>[c(r(e(l)("standalone.ips.verify_oinkcode")),1)]),_:1},8,["disabled","loading"]),a(Fe,{name:"fade"},{default:s(()=>[V.value?(i(),k(e(Le),{key:0,icon:e(Be),text:e(l)("standalone.ips.oinkcode_verified"),kind:"success"},null,8,["icon","text"])):E("",!0)]),_:1})])])],64)):E("",!0),I[4]||(I[4]=h("hr",null,null,-1)),a(e(A),{disabled:_.value,loading:_.value,kind:"primary",type:"submit"},{prefix:s(()=>[a(e(N),{icon:e(Ke)},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("common.save")),1)]),_:1},8,["disabled","loading"])],32))]),_:1},8,["description","title"])])}}}),Ze={class:"flex flex-wrap justify-end gap-6"},Je=M({__name:"IpsCreateBypassDrawer",props:{visible:{type:Boolean,default:!1}},emits:["close","save"],setup(C,{emit:t}){const{t:l}=H(),d=t;he(()=>C.visible,V=>{V&&(v.value="ipv4",g.value="src",m.value="",b.value="",y.value.clear())});const $=[{label:"IPv4",id:"ipv4"},{label:"IPv6",id:"ipv6"}],u=[{label:l("standalone.ips.source_bypass"),id:"src"},{label:l("standalone.ips.destination_bypass"),id:"dst"}],v=n("ipv4"),g=n("src"),m=n(""),b=n(""),y=n(new me),_=n(!1),x=n();function S(){_.value=!0,x.value=void 0,y.value.clear(),q("ns.snort","create-bypass",{protocol:v.value,direction:g.value,ip:m.value,description:b.value}).then(()=>{d("save")}).catch(V=>{V instanceof ne?y.value=V.errorBag:x.value=V}).finally(()=>{_.value=!1})}function P(){_.value||d("close")}return(V,f)=>(i(),k(e(ye),{"is-shown":V.visible,title:e(l)("standalone.ips.create_bypass"),onClose:P},{default:s(()=>[h("form",{class:"space-y-8",onSubmit:te(S,["prevent"])},[a(e(ae),{modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=z=>v.value=z),disabled:_.value,label:e(l)("standalone.ips.address_type"),options:$},null,8,["modelValue","disabled","label"]),a(e(R),{modelValue:m.value,"onUpdate:modelValue":f[1]||(f[1]=z=>m.value=z),disabled:_.value,"invalid-message":e(l)(y.value.getFirstI18nKeyFor("ip")),label:e(l)("standalone.ips.ip_address")},null,8,["modelValue","disabled","invalid-message","label"]),a(e(ae),{modelValue:g.value,"onUpdate:modelValue":f[2]||(f[2]=z=>g.value=z),disabled:_.value,label:e(l)("standalone.ips.direction"),options:u},null,8,["modelValue","disabled","label"]),a(e(R),{modelValue:b.value,"onUpdate:modelValue":f[3]||(f[3]=z=>b.value=z),disabled:_.value,label:e(l)("standalone.ips.description"),optional:""},null,8,["modelValue","disabled","label"]),f[4]||(f[4]=h("hr",null,null,-1)),h("div",Ze,[a(e(A),{disabled:_.value,kind:"tertiary",size:"lg",onClick:P},{default:s(()=>[c(r(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),a(e(A),{disabled:_.value,loading:_.value,kind:"primary",size:"lg",type:"submit"},{default:s(()=>[c(r(e(l)("standalone.ips.create_bypass")),1)]),_:1},8,["disabled","loading"])])],32)]),_:1},8,["is-shown","title"]))}}),Qe={class:"space-y-4"},Ge=M({__name:"IpsDeleteBypassModal",props:{bypass:{}},emits:["close","deleted"],setup(C,{emit:t}){const{t:l}=H(),d=n();he(()=>C.bypass,b=>{b!=null&&(d.value=b)});const $=t,u=n(!1),v=n();function g(){u.value||$("close")}function m(){var b,y,_;u.value=!0,q("ns.snort","delete-bypass",{protocol:(b=d.value)==null?void 0:b.protocol,ip:(y=d.value)==null?void 0:y.ip,direction:(_=d.value)==null?void 0:_.direction}).then(()=>{$("deleted")}).catch(x=>{v.value=x}).finally(()=>{u.value=!1})}return(b,y)=>(i(),k(e(ke),{"cancel-label":e(l)("common.cancel"),"close-aria-label":e(l)("common.close"),"primary-button-disabled":u.value,"primary-button-loading":u.value,"primary-label":e(l)("common.delete"),title:e(l)("standalone.ips.delete_bypass_modal_title"),visible:b.bypass!=null,kind:"warning","primary-button-kind":"danger",onClose:y[0]||(y[0]=_=>g()),onPrimaryClick:y[1]||(y[1]=_=>m())},{default:s(()=>{var _,x,S;return[h("div",Qe,[v.value?(i(),k(e(W),{key:0,kind:"error",title:e(l)("standalone.ips.delete_bypass_error"),description:e(l)(e(X)(v.value))},null,8,["title","description"])):E("",!0),h("p",null,[((_=d.value)==null?void 0:_.description)==null?(i(),F(U,{key:0},[c(r(e(l)("standalone.ips.delete_bypass_modal_w_description",{description:(x=d.value)==null?void 0:x.description})),1)],64)):(i(),F(U,{key:1},[c(r(e(l)("standalone.ips.delete_bypass_modal_wo_description",{ip:(S=d.value)==null?void 0:S.ip,direction:d.value.direction=="src"?e(l)("standalone.ips.source"):e(l)("standalone.ips.destination")})),1)],64))])])]}),_:1},8,["cancel-label","close-aria-label","primary-button-disabled","primary-button-loading","primary-label","title","visible"]))}}),el={class:"space-y-8"},ll={class:"flex flex-wrap items-start justify-between gap-4"},al={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},sl={class:"flex flex-col flex-wrap justify-between gap-4 md:flex-row"},tl={class:"flex justify-end"},nl=M({__name:"IpsFilterBypass",setup(C){const t=J(),{t:l}=H(),d=n(!1),$=n([]),u=n(!0),v=n();function g(){u.value=!0,q("ns.snort","list-bypasses",{}).then(w=>{$.value=w.data.bypasses}).catch(w=>{v.value=w}).finally(()=>{u.value=!1})}Q(()=>{g()});const m=n(""),b=ee(()=>$.value.filter(w=>w.ip.includes(m.value))),y=n("ip"),_=n(!1),{sortedItems:x}=ie(b,y,_,{}),S=n(10),{currentPage:P,paginatedItems:V}=oe(x,{itemsPerPage:S}),f=w=>{y.value=w.key,_.value=w.descending};function z(){g(),d.value=!1,t.getChanges()}function B(w){return[{id:"delete",label:l("common.delete"),icon:"trash",iconStyle:"fas",danger:!0,action:()=>{I.value=w}}]}const I=n();function O(){g(),I.value=void 0,t.getChanges()}return(w,o)=>(i(),F("div",el,[h("div",ll,[h("p",al,r(e(l)("standalone.ips.filter_bypass_description")),1),a(_e)]),v.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(v.value)),title:e(l)("standalone.ips.error_loading_bypasses"),kind:"error"},null,8,["description","title"])):E("",!0),u.value?(i(),k(e(G),{key:1,lines:10})):$.value.length>0?(i(),F(U,{key:2},[h("div",sl,[a(e(R),{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=p=>m.value=p),modelModifiers:{trim:!0},placeholder:e(l)("common.filter"),"is-search":""},null,8,["modelValue","placeholder"]),$.value.length>0?(i(),k(e(A),{key:0,kind:"secondary",size:"lg",onClick:o[1]||(o[1]=p=>d.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(se),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.add_bypass")),1)]),_:1})):E("",!0)]),a(e(be),{ariaLabel:e(l)("standalone.ips.title"),"skeleton-columns":7,"skeleton-rows":5,sortDescending:_.value,sortKey:y.value,"card-breakpoint":"xl"},{paginator:s(()=>[a(e(de),{"current-page":e(P),"nav-pagination-label":e(l)("ne_table.pagination"),"next-label":e(l)("ne_table.go_to_next_page"),"page-size":S.value,"page-size-label":e(l)("ne_table.show"),"previous-label":e(l)("ne_table.go_to_previous_page"),"range-of-total-label":e(l)("ne_table.of"),"total-rows":$.value.length,onSelectPageSize:o[3]||(o[3]=p=>{S.value=p}),onSelectPage:o[4]||(o[4]=p=>{P.value=p})},null,8,["current-page","nav-pagination-label","next-label","page-size","page-size-label","previous-label","range-of-total-label","total-rows"])]),default:s(()=>[a(e(re),null,{default:s(()=>[a(e(j),{"column-key":"ip",sortable:"",onSort:f},{default:s(()=>[c(r(e(l)("standalone.ips.bypass_address")),1)]),_:1}),a(e(j),{"column-key":"direction",sortable:"",onSort:f},{default:s(()=>[c(r(e(l)("standalone.ips.bypass_direction")),1)]),_:1}),a(e(j),null,{default:s(()=>[c(r(e(l)("standalone.ips.description")),1)]),_:1}),a(e(j))]),_:1}),a(e(ue),null,{default:s(()=>[b.value.length<1?(i(),k(e(Z),{key:0},{default:s(()=>[a(e(L),{colspan:"4"},{default:s(()=>[a(e(Y),{description:e(l)("common.try_changing_search_filters"),icon:e(pe),title:e(l)("standalone.ips.no_bypasses_found"),class:"bg-white dark:bg-gray-950"},{default:s(()=>[a(e(A),{kind:"tertiary",onClick:o[2]||(o[2]=p=>m.value="")},{default:s(()=>[c(r(e(l)("common.clear_filters")),1)]),_:1})]),_:1},8,["description","icon","title"])]),_:1})]),_:1})):(i(!0),F(U,{key:1},ce(e(V),p=>(i(),k(e(Z),{key:`${p.ip}-${p.direction}`},{default:s(()=>[a(e(L),{"data-label":e(l)("standalone.ips.bypass_address")},{default:s(()=>[c(r(p.ip),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.bypass_direction")},{default:s(()=>[p.direction=="src"?(i(),F(U,{key:0},[c(r(e(l)("standalone.ips.source")),1)],64)):(i(),F(U,{key:1},[c(r(e(l)("standalone.ips.destination")),1)],64))]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.description")},{default:s(()=>[c(r(p.description),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("common.actions")},{default:s(()=>[h("div",tl,[a(e(ve),{items:B(p),"align-to-right":!0},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel","sortDescending","sortKey"])],64)):(i(),k(e(Y),{key:3,icon:e(le),title:e(l)("standalone.ips.no_filter_bypass")},{default:s(()=>[a(e(A),{kind:"primary",size:"lg",onClick:o[5]||(o[5]=p=>d.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(se),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.add_bypass")),1)]),_:1})]),_:1},8,["icon","title"])),a(Je,{visible:d.value,onClose:o[6]||(o[6]=p=>d.value=!1),onSave:o[7]||(o[7]=p=>z())},null,8,["visible"]),a(Ge,{bypass:I.value,onClose:o[8]||(o[8]=p=>I.value=void 0),onDeleted:o[9]||(o[9]=p=>O())},null,8,["bypass"])]))}}),il={class:"flex flex-wrap justify-end gap-6"},Se=M({__name:"IpsDisableRuleDrawer",props:{visible:{type:Boolean,default:!1},rule:{}},emits:["close","save"],setup(C,{emit:t}){const l=t,{t:d}=H(),$=n(""),u=n(""),v=n(""),g=n(new me),m=n(!1),b=n();function y(){m.value||l("close")}function _(){m.value=!0,b.value=void 0,g.value.clear(),q("ns.snort","disable-rule",{gid:$.value,sid:u.value,description:v.value}).then(()=>{l("save")}).catch(x=>{x instanceof ne?g.value=x.errorBag:b.value=x}).finally(()=>{m.value=!1})}return fe(()=>{var x,S,P;C.visible&&($.value=((x=C.rule)==null?void 0:x.gid)??"",u.value=((S=C.rule)==null?void 0:S.sid)??"",v.value=((P=C.rule)==null?void 0:P.description)??"")}),(x,S)=>(i(),k(e(ye),{"is-shown":x.visible,title:e(d)("standalone.ips.disable_rule"),onClose:y},{default:s(()=>[h("form",{class:"space-y-8",onSubmit:te(_,["prevent"])},[a(e(R),{modelValue:$.value,"onUpdate:modelValue":S[0]||(S[0]=P=>$.value=P),disabled:m.value||x.rule!=null,"invalid-message":e(d)(g.value.getFirstI18nKeyFor("gid")),label:e(d)("standalone.ips.rule_gid"),required:"",type:"number"},null,8,["modelValue","disabled","invalid-message","label"]),a(e(R),{modelValue:u.value,"onUpdate:modelValue":S[1]||(S[1]=P=>u.value=P),disabled:m.value||x.rule!=null,"invalid-message":e(d)(g.value.getFirstI18nKeyFor("sid")),label:e(d)("standalone.ips.rule_sid"),required:"",type:"number"},null,8,["modelValue","disabled","invalid-message","label"]),a(e(R),{modelValue:v.value,"onUpdate:modelValue":S[2]||(S[2]=P=>v.value=P),disabled:m.value,"invalid-message":e(d)(g.value.getFirstI18nKeyFor("description")),label:e(d)("standalone.ips.description"),required:""},null,8,["modelValue","disabled","invalid-message","label"]),S[3]||(S[3]=h("hr",null,null,-1)),h("div",il,[a(e(A),{disabled:m.value,kind:"tertiary",size:"lg",onClick:y},{default:s(()=>[c(r(e(d)("common.cancel")),1)]),_:1},8,["disabled"]),a(e(A),{disabled:m.value,loading:m.value,kind:"primary",size:"lg",type:"submit"},{default:s(()=>[c(r(e(d)("standalone.ips.disable_rule")),1)]),_:1},8,["disabled","loading"])])],32)]),_:1},8,["is-shown","title"]))}}),ol={class:"space-y-4"},dl=M({__name:"IpsEnableRuleModal",props:{rule:{}},emits:["close","enabled"],setup(C,{emit:t}){const{t:l}=H(),d=n();fe(()=>{C.rule!=null&&(d.value=C.rule)});const $=t,u=n(!1),v=n();function g(){u.value||$("close")}function m(){u.value=!0,v.value=void 0,q("ns.snort","enable-rule",{gid:d.value.gid,sid:d.value.sid}).then(()=>{$("enabled")}).catch(b=>{v.value=b}).finally(()=>{u.value=!1})}return(b,y)=>(i(),k(e(ke),{"cancel-label":e(l)("common.cancel"),"close-aria-label":e(l)("common.close"),"primary-button-disabled":u.value,"primary-button-loading":u.value,"primary-label":e(l)("common.delete"),title:e(l)("standalone.ips.enable_rule_modal_title"),visible:b.rule!=null,kind:"warning","primary-button-kind":"danger",onClose:y[0]||(y[0]=_=>g()),onPrimaryClick:y[1]||(y[1]=_=>m())},{default:s(()=>[h("div",ol,[v.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(v.value)),title:e(l)("standalone.ips.enable_rule_error"),kind:"error"},null,8,["description","title"])):E("",!0),h("p",null,r(e(l)("standalone.ips.enable_rule_modal_description",{id:`${d.value.gid}:${d.value.sid}`,description:d.value.description})),1)])]),_:1},8,["cancel-label","close-aria-label","primary-button-disabled","primary-button-loading","primary-label","title","visible"]))}}),we=M({__name:"IpsSnortDocLink",props:{gid:{},sid:{}},setup(C){const t=ee(()=>`https://snort.org/rule_docs/${C.gid}-${C.sid}`);return(l,d)=>(i(),k(e($e),{href:t.value,target:"_blank"},{default:s(()=>[c(r(`${l.gid}:${l.sid}`),1)]),_:1},8,["href"]))}}),rl={class:"space-y-8"},ul={class:"flex flex-wrap items-start justify-between gap-4"},pl={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},cl={class:"flex flex-col flex-wrap justify-between gap-4 md:flex-row"},vl={class:"flex justify-end"},bl=M({__name:"IpsDisabledRules",setup(C){const t=J(),{t:l}=H(),d=n(),$=n(!0),u=n([]);function v(){$.value=!0,q("ns.snort","list-disabled-rules",{}).then(w=>{u.value=w.data.rules}).catch(w=>{d.value=w}).finally(()=>{$.value=!1})}Q(()=>{v()});const g=n(""),m=ee(()=>u.value.filter(w=>Object.values(w).some(o=>o==null?void 0:o.toLowerCase().includes(g.value.toLowerCase()??!1)))),b=n("sid"),y=n(!1),{sortedItems:_}=ie(m,b,y,{}),x=n(10),{currentPage:S,paginatedItems:P}=oe(_,{itemsPerPage:x}),V=w=>{b.value=w.key,y.value=w.descending},f=n(!1);function z(){v(),t.getChanges(),f.value=!1}function B(w){return[{id:"delete",label:l("common.delete"),icon:"trash",iconStyle:"fas",danger:!0,action:()=>{I.value=w}}]}const I=n();function O(){v(),t.getChanges(),I.value=void 0}return(w,o)=>(i(),F("div",rl,[h("div",ul,[h("p",pl,r(e(l)("standalone.ips.disabled_rules_description")),1),a(_e)]),d.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(d.value)),title:e(l)("standalone.ips.error_loading_disabled_rules"),kind:"error"},null,8,["description","title"])):E("",!0),$.value?(i(),k(e(G),{key:1,lines:10})):u.value.length>0?(i(),F(U,{key:2},[h("div",cl,[a(e(R),{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=p=>g.value=p),modelModifiers:{trim:!0},placeholder:e(l)("common.filter"),"is-search":""},null,8,["modelValue","placeholder"]),u.value.length>0?(i(),k(e(A),{key:0,kind:"secondary",size:"lg",onClick:o[1]||(o[1]=p=>f.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(xe),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.disable_rule")),1)]),_:1})):E("",!0)]),a(e(be),{ariaLabel:e(l)("standalone.ips.rules_table"),"skeleton-columns":7,"skeleton-rows":5,sortDescending:y.value,sortKey:b.value,"card-breakpoint":"xl"},{paginator:s(()=>[a(e(de),{"current-page":e(S),"nav-pagination-label":e(l)("ne_table.pagination"),"next-label":e(l)("ne_table.go_to_next_page"),"page-size":x.value,"page-size-label":e(l)("ne_table.show"),"previous-label":e(l)("ne_table.go_to_previous_page"),"range-of-total-label":e(l)("ne_table.of"),"total-rows":u.value.length,onSelectPageSize:o[3]||(o[3]=p=>{x.value=p}),onSelectPage:o[4]||(o[4]=p=>{S.value=p})},null,8,["current-page","nav-pagination-label","next-label","page-size","page-size-label","previous-label","range-of-total-label","total-rows"])]),default:s(()=>[a(e(re),null,{default:s(()=>[a(e(j),{"column-key":"description",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.description")),1)]),_:1}),a(e(j),{"column-key":"sid",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.table_id_description")),1)]),_:1}),a(e(j))]),_:1}),a(e(ue),null,{default:s(()=>[m.value.length<1?(i(),k(e(Z),{key:0},{default:s(()=>[a(e(L),{colspan:"4"},{default:s(()=>[a(e(Y),{description:e(l)("common.try_changing_search_filters"),icon:e(pe),title:e(l)("standalone.ips.no_rules_found"),class:"bg-white dark:bg-gray-950"},{default:s(()=>[a(e(A),{kind:"tertiary",onClick:o[2]||(o[2]=p=>g.value="")},{default:s(()=>[c(r(e(l)("common.clear_filters")),1)]),_:1})]),_:1},8,["description","icon","title"])]),_:1})]),_:1})):(i(!0),F(U,{key:1},ce(e(P),p=>(i(),k(e(Z),{key:`${p.id}`},{default:s(()=>[a(e(L),{"data-label":e(l)("standalone.ips.description")},{default:s(()=>[c(r(p.description),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.table_id_description")},{default:s(()=>[a(we,{gid:p.gid,sid:p.sid},null,8,["gid","sid"])]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("common.actions")},{default:s(()=>[h("div",vl,[a(e(ve),{"align-to-right":!0,items:B(p)},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel","sortDescending","sortKey"])],64)):(i(),k(e(Y),{key:3,icon:e(le),title:e(l)("standalone.ips.no_disabled_rules")},{default:s(()=>[a(e(A),{kind:"primary",size:"lg",onClick:o[5]||(o[5]=p=>f.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(xe),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.disable_rule")),1)]),_:1})]),_:1},8,["icon","title"])),a(Se,{onSave:z,visible:f.value,onClose:o[6]||(o[6]=p=>f.value=!1)},null,8,["visible"]),a(dl,{rule:I.value,onEnabled:O,onClose:o[7]||(o[7]=p=>I.value=void 0)},null,8,["rule"])]))}}),fl={class:"flex flex-wrap justify-end gap-6"},ze=M({__name:"IpsSuppressAlertDrawer",props:{visible:{type:Boolean},alert:{}},emits:["close","suppress"],setup(C,{emit:t}){const{t:l}=H(),d=t,$=[{label:l("standalone.ips.source"),id:"by_src"},{label:l("standalone.ips.destination"),id:"by_dst"}];fe(()=>{var V,f,z,B,I;C.visible&&(m.value=((V=C.alert)==null?void 0:V.gid)??"",b.value=((f=C.alert)==null?void 0:f.sid)??"",y.value=((z=C.alert)==null?void 0:z.direction)??"by_src",_.value=((B=C.alert)==null?void 0:B.ip)??"",x.value=((I=C.alert)==null?void 0:I.description)??"")});const u=n(!1),v=n(),g=n(new me),m=n(""),b=n(""),y=n("by_src"),_=n(""),x=n("");function S(){u.value||d("close")}function P(){u.value=!0,v.value=void 0,g.value.clear(),q("ns.snort","suppress-alert",{gid:m.value,sid:b.value,direction:y.value,ip:_.value,description:x.value}).then(()=>{d("suppress")}).catch(V=>{V instanceof ne?g.value=V.errorBag:v.value=V}).finally(()=>{u.value=!1})}return(V,f)=>(i(),k(e(ye),{"is-shown":V.visible,title:e(l)("standalone.ips.add_suppressed_alert"),onClose:S},{default:s(()=>[h("form",{class:"space-y-8",onSubmit:f[5]||(f[5]=te(z=>P(),["prevent"]))},[v.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(v.value)),title:e(l)("standalone.ips.error_suppressing_alert"),kind:"error"},null,8,["description","title"])):E("",!0),a(e(R),{modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=z=>m.value=z),disabled:u.value||V.alert!=null,label:e(l)("standalone.ips.gid_label"),"invalid-message":e(l)(g.value.getFirstI18nKeyFor("gid")),required:"",type:"number"},null,8,["modelValue","disabled","label","invalid-message"]),a(e(R),{modelValue:b.value,"onUpdate:modelValue":f[1]||(f[1]=z=>b.value=z),disabled:u.value||V.alert!=null,label:e(l)("standalone.ips.sid_label"),"invalid-message":e(l)(g.value.getFirstI18nKeyFor("sid")),required:"",type:"number"},null,8,["modelValue","disabled","label","invalid-message"]),a(e(ae),{modelValue:y.value,"onUpdate:modelValue":f[2]||(f[2]=z=>y.value=z),disabled:u.value||V.alert!=null,label:e(l)("standalone.ips.direction"),options:$},null,8,["modelValue","disabled","label"]),a(e(R),{modelValue:_.value,"onUpdate:modelValue":f[3]||(f[3]=z=>_.value=z),disabled:u.value||V.alert!=null,label:e(l)("standalone.ips.address"),"invalid-message":e(l)(g.value.getFirstI18nKeyFor("ip")),"helper-text":e(l)("standalone.ips.address_helper"),required:""},null,8,["modelValue","disabled","label","invalid-message","helper-text"]),a(e(R),{modelValue:x.value,"onUpdate:modelValue":f[4]||(f[4]=z=>x.value=z),disabled:u.value,label:e(l)("standalone.ips.description"),"invalid-message":e(l)(g.value.getFirstI18nKeyFor("description"))},null,8,["modelValue","disabled","label","invalid-message"]),f[6]||(f[6]=h("hr",null,null,-1)),h("div",fl,[a(e(A),{disabled:u.value,kind:"tertiary",size:"lg",onClick:S},{default:s(()=>[c(r(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),a(e(A),{disabled:u.value,loading:u.value,kind:"primary",size:"lg",type:"submit"},{default:s(()=>[c(r(e(l)("standalone.ips.add_suppressed_alert")),1)]),_:1},8,["disabled","loading"])])],32)]),_:1},8,["is-shown","title"]))}}),_l={class:"space-y-4"},gl=M({__name:"IpsRestoreSuppressedAlertModal",props:{alert:{}},emits:["close","restored"],setup(C,{emit:t}){const{t:l}=H(),d=n();fe(()=>{C.alert!=null&&(d.value=C.alert)});const $=t,u=n(!1),v=n();function g(){u.value||$("close")}function m(){u.value=!0,v.value=void 0,q("ns.snort","delete-suppression",{gid:C.alert.gid,sid:C.alert.sid,direction:C.alert.direction,ip:C.alert.ip}).then(()=>{$("restored")}).catch(b=>{v.value=b}).finally(()=>{u.value=!1})}return(b,y)=>(i(),k(e(ke),{"cancel-label":e(l)("common.cancel"),"close-aria-label":e(l)("common.close"),"primary-button-disabled":u.value,"primary-button-loading":u.value,"primary-label":e(l)("common.delete"),title:e(l)("standalone.ips.delete_suppressed_alert_modal_title"),visible:b.alert!=null,kind:"warning","primary-button-kind":"danger",onClose:y[0]||(y[0]=_=>g()),onPrimaryClick:y[1]||(y[1]=_=>m())},{default:s(()=>[h("div",_l,[v.value?(i(),k(e(W),{key:0,kind:"error",title:e(l)("standalone.ips.delete_suppressed_alert_error"),description:e(l)(e(X)(v.value))},null,8,["title","description"])):E("",!0),h("p",null,r(e(l)("standalone.ips.delete_suppressed_alert_description",{id:`${d.value.gid}:${d.value.sid}`,ip:d.value.ip,direction:d.value.direction=="by_src"?e(l)("standalone.ips.source"):e(l)("standalone.ips.destination")})),1)])]),_:1},8,["cancel-label","close-aria-label","primary-button-disabled","primary-button-loading","primary-label","title","visible"]))}}),ml={class:"space-y-8"},yl={class:"flex flex-wrap items-start justify-between gap-4"},kl={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},wl={class:"flex flex-col flex-wrap justify-between gap-4 md:flex-row"},xl={class:"flex justify-end"},$l=M({__name:"IpsSuppressedAlerts",setup(C){const t=J(),{t:l}=H(),d=n([]),$=n(!0),u=n();function v(){$.value=!0,q("ns.snort","list-suppressed-alerts",{}).then(w=>{d.value=w.data.alerts}).catch(w=>{u.value=w}).finally(()=>{$.value=!1})}Q(()=>{v()});const g=n(""),m=ee(()=>d.value.filter(w=>Object.values(w).some(o=>o.toLowerCase().includes(g.value.toLowerCase())))),b=n("sid"),y=n(!1),{sortedItems:_}=ie(m,b,y,{}),x=n(10),{currentPage:S,paginatedItems:P}=oe(_,{itemsPerPage:x}),V=w=>{b.value=w.key,y.value=w.descending},f=n(!1);function z(){t.getChanges(),v(),f.value=!1}function B(w){return[{id:"delete",label:l("common.delete"),icon:"trash",iconStyle:"fas",danger:!0,action:()=>{I.value=w}}]}const I=n();function O(){v(),I.value=void 0,t.getChanges()}return(w,o)=>(i(),F(U,null,[h("div",ml,[h("div",yl,[h("p",kl,r(e(l)("standalone.ips.suppressed_alerts_description")),1),a(_e)]),u.value?(i(),k(e(W),{key:0,description:e(l)(e(X)(u.value)),title:e(l)("standalone.ips.error_loading_suppressed_alerts"),kind:"error"},null,8,["description","title"])):E("",!0),$.value?(i(),k(e(G),{key:1,size:"lg",lines:10})):d.value.length>0?(i(),F(U,{key:2},[h("div",wl,[a(e(R),{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=p=>g.value=p),modelModifiers:{trim:!0},placeholder:e(l)("common.filter"),"is-search":""},null,8,["modelValue","placeholder"]),a(e(A),{kind:"secondary",size:"lg",onClick:o[1]||(o[1]=p=>f.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(se),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.add_bypass")),1)]),_:1})]),a(e(be),{ariaLabel:e(l)("standalone.ips.suppressed_alerts_tab"),"skeleton-columns":7,"skeleton-rows":5,sortDescending:y.value,sortKey:b.value,"card-breakpoint":"xl"},{paginator:s(()=>[a(e(de),{"current-page":e(S),"nav-pagination-label":e(l)("ne_table.pagination"),"next-label":e(l)("ne_table.go_to_next_page"),"page-size":x.value,"page-size-label":e(l)("ne_table.show"),"previous-label":e(l)("ne_table.go_to_previous_page"),"range-of-total-label":e(l)("ne_table.of"),"total-rows":d.value.length,onSelectPageSize:o[3]||(o[3]=p=>{x.value=p}),onSelectPage:o[4]||(o[4]=p=>{S.value=p})},null,8,["current-page","nav-pagination-label","next-label","page-size","page-size-label","previous-label","range-of-total-label","total-rows"])]),default:s(()=>[a(e(re),null,{default:s(()=>[a(e(j),{"column-key":"description",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.description")),1)]),_:1}),a(e(j),{"column-key":"sid",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.table_id_description")),1)]),_:1}),a(e(j),{"column-key":"direction",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.direction")),1)]),_:1}),a(e(j),{"column-key":"ip",sortable:"",onSort:V},{default:s(()=>[c(r(e(l)("standalone.ips.address")),1)]),_:1}),a(e(j))]),_:1}),a(e(ue),null,{default:s(()=>[m.value.length<1?(i(),k(e(Z),{key:0},{default:s(()=>[a(e(L),{colspan:"5"},{default:s(()=>[a(e(Y),{description:e(l)("common.try_changing_search_filters"),icon:e(pe),title:e(l)("standalone.ips.no_suppressed_alerts_found"),class:"bg-white dark:bg-gray-950"},{default:s(()=>[a(e(A),{kind:"tertiary",onClick:o[2]||(o[2]=p=>g.value="")},{default:s(()=>[c(r(e(l)("common.clear_filters")),1)]),_:1})]),_:1},8,["description","icon","title"])]),_:1})]),_:1})):(i(!0),F(U,{key:1},ce(e(P),p=>(i(),k(e(Z),{key:`${p.ip}-${p.direction}`},{default:s(()=>[a(e(L),{"data-label":e(l)("standalone.ips.description")},{default:s(()=>[c(r(p.description),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.table_id_description")},{default:s(()=>[a(we,{gid:p.gid,sid:p.sid},null,8,["gid","sid"])]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.direction")},{default:s(()=>[p.direction=="by_src"?(i(),F(U,{key:0},[c(r(e(l)("standalone.ips.source")),1)],64)):(i(),F(U,{key:1},[c(r(e(l)("standalone.ips.destination")),1)],64))]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("standalone.ips.address")},{default:s(()=>[c(r(p.ip),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(l)("common.actions")},{default:s(()=>[h("div",xl,[a(e(ve),{items:B(p),"align-to-right":!0},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel","sortDescending","sortKey"])],64)):(i(),k(e(Y),{key:3,icon:e(le),title:e(l)("standalone.ips.no_suppressed_alerts")},{default:s(()=>[a(e(A),{kind:"primary",size:"lg",onClick:o[5]||(o[5]=p=>f.value=!0)},{prefix:s(()=>[a(e(N),{icon:e(se),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(l)("standalone.ips.add_suppressed_alert")),1)]),_:1})]),_:1},8,["icon","title"]))]),a(ze,{onSuppress:o[6]||(o[6]=p=>z()),visible:f.value,onClose:o[7]||(o[7]=p=>f.value=!1)},null,8,["visible"]),a(gl,{alert:I.value,onClose:o[8]||(o[8]=p=>I.value=void 0),onRestored:o[9]||(o[9]=p=>O())},null,8,["alert"])],64))}}),hl={class:"flex flex-col items-center gap-5"},Vl={class:"text-center"},Cl=M({__name:"IpsDisabledEmptyState",setup(C){const{t}=H(),l=Ue();return(d,$)=>(i(),k(e(Y),{icon:e(le),title:e(t)("standalone.ips.ips_is_disabled")},{default:s(()=>[h("div",hl,[h("span",Vl,r(e(t)("standalone.ips.ips_is_disabled_description")),1),a(e(A),{size:"lg",onClick:$[0]||($[0]=()=>e(l).push(`${e(je)()}/security/ips?tab=settings`))},{prefix:s(()=>[a(e(N),{icon:e(Ve),"aria-hidden":"true",class:"h-4 w-4"},null,8,["icon"])]),default:s(()=>[c(" "+r(e(t)("standalone.ips.go_to_settings")),1)]),_:1})])]),_:1},8,["icon","title"]))}}),Sl={class:"space-y-8"},zl={class:"flex flex-wrap items-start justify-between gap-4"},Il={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},Dl={class:"flex flex-wrap items-center gap-4"},Pl=["title"],Fl={class:"flex items-center gap-2"},Ll={class:"-ml-2.5 flex justify-start xl:ml-0 xl:justify-end"},Bl=M({__name:"IpsEventList",setup(C){const{t}=H(),l=Ce(),d=J(),$=n(!0),u=n([]),v=n();Q(()=>{q("ns.snort","list-events").then(K=>{u.value=K.data.events}).catch(K=>{v.value=K}).finally(()=>{$.value=!1})});const g=n([{id:"any",label:t("common.any")},{id:"drop",label:t("standalone.ips.drop")},{id:"alert",label:t("standalone.ips.alert")},{id:"allow",label:t("standalone.ips.allow")}]),m=n(""),b=n(["any"]);function y(){m.value="",b.value=["any"]}const _=ee(()=>u.value.filter(K=>{const T=m.value.toLowerCase(),D=b.value;return(T===""||Object.values(K).some(ge=>(ge==null?void 0:ge.toString().toLowerCase().includes(T))??!1))&&(D.includes("any")||D.includes(K.action))})),x=n("timestamp"),S=n(!0),{sortedItems:P}=ie(_,x,S,{}),V=n(10),{currentPage:f,paginatedItems:z}=oe(P,{itemsPerPage:V}),B=K=>{x.value=K.key,S.value=K.descending};function I(K){return[{id:"disable-rule",label:t("standalone.ips.disable_rule"),icon:"circle-xmark",iconStyle:"fas",action:()=>{O.value={gid:K.gid.toString(),sid:K.sid.toString(),description:K.description}}},{id:"source-suppress-alert",label:t("standalone.ips.source_suppress_alert"),icon:"eye-slash",iconStyle:"fas",action:()=>{o.value={gid:K.gid.toString(),sid:K.sid.toString(),description:K.description,direction:"by_src",ip:K.source_address}}},{id:"destination-suppress-alert",label:t("standalone.ips.destination_suppress_alert"),icon:"eye-slash",iconStyle:"fas",action:()=>{o.value={gid:K.gid.toString(),sid:K.sid.toString(),description:K.description,direction:"by_dst",ip:K.destination_address}}}]}const O=n();function w(){O.value=void 0,d.getChanges()}const o=n();function p(){o.value=void 0,d.getChanges()}return(K,T)=>(i(),F(U,null,[h("div",Sl,[h("div",zl,[h("p",Il,r(e(t)("standalone.ips.event_list_description")),1),e(l).enabled?(i(),k(_e,{key:0})):E("",!0)]),$.value?(i(),k(e(G),{key:0,lines:8,size:"lg"})):e(l).enabled==!1?(i(),k(Cl,{key:1})):(i(),F(U,{key:2},[v.value?(i(),k(e(W),{key:0,description:e(t)(e(X)(v.value)),title:e(t)("standalone.ips.error_loading_events"),kind:"error"},null,8,["description","title"])):E("",!0),u.value.length>0?(i(),F(U,{key:1},[h("div",Dl,[a(e(R),{modelValue:m.value,"onUpdate:modelValue":T[0]||(T[0]=D=>m.value=D),modelModifiers:{trim:!0},placeholder:e(t)("standalone.ips.filter_events"),"is-search":""},null,8,["modelValue","placeholder"]),a(e(Ae),{modelValue:b.value,"onUpdate:modelValue":T[1]||(T[1]=D=>b.value=D),clearFilterLabel:e(t)("ne_dropdown_filter.clear_filter"),label:e(t)("standalone.ips.type"),openMenuAriaLabel:e(t)("ne_dropdown_filter.open_filter"),options:g.value,kind:"radio"},null,8,["modelValue","clearFilterLabel","label","openMenuAriaLabel","options"]),a(e(A),{kind:"tertiary",onClick:y},{default:s(()=>[c(r(e(t)("common.clear_filters")),1)]),_:1})]),a(e(be),{ariaLabel:e(t)("standalone.ips.event_list_tab"),sortDescending:S.value,sortKey:x.value,"card-breakpoint":"xl"},{paginator:s(()=>[a(e(de),{"current-page":e(f),"nav-pagination-label":e(t)("ne_table.pagination"),"next-label":e(t)("ne_table.go_to_next_page"),"page-size":V.value,"page-size-label":e(t)("ne_table.show"),"previous-label":e(t)("ne_table.go_to_previous_page"),"range-of-total-label":e(t)("ne_table.of"),"total-rows":_.value.length,onSelectPageSize:T[2]||(T[2]=D=>{V.value=D}),onSelectPage:T[3]||(T[3]=D=>{f.value=D})},null,8,["current-page","nav-pagination-label","next-label","page-size","page-size-label","previous-label","range-of-total-label","total-rows"])]),default:s(()=>[a(e(re),null,{default:s(()=>[a(e(j),{"column-key":"timestamp",sortable:"",onSort:B},{default:s(()=>[c(r(e(t)("standalone.ips.date")),1)]),_:1}),a(e(j),{"column-key":"action"},{default:s(()=>[c(r(e(t)("standalone.ips.type")),1)]),_:1}),a(e(j),{"column-key":"description"},{default:s(()=>[c(r(e(t)("standalone.ips.description")),1)]),_:1}),a(e(j),{"column-key":"source_address"},{default:s(()=>[c(r(e(t)("standalone.ips.source")),1)]),_:1}),a(e(j),{"column-key":"destination_address"},{default:s(()=>[c(r(e(t)("standalone.ips.destination")),1)]),_:1}),a(e(j),{"column-key":"protocol"},{default:s(()=>[c(r(e(t)("standalone.ips.protocol")),1)]),_:1}),a(e(j),{"column-key":"sid"},{default:s(()=>[c(r(e(t)("standalone.ips.table_id_description")),1)]),_:1}),a(e(j),{"column-key":"actions"})]),_:1}),a(e(ue),null,{default:s(()=>[_.value.length<1?(i(),k(e(Z),{key:0},{default:s(()=>[a(e(L),{colspan:"8"},{default:s(()=>[a(e(Y),{description:e(t)("common.try_changing_search_filters"),icon:e(pe),title:e(t)("standalone.ips.no_events_found"),class:"bg-white dark:bg-gray-950"},{default:s(()=>[a(e(A),{kind:"tertiary",onClick:y},{default:s(()=>[c(r(e(t)("common.clear_filters")),1)]),_:1})]),_:1},8,["description","icon","title"])]),_:1})]),_:1})):(i(!0),F(U,{key:1},ce(e(z),D=>(i(),k(e(Z),{key:`${D.id}-${D.timestamp}`},{default:s(()=>[a(e(L),{"data-label":e(t)("standalone.ips.date"),class:"text-nowrap"},{default:s(()=>[h("span",{title:D.timestamp},r(e(Te)(new Date(D.timestamp),"PPpp")),9,Pl)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.type")},{default:s(()=>[h("span",Fl,[D.action=="allow"?(i(),F(U,{key:0},[a(e(N),{icon:e(Ve),class:"text-green-500"},null,8,["icon"]),c(" "+r(e(t)("standalone.ips.allow")),1)],64)):D.action=="drop"?(i(),F(U,{key:1},[a(e(N),{icon:e(Ee),class:"text-red-500"},null,8,["icon"]),c(" "+r(e(t)("standalone.ips.drop")),1)],64)):(i(),F(U,{key:2},[a(e(N),{icon:e(Re),class:"text-amber-700 dark:text-amber-500"},null,8,["icon"]),c(" "+r(e(t)("standalone.ips.alert")),1)],64))])]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.description")},{default:s(()=>[c(r(D.description),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.source")},{default:s(()=>[c(r(D.source_address),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.destination")},{default:s(()=>[c(r(D.destination_address),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.protocol")},{default:s(()=>[c(r(D.protocol),1)]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("standalone.ips.table_id_description")},{default:s(()=>[a(we,{gid:D.gid,sid:D.sid},null,8,["gid","sid"])]),_:2},1032,["data-label"]),a(e(L),{"data-label":e(t)("common.actions")},{default:s(()=>[h("div",Ll,[a(e(ve),{"align-to-right":!0,items:I(D)},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel","sortDescending","sortKey"])],64)):(i(),k(e(Y),{key:2,icon:e(le),title:e(t)("standalone.ips.event_list_no_events")},null,8,["icon","title"]))],64))]),a(Se,{rule:O.value,visible:O.value!=null,onClose:T[4]||(T[4]=D=>O.value=void 0),onSave:T[5]||(T[5]=D=>w())},null,8,["rule","visible"]),a(ze,{alert:o.value,visible:o.value!=null,onClose:T[6]||(T[6]=D=>o.value=void 0),onSuppress:T[7]||(T[7]=D=>p())},null,8,["alert","visible"])],64))}}),Kl={class:"space-y-8"},El=M({__name:"IpsView",setup(C){const{t}=H(),{tabs:l,selectedTab:d}=qe([{name:"event_list",label:t("standalone.ips.event_list_tab")},{name:"filter_bypass",label:t("standalone.ips.filter_bypass_tab")},{name:"disabled_rules",label:t("standalone.ips.disabled_rules_tab")},{name:"suppressed_alerts",label:t("standalone.ips.suppressed_alerts_tab")},{name:"settings",label:t("standalone.ips.settings_tab")}]);return($,u)=>(i(),F("div",Kl,[a(e(Me),{tag:"h3"},{default:s(()=>[c(r(e(t)("standalone.ips.title")),1)]),_:1}),a(e(Oe),{selected:e(d),srSelectTabLabel:e(t)("ne_tabs.select_a_tab"),srTabsLabel:e(t)("ne_tabs.tabs"),tabs:e(l),onSelectTab:u[0]||(u[0]=v=>d.value=v)},null,8,["selected","srSelectTabLabel","srTabsLabel","tabs"]),e(d)=="event_list"?(i(),k(Bl,{key:0})):E("",!0),e(d)=="filter_bypass"?(i(),k(nl,{key:1})):E("",!0),e(d)=="disabled_rules"?(i(),k(bl,{key:2})):E("",!0),e(d)=="suppressed_alerts"?(i(),k($l,{key:3})):E("",!0),e(d)=="settings"?(i(),k(Xe,{key:4})):E("",!0)]))}});export{El as default};
