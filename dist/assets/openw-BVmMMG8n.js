import{d as z,u as A,ac as B,r as l,o as D,ay as V,az as x,h as n,i as k,w as m,j as i,t as w,l as t,L as I,n as _,k as u,a5 as U,q as g,Q as y,aA as F,aB as h,z as T,ad as $,m as M,_ as W}from"./index-BlEQ5104.js";import{_ as j}from"./FormLayout.vue_vue_type_script_setup_true_lang-DaMAl8E3.js";const q={key:1,class:"flex flex-col gap-y-3"},K=["value"],G=z({__name:"openw",setup(O){const{t:b}=A(),C=B(),r=l(!1),d=l(""),c=l("wg0"),v=l(""),p=l(!1),S=l(!1),f=l(!1),s=l({title:"",description:""});D(()=>{E()});async function E(){try{S.value=!0;const o=await V.post(`${x()}/sd_controller`,{method:"get-config",payload:{}});if(o.data.code===200){const e=o.data.data;r.value=e.service==="enable",d.value=e.url,c.value=e.management_interface,v.value=e.shared_secret,p.value=e.verify_ssl==="1"}}catch{s.value={title:"Error",description:"Failed to fetch sd-controller configuration."}}finally{S.value=!1}}const L=l([{label:"wg0",value:"wg0"},{label:"zt0",value:"zt0"}]);async function N(){try{if(f.value=!0,(await V.post(`${x()}/sd_controller`,{method:"set-config",payload:{service:r.value?"enable":"disable",url:d.value,management_interface:c.value,shared_secret:v.value,verify_ssl:p.value?"1":"0"}})).data.code===200)C.createNotification({title:"Success",description:"Configuration saved successfully.",kind:"success"});else throw new Error("Failed to save configuration.")}catch(o){console.error("Error:",o),s.value={title:"Error",description:"Failed to save OpenWISP configuration."}}finally{f.value=!1}}return(o,e)=>(n(),k(j,{class:"max-w-4xl"},{description:m(()=>[i("p",null,w(t(b)("SDWAN Controller")),1)]),default:m(()=>[s.value.title?(n(),k(t(I),{key:0,class:"my-4",kind:"error",title:s.value.title,description:s.value.description},null,8,["title","description"])):_("",!0),u(t(U),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),topLabel:t(b)("Status"),label:r.value?"Enabled":"Disabled"},null,8,["modelValue","topLabel","label"]),r.value?(n(),g("div",q,[u(t(y),{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),label:"Server Address"},null,8,["modelValue"]),e[7]||(e[7]=i("label",{for:""},"Interface",-1)),F(i("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),style:{width:"100%",height:"36px",padding:"6px",border:"1px solid #ccc","border-radius":"5px","font-size":"14px",outline:"none",transition:"border-color 0.3s ease-in-out"}},[e[5]||(e[5]=i("option",{disabled:"",value:""},"Select Interface",-1)),(n(!0),g(T,null,$(L.value,a=>(n(),g("option",{key:a.value,value:a.value},w(a.label),9,K))),128))],512),[[h,c.value]]),u(t(y),{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=a=>v.value=a),label:"Secret",type:"password"},null,8,["modelValue"]),e[8]||(e[8]=i("label",{for:"TLS Verify"},"TLS Verify",-1)),u(t(y),{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=a=>p.value=a),type:"checkbox",class:"w-4 h-4 border-gray-300 rounded text-primary-600 focus:ring-primary-600 dark:border-gray-700 dark:text-primary-600 dark:focus:ring-primary-400"},null,8,["modelValue"]),u(t(W),{loading:f.value,kind:"primary",onClick:N,class:"ml-2.5"},{default:m(()=>e[6]||(e[6]=[M("Save")])),_:1},8,["loading"])])):_("",!0)]),_:1}))}});export{G as default};
