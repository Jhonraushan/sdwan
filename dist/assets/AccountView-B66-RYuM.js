import{d as C,u as H,c2 as M,r,aa as U,J as j,h as v,q as $,i as x,l as e,V as z,L as B,n as F,k as t,Q as p,w as u,s as A,m as k,t as y,j as _,_ as I,e as K,ag as L,S as R,cw as W,cx as D,W as J,z as Q}from"./index-BlEQ5104.js";import{_ as b}from"./FormLayout.vue_vue_type_script_setup_true_lang-DaMAl8E3.js";import{_ as T,a as G}from"./ChangeLangCombobox.vue_vue_type_script_setup_true_lang-DOASKUkR.js";const O={class:"space-y-6"},X={class:"flex justify-end"},Y=C({__name:"ChangePassword",setup(E){const{t:s}=H(),f=M(),c=r(""),l=r(""),m=r(""),o=r(new U),i=r(!1),w=r(),g=r(!1),V=r(),P=r(),S=r();j(()=>o.value.keys(),()=>{var n,d,h;const a=Array.from(o.value.keys());if(a.length!=0)switch(a[0]){case"new_password":(n=P.value)==null||n.focus();break;case"confirm_password":(d=S.value)==null||d.focus();break;case"old_password":(h=V.value)==null||h.focus();break}});function N(){o.value.clear();let a=R(c.value).errMessage;return a&&o.value.set("old_password",String(a)),a=R(l.value).errMessage,a&&o.value.set("new_password",String(a)),a=W(l.value).errMessage,a&&o.value.set("new_password",String(a)),a=D(l.value,m.value).errMessage,a&&o.value.set("confirm_password",String(a)),o.value.size==0}function q(){N()&&(i.value=!0,g.value=!1,K("ns.account","set-password",{old_password:c.value,username:f.username,password:l.value}).then(()=>{g.value=!0,c.value="",l.value="",m.value=""}).catch(a=>{a instanceof L?o.value=a.errorBag:w.value=a}).finally(()=>i.value=!1))}return(a,n)=>(v(),$("div",O,[w.value?(v(),x(e(B),{key:0,title:e(s)(e(z)(w.value)),kind:"error"},null,8,["title"])):F("",!0),g.value?(v(),x(e(B),{key:1,title:e(s)("standalone.change_password.success_message"),kind:"success"},null,8,["title"])):F("",!0),t(e(p),{ref_key:"oldPasswordHtmlRef",ref:V,modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=d=>c.value=d),disabled:i.value,"invalid-message":e(s)(o.value.getFirstI18nKeyFor("old_password")),label:e(s)("standalone.change_password.old_password"),"is-password":""},null,8,["modelValue","disabled","invalid-message","label"]),t(e(p),{ref_key:"newPasswordHtmlRef",ref:P,modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=d=>l.value=d),disabled:i.value,"invalid-message":e(s)(o.value.getFirstFor("new_password")),label:e(s)("standalone.change_password.new_password"),"is-password":""},{tooltip:u(()=>[t(e(A),null,{content:u(()=>[k(y(e(s)("standalone.change_password.password_rules")),1)]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label"]),t(e(p),{ref_key:"confirmPasswordHtmlRef",ref:S,modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=d=>m.value=d),disabled:i.value,"invalid-message":e(s)(o.value.getFirstFor("confirm_password")),label:e(s)("standalone.change_password.confirm_password"),"is-password":""},null,8,["modelValue","disabled","invalid-message","label"]),_("div",X,[t(e(I),{disabled:i.value,loading:i.value,kind:"primary",onClick:n[3]||(n[3]=d=>q())},{default:u(()=>[k(y(e(s)("common.save")),1)]),_:1},8,["disabled","loading"])])]))}}),Z={class:"max-w-3xl space-y-8"},le=C({__name:"AccountView",setup(E){const{t:s}=H(),f=M();return(c,l)=>(v(),$(Q,null,[t(e(J),{tag:"h3",class:"mb-7"},{default:u(()=>[k(y(e(s)("standalone.account_management.title",{name:e(f).username})),1)]),_:1}),_("div",Z,[t(b,{title:e(s)("standalone.account_management.ui_language")},{default:u(()=>[t(T)]),_:1},8,["title"]),l[0]||(l[0]=_("div",{class:"border-b border-gray-200 dark:border-gray-700"},null,-1)),t(b,{title:e(s)("standalone.account_management.change_password"),description:e(s)("standalone.account_management.change_password_description")},{default:u(()=>[t(Y)]),_:1},8,["title","description"]),l[1]||(l[1]=_("div",{class:"border-b border-gray-200 dark:border-gray-700"},null,-1)),t(b,{title:e(s)("standalone.two_fa.title"),description:e(s)("standalone.two_fa.description")},{default:u(()=>[t(G)]),_:1},8,["title","description"])])],64))}});export{le as default};
