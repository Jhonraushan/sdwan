import{d as ve,u as ge,r as d,aa as dl,c as H,J as he,g as Le,h as o,i as h,w as r,j as f,l as e,L as ee,n as U,k as i,a5 as Ue,Q as Oe,M as te,m as k,t as c,q as S,ar as je,aA as Se,aR as De,s as W,a0 as pe,z as Y,_ as ie,a6 as cl,R as fe,ai as pl,bH as vl,T as le,e as re,V as ue,ag as bl,S as oe,bK as Ie,a_ as ze,bh as Be,bS as qe,bN as _l,bT as ml,Y as fl,bm as gl,bt as yl,I as Ke,ad as Ve,av as B,B as xe,y as $e,o as We,a4 as Me,b5 as Ze,ap as Rl,U as wl,aj as He,W as kl,a9 as Sl}from"./index-BlEQ5104.js";import{u as Dl}from"./useTabs-BeLQ169O.js";import{u as Ye}from"./firewall-C9mbeSo1.js";import{_ as Ne}from"./NeMultiTextInput.vue_vue_type_script_setup_true_lang-DwfeP71-.js";import{u as Ol}from"./useObjects-D-lIOcFM.js";import{_ as xl}from"./NeTable.vue_vue_type_script_setup_true_lang-BDPau7Vg.js";/* empty css                                                */import{C as hl}from"./network-qu7sidyZ.js";import{_ as Ll,u as Vl,a as jl}from"./useDomainSets-DcuIzYPq.js";import{_ as Tl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Cl}from"./uniq-DGkY_-95.js";import"./isArrayLikeObject-CpCvCe5A.js";const Al={class:"space-y-6"},$l={class:"space-y-6"},Ml={class:"flex justify-end"},El=ve({__name:"CreateOrEditFirewallRuleDrawer",props:{ruleType:{type:String,required:!0},currentRule:{type:Object},isDuplicatingRule:{type:Boolean,default:!1},isShown:{type:Boolean,default:!1},knownTags:{type:Array,required:!0}},emits:["close","reloadData"],setup(b,{emit:_}){const t=b,E=_,{t:l}=ge(),{getObjectIcon:D}=Ol(),y=Ye(),O=d(!0),T=d(""),I=d(),j=d("source_address"),L=d("destination_address"),C=d([""]),R=d([""]),Q=d(""),z=d(""),X=d(),K=d(),J=d("*"),G=d(),P=d("*"),de=d(),be=d([]),Z=d("*"),_e=d(),me=d([]),se=d("DROP"),v=d([]),A=d(),g=d([]),p=d(""),u=d(),V=d("bottom"),$=d(!1),M=d([]),q=d(!1),m=d(new dl),ae=d([]),ye=d([]),Ge=d([{id:"DROP",label:"DROP"},{id:"REJECT",label:"REJECT"},{id:"ACCEPT",label:"ACCEPT"}]),Qe=d([{id:"bottom",label:l("standalone.firewall_rules.add_to_the_bottom")},{id:"top",label:l("standalone.firewall_rules.add_to_the_top")}]),Xe=d([{id:"source_address",label:l("standalone.firewall_rules.enter_one_or_more_addresses")},{id:"source_object",label:l("standalone.firewall_rules.select_an_object")},{id:"source_any",label:l("standalone.firewall_rules.any_source_address")}]),el=d([{id:"destination_address",label:l("standalone.firewall_rules.enter_one_or_more_addresses")},{id:"destination_object",label:l("standalone.firewall_rules.select_an_object")},{id:"destination_any",label:l("standalone.firewall_rules.any_destination_address")}]);let w=d({listServiceSuggestions:!1,listObjectSuggestions:!1,listProtocols:!1,saveRule:!1}),x=d({listServiceSuggestions:"",listServiceSuggestionsDetails:"",listObjectSuggestions:"",listObjectSuggestionsDetails:"",listProtocols:"",listProtocolsDetails:"",saveRule:"",saveRuleDetails:""});const Te=H(()=>!t.currentRule),Re=H(()=>!!t.currentRule&&!t.isDuplicatingRule),ll=H(()=>{if(Re.value)return l("standalone.firewall_rules.edit_rule");if(t.isDuplicatingRule)return l("standalone.firewall_rules.duplicate_rule");switch(t.ruleType){case"forward":return l("standalone.firewall_rules.add_forward_rule");case"input":return l("standalone.firewall_rules.add_input_rule");case"output":return l("standalone.firewall_rules.add_output_rule");default:return""}}),tl=H(()=>[...[{id:"*",label:l("common.any")},{id:"custom",label:l("standalone.firewall_rules.custom_service")}],...me.value]),Ee=H(()=>{const n={id:"*",label:l("common.any")},s=y.zones.map(F=>{var N;return{id:F.name,label:F.name.toUpperCase(),description:(N=F.interfaces)==null?void 0:N.join(", ")}});return[n,...s]}),Ce=H(()=>v.value.some(n=>n.id==="tcp"||n.id==="udp")),Fe=H(()=>be.value.map(n=>({id:n.id,label:n.name,description:l(`standalone.objects.subtype_${n.subtype}`),icon:D(n.subtype)})));he(()=>t.isShown,()=>{var n;t.isShown&&(Pe(),m.value.clear(),vl(()=>{le(I)}),nl(),ol(),Te.value?(O.value=!0,T.value="",j.value="source_address",L.value="destination_address",C.value=[""],Q.value="",R.value=[""],z.value="",J.value="*",P.value="*",Z.value="*",se.value="DROP",v.value=[],p.value="",V.value="bottom",M.value=[],q.value=!1,$.value=!1):t.currentRule&&(O.value=t.currentRule.enabled||!1,J.value=t.currentRule.src||"*",P.value=t.currentRule.dest||"*",Z.value="*",v.value=[],se.value=t.currentRule.target||"DROP",V.value="bottom",M.value=((n=t.currentRule.ns_tag)==null?void 0:n.map(s=>({id:s,label:s})))||[],q.value=t.currentRule.log||!1,$.value=M.value.length>0||q.value,Re.value?T.value=t.currentRule.name||"":T.value=l("standalone.firewall_rules.duplicated_rule_name",{name:t.currentRule.name})))}),he(()=>Z.value,()=>{Z.value==="custom"&&il()});function sl(n){if(!n.src_ip)return[];const s=[];if(n.ns_src)j.value="source_object",Q.value=n.ns_src;else if(n.src_ip.length){j.value="source_address";for(const F of n.src_ip)s.push(F.value)}else j.value="source_any";s.length?C.value=s:C.value=[""]}function al(n){if(!n.dest_ip)return[];const s=[];if(n.ns_dst)L.value="destination_object",z.value=n.ns_dst;else if(n.dest_ip.length){L.value="destination_address";for(const F of n.dest_ip)s.push(F.value)}else L.value="destination_any";s.length?R.value=s:R.value=[""]}function Ae(){E("close")}function Pe(){for(const[n,s]of Object.entries(x.value))typeof s=="string"?x.value[n]="":Array.isArray(s)&&(x.value[n]=[])}async function ol(){w.value.listObjectSuggestions=!0;try{const n=await re("ns.firewall","list-object-suggestions");be.value=n.data.objects,t.currentRule&&(sl(t.currentRule),al(t.currentRule))}catch(n){console.error(n),x.value.listObjectSuggestions=l(ue(n)),x.value.listObjectSuggestionsDetails=n.toString()}finally{w.value.listObjectSuggestions=!1}}async function nl(){w.value.listServiceSuggestions=!0;try{const n=await re("ns.firewall","list-service-suggestions");me.value=n.data.services.map(s=>{const F=l("standalone.firewall_rules.service_ports",{protocols:s.proto.join("/").toUpperCase(),ports:s.port},1);return{id:s.id,label:s.id,description:F,protocols:s.proto,port:s.port}}),t.currentRule&&(t.currentRule.ns_service==="custom"?(Z.value="custom",p.value=t.currentRule.dest_port.join(", ")||""):(Z.value=t.currentRule.ns_service||"*",p.value="",v.value=[]))}catch(n){console.error(n),x.value.listServiceSuggestions=l(ue(n)),x.value.listServiceSuggestionsDetails=n.toString()}finally{w.value.listServiceSuggestions=!1}}async function il(){w.value.listProtocols=!0;try{const s=(await re("ns.redirects","list-protocols")).data.protocols.filter(F=>F!=="all");g.value=s.map(F=>({id:F,label:F.toUpperCase()})),t.currentRule&&(t.currentRule.proto.length&&t.currentRule.ns_service==="custom"?v.value=t.currentRule.proto.map(F=>({id:F,label:F.toUpperCase()})):v.value=[])}catch(n){console.error(n),x.value.listProtocols=l(ue(n)),x.value.listProtocolsDetails=n.toString()}finally{w.value.listProtocols=!1}}function rl(){Pe(),m.value.clear(),ae.value=[],C.value.forEach(()=>{ae.value.push("")}),ye.value=[],R.value.forEach(()=>{ye.value.push("")});let n=!0;const s=oe(T.value);if(s.valid||(m.value.set("name",[l(String(s.errMessage))]),n=!1,le(I)),t.ruleType!=="output"){if(j.value==="source_address")for(let[a,ce]of C.value.entries()){const we=oe(ce);if(!we.valid)ae.value[a]=l(we.errMessage),n=!1;else{const ke=Ie([ze,Be,qe],ce,l("standalone.firewall_rules.invalid_source_address_value",{value:ce}));ke.valid||(ae.value[a]=l(ke.errMessage),n=!1)}}else if(j.value==="source_object"){const a=oe(Q.value);a.valid||(m.value.set("ns_src",[l(String(a.errMessage))]),n=!1,le(X))}const N=oe(J.value);N.valid||(m.value.set("src",[l(String(N.errMessage))]),n=!1,le(G))}if(t.ruleType!=="input"){if(L.value==="destination_address")for(let[a,ce]of R.value.entries()){const we=oe(ce);if(!we.valid)ye.value[a]=l(we.errMessage),n=!1;else{const ke=Ie([ze,Be,qe],ce,l("standalone.firewall_rules.invalid_destination_address_value",{value:ce}));ke.valid||(ye.value[a]=l(ke.errMessage),n=!1)}}else if(L.value==="destination_object"){const a=oe(z.value);a.valid||(m.value.set("ns_dst",[a.errMessage]),n=!1,le(K))}const N=oe(P.value);N.valid||(m.value.set("dest",[l(String(N.errMessage))]),n=!1,le(de))}const F=oe(Z.value);if(F.valid||(m.value.set("ns_service",[l(String(F.errMessage))]),n=!1,le(_e)),Z.value==="custom"){let N=_l(v.value);if(N.valid||(m.value.set("proto",[l(String(N.errMessage))]),n=!1,le(A)),Ce.value){let a=oe(p.value);a.valid?(a=ml(p.value),a.valid||(m.value.set("dest_port",[l(String(a.errMessage))]),n=!1,le(u))):(m.value.set("dest_port",[l(String(a.errMessage))]),n=!1,le(u))}}return n}async function ul(){var N;if(!rl())return;x.value.saveRule="",x.value.saveRuleDetails="",w.value.saveRule=!0;const s={name:T.value,enabled:O.value,src_ip:[],ns_src:"",src:"",dest_ip:[],ns_dst:"",dest:"",ns_service:Z.value,proto:[],dest_port:[],target:se.value,add_to_top:V.value==="top",ns_tag:M.value.map(a=>a.id),log:q.value,system_rule:((N=t.currentRule)==null?void 0:N.system_rule)||!1};Re.value&&t.currentRule&&(s.id=t.currentRule.id),t.ruleType!=="output"&&(j.value==="source_address"?s.src_ip=[...new Set(C.value.map(a=>a))]:j.value==="source_object"&&(s.ns_src=Q.value),s.src=J.value),t.ruleType!=="input"&&(L.value==="destination_address"?s.dest_ip=[...new Set(R.value.map(a=>a))]:L.value==="destination_object"&&(s.ns_dst=z.value),s.dest=P.value),Z.value==="custom"&&(s.proto=v.value.map(a=>a.id),Ce.value&&(s.dest_port=p.value.replace(/\s/g,"").split(",")));const F=Re.value?"edit-rule":"add-rule";try{await re("ns.firewall",F,s),E("reloadData"),Ae()}catch(a){console.error(a),a instanceof bl?m.value=a.errorBag:(x.value.saveRule=l(ue(a)),x.value.saveRuleDetails=a.toString())}finally{w.value.saveRule=!1}}return(n,s)=>{const F=Le("font-awesome-icon");return o(),h(e(pl),{isShown:b.isShown,title:ll.value,closeAriaLabel:e(l)("common.shell.close_side_drawer"),onClose:Ae},{default:r(()=>{var N;return[f("form",null,[f("div",Al,[Re.value&&((N=t.currentRule)!=null&&N.system_rule)?(o(),h(e(ee),{key:0,kind:"warning",title:e(l)("standalone.firewall_rules.editing_system_rule_warning_title"),description:e(l)("standalone.firewall_rules.editing_system_rule_warning_description")},null,8,["title","description"])):U("",!0),i(e(Ue),{modelValue:O.value,"onUpdate:modelValue":s[0]||(s[0]=a=>O.value=a),label:O.value?e(l)("common.enabled"):e(l)("common.disabled"),topLabel:e(l)("common.status"),disabled:e(w).saveRule},null,8,["modelValue","label","topLabel","disabled"]),i(e(Oe),{label:e(l)("standalone.firewall_rules.rule_name"),modelValue:T.value,"onUpdate:modelValue":s[1]||(s[1]=a=>T.value=a),modelModifiers:{trim:!0},invalidMessage:m.value.getFirstFor("name"),disabled:e(w).saveRule,ref_key:"nameRef",ref:I},null,8,["label","modelValue","invalidMessage","disabled"]),e(x).listObjectSuggestions?(o(),h(e(ee),{key:1,kind:"error",title:e(l)("error.cannot_retrieve_host_suggestions"),description:e(x).listObjectSuggestions},te({_:2},[e(x).listObjectSuggestionsDetails?{name:"details",fn:r(()=>[k(c(e(x).listObjectSuggestionsDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),b.ruleType==="output"?(o(),h(e(Oe),{key:2,label:e(l)("standalone.firewall_rules.source"),value:e(l)("standalone.firewall_rules.firewall"),disabled:""},null,8,["label","value"])):(o(),S(Y,{key:3},[i(e(je),{modelValue:j.value,"onUpdate:modelValue":s[2]||(s[2]=a=>j.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.source_type"),options:Xe.value},null,8,["modelValue","disabled","label","options"]),Se(i(Ne,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=a=>C.value=a),"disable-inputs":e(w).saveRule,title:e(l)("standalone.firewall_rules.source_addresses"),"add-item-label":e(l)("standalone.firewall_rules.add_source_address"),"invalid-messages":ae.value,"general-invalid-message":e(l)(m.value.getFirstFor("src_ip")),required:"",optionalLabel:e(l)("common.optional")},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.source_addresses_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disable-inputs","title","add-item-label","invalid-messages","general-invalid-message","optionalLabel"]),[[De,j.value==="source_address"]]),Se(i(e(pe),{modelValue:Q.value,"onUpdate:modelValue":s[4]||(s[4]=a=>Q.value=a),disabled:e(w).saveRule||e(w).listObjectSuggestions,label:e(l)("standalone.firewall_rules.source_object"),options:Fe.value,placeholder:e(w).listObjectSuggestions?e(l)("common.loading"):e(l)("ne_combobox.choose"),invalidMessage:m.value.getFirstFor("ns_src"),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),ref_key:"sourceAddressObjectRef",ref:X},null,8,["modelValue","disabled","label","options","placeholder","invalidMessage","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"]),[[De,j.value==="source_object"]]),i(e(pe),{modelValue:J.value,"onUpdate:modelValue":s[5]||(s[5]=a=>J.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.source_zone"),options:Ee.value,invalidMessage:m.value.getFirstFor("src"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional"),ref_key:"sourceZoneRef",ref:G},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.source_zone_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","label","options","invalidMessage","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"])],64)),b.ruleType==="input"?(o(),h(e(Oe),{key:4,label:e(l)("standalone.firewall_rules.destination"),value:e(l)("standalone.firewall_rules.firewall"),disabled:""},null,8,["label","value"])):(o(),S(Y,{key:5},[i(e(je),{modelValue:L.value,"onUpdate:modelValue":s[6]||(s[6]=a=>L.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.destination_type"),options:el.value},null,8,["modelValue","disabled","label","options"]),Se(i(Ne,{modelValue:R.value,"onUpdate:modelValue":s[7]||(s[7]=a=>R.value=a),"disable-inputs":e(w).saveRule,title:e(l)("standalone.firewall_rules.destination_addresses"),"add-item-label":e(l)("standalone.firewall_rules.add_destination_address"),"invalid-messages":ye.value,"general-invalid-message":e(l)(m.value.getFirstFor("dest_ip")),required:"",optionalLabel:e(l)("common.optional")},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.destination_addresses_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disable-inputs","title","add-item-label","invalid-messages","general-invalid-message","optionalLabel"]),[[De,L.value==="destination_address"]]),Se(i(e(pe),{modelValue:z.value,"onUpdate:modelValue":s[8]||(s[8]=a=>z.value=a),disabled:e(w).saveRule||e(w).listObjectSuggestions,label:e(l)("standalone.firewall_rules.destination_object"),options:Fe.value,placeholder:e(w).listObjectSuggestions?e(l)("common.loading"):e(l)("ne_combobox.choose"),invalidMessage:e(l)(m.value.getFirstI18nKeyFor("ns_dst")),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),ref_key:"destinationAddressObjectRef",ref:K},null,8,["modelValue","disabled","label","options","placeholder","invalidMessage","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"]),[[De,L.value==="destination_object"]]),i(e(pe),{modelValue:P.value,"onUpdate:modelValue":s[9]||(s[9]=a=>P.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.destination_zone"),options:Ee.value,invalidMessage:m.value.getFirstFor("dest"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional"),ref_key:"destinationZoneRef",ref:de},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.destination_zone_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","label","options","invalidMessage","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"])],64)),e(x).listServiceSuggestions?(o(),h(e(ee),{key:6,kind:"error",title:e(l)("error.cannot_retrieve_service_suggestions"),description:e(x).listServiceSuggestions},te({_:2},[e(x).listServiceSuggestionsDetails?{name:"details",fn:r(()=>[k(c(e(x).listServiceSuggestionsDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),i(e(pe),{modelValue:Z.value,"onUpdate:modelValue":s[10]||(s[10]=a=>Z.value=a),disabled:e(w).saveRule||e(w).listServiceSuggestions,label:e(l)("standalone.firewall_rules.destination_service"),options:tl.value,invalidMessage:m.value.getFirstFor("ns_service"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional"),ref_key:"serviceRef",ref:_e},null,8,["modelValue","disabled","label","options","invalidMessage","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),Z.value==="custom"?(o(),S(Y,{key:7},[e(x).listProtocols?(o(),h(e(ee),{key:0,kind:"error",title:e(l)("error.cannot_retrieve_protocols"),description:e(x).listProtocols},te({_:2},[e(x).listProtocolsDetails?{name:"details",fn:r(()=>[k(c(e(x).listProtocolsDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),i(e(pe),{modelValue:v.value,"onUpdate:modelValue":s[11]||(s[11]=a=>v.value=a),disabled:e(w).saveRule||e(w).listProtocols,label:e(l)("standalone.firewall_rules.protocols"),placeholder:e(w).listProtocols?e(l)("common.loading"):e(l)("ne_combobox.choose"),options:g.value,invalidMessage:m.value.getFirstFor("proto"),multiple:"",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional"),ref_key:"protocolsRef",ref:A},null,8,["modelValue","disabled","label","placeholder","options","invalidMessage","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),Ce.value?(o(),h(e(Oe),{key:1,label:e(l)("standalone.firewall_rules.ports"),placeholder:e(l)("standalone.firewall_rules.ports_placeholder"),modelValue:p.value,"onUpdate:modelValue":s[12]||(s[12]=a=>p.value=a),modelModifiers:{trim:!0},disabled:e(w).saveRule,invalidMessage:m.value.getFirstFor("dest_port"),ref_key:"portsRef",ref:u},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.ports_tooltip")),1)]),_:1})]),_:1},8,["label","placeholder","modelValue","disabled","invalidMessage"])):U("",!0)],64)):U("",!0),i(e(je),{modelValue:se.value,"onUpdate:modelValue":s[13]||(s[13]=a=>se.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.action"),options:Ge.value},null,8,["modelValue","disabled","label","options"]),Te.value||b.isDuplicatingRule?(o(),h(e(je),{key:8,modelValue:V.value,"onUpdate:modelValue":s[14]||(s[14]=a=>V.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.rule_position"),options:Qe.value},null,8,["modelValue","disabled","label","options"])):U("",!0),i(e(ie),{kind:"tertiary",size:"sm",onClick:s[15]||(s[15]=a=>$.value=!$.value),class:"-ml-2"},{suffix:r(()=>[i(F,{icon:["fas",$.value?"chevron-up":"chevron-down"],class:"h-3 w-3","aria-hidden":"true"},null,8,["icon"])]),default:r(()=>[k(" "+c(e(l)("common.advanced_settings")),1)]),_:1}),i(cl,{name:"slide-down"},{default:r(()=>[Se(f("div",$l,[i(e(pe),{modelValue:M.value,"onUpdate:modelValue":s[16]||(s[16]=a=>M.value=a),disabled:e(w).saveRule,label:e(l)("standalone.firewall_rules.tags"),options:b.knownTags,placeholder:e(l)("ne_combobox.choose_or_enter_multiple"),multiple:"",acceptUserInput:"",optional:"",optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label")},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.tags_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","label","options","placeholder","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"]),i(e(Ue),{modelValue:q.value,"onUpdate:modelValue":s[17]||(s[17]=a=>q.value=a),label:q.value?e(l)("common.enabled"):e(l)("common.disabled"),topLabel:e(l)("standalone.firewall_rules.logging"),disabled:e(w).saveRule},{tooltip:r(()=>[i(e(W),{placement:"top-start"},{content:r(()=>[k(c(e(l)("standalone.firewall_rules.logging_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","topLabel","disabled"])],512),[[De,$.value]])]),_:1}),e(x).saveRule?(o(),h(e(ee),{key:9,kind:"error",title:e(l)("error.cannot_save_firewall_rule"),description:e(x).saveRule},te({_:2},[e(x).saveRuleDetails?{name:"details",fn:r(()=>[k(c(e(x).saveRuleDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0)]),s[18]||(s[18]=f("hr",{class:"my-8 border-gray-200 dark:border-gray-700"},null,-1)),f("div",Ml,[i(e(ie),{kind:"tertiary",size:"lg",onClick:fe(Ae,["prevent"]),disabled:e(w).saveRule,class:"mr-3"},{default:r(()=>[k(c(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),i(e(ie),{kind:"primary",size:"lg",onClick:fe(ul,["prevent"]),disabled:e(w).saveRule,loading:e(w).saveRule},{default:r(()=>[k(c(Te.value?e(l)("standalone.firewall_rules.add_rule"):e(l)("standalone.firewall_rules.save_rule")),1)]),_:1},8,["disabled","loading"])])])]}),_:1},8,["isShown","title","closeAriaLabel"])}}}),Fl=ve({__name:"DeleteFirewallRuleModal",props:{visible:{type:Boolean},rule:{type:Object}},emits:["close","reloadData"],setup(b,{emit:_}){const t=b,E=_,{t:l}=ge();let D=d({deleteRule:!1}),y=d({deleteRule:"",deleteRuleDetails:""});he(()=>t.visible,()=>{t.visible&&(y.value.deleteRule="",y.value.deleteRuleDetails="")});async function O(){if(t.rule){y.value.deleteRule="",y.value.deleteRuleDetails="",D.value.deleteRule=!0;try{await re("ns.firewall","delete-rule",{id:t.rule.id}),E("close"),E("reloadData")}catch(T){console.error(T),y.value.deleteRule=l(ue(T)),y.value.deleteRuleDetails=T.toString()}finally{D.value.deleteRule=!1}}}return(T,I)=>(o(),h(e(fl),{visible:b.visible,title:e(l)("standalone.firewall_rules.delete_rule"),kind:"warning",primaryLabel:e(l)("standalone.firewall_rules.delete_rule"),cancelLabel:e(l)("common.cancel"),primaryButtonKind:"danger",primaryButtonDisabled:e(D).deleteRule,primaryButtonLoading:e(D).deleteRule,closeAriaLabel:e(l)("common.close"),onClose:I[0]||(I[0]=j=>E("close")),onPrimaryClick:O},{default:r(()=>{var j;return[k(c(e(l)("standalone.firewall_rules.confirm_delete_rule",{name:(j=b.rule)==null?void 0:j.name}))+" ",1),e(y).deleteRule?(o(),h(e(ee),{key:0,kind:"error",title:e(l)("error.cannot_delete_rule"),description:e(y).deleteRule,class:"mt-4"},te({_:2},[e(y).deleteRuleDetails?{name:"details",fn:r(()=>[k(c(e(y).deleteRuleDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0)]}),_:1},8,["visible","title","primaryLabel","cancelLabel","primaryButtonDisabled","primaryButtonLoading","closeAriaLabel"]))}}),Pl={key:0},Ul={key:0,class:"space-y-1"},Il={class:"inline-flex items-center gap-1.5"},zl={key:1},Bl=ve({__name:"DomainSetTooltip",props:{domainSetId:{type:String,required:!0},allDomainSets:{type:Array}},setup(b){const _=b;gl.add(yl);function t(E){var l;return(l=_.allDomainSets)==null?void 0:l.find(D=>D.id===E)}return(E,l)=>{const D=Le("font-awesome-icon");return o(),h(e(W),{placement:"top",class:"shrink-0"},{trigger:r(()=>[i(e(Ke),{class:"flex items-center gap-1.5"},{default:r(()=>{var y;return[i(D,{icon:["fas","cloud"],class:"h-4 w-4","aria-hidden":"true"}),k(" "+c(((y=t(b.domainSetId))==null?void 0:y.name)||"-"),1)]}),_:1})]),content:r(()=>{var y,O;return[(y=t(b.domainSetId))!=null&&y.domain?(o(),S("div",Pl,[(o(!0),S(Y,null,Ve([(O=t(b.domainSetId))==null?void 0:O.domain],(T,I)=>(o(),S("div",{key:I},[T?(o(),S("ul",Ul,[(o(!0),S(Y,null,Ve(T,j=>(o(),S("li",{key:j,class:B({"list-inside list-disc":T.length>1})},[f("span",Il,[f("span",null,c(j),1)])],2))),128))])):U("",!0)]))),128))])):(o(),S("div",zl,"-"))]}),_:1})}}}),ql={class:"flex items-center gap-4"},Zl={class:"text-primary-700 dark:text-primary-500"},Hl={class:"ml-2 text-primary-700 dark:text-primary-500"},Nl={class:"list-inside list-disc"},Je=ve({__name:"SourceOrDestinationRuleColumn",props:{rule:{type:Object,required:!0},columnType:{type:String,required:!0},rulesType:{type:String,required:!0},enabled:{type:Boolean,default:!0},loadingObjects:{type:Boolean,default:!1},hostSets:{type:Array,required:!0},domainSets:{type:Array,required:!0}},setup(b){const _=b,{t}=ge(),E=H(()=>_.columnType==="source"?_.hostSets.find(O=>O.id===_.rule.ns_src):_.hostSets.find(O=>O.id===_.rule.ns_dst)),l=H(()=>_.columnType==="source"?_.domainSets.find(O=>`objects/${O.id}`===_.rule.ns_src):_.domainSets.find(O=>`objects/${O.id}`===_.rule.ns_dst)),D=H(()=>_.columnType==="source"?_.rule.src_ip:_.rule.dest_ip),y=H(()=>_.columnType==="source"?_.rule.src:_.rule.dest);return(O,T)=>(o(),S("div",ql,[b.rulesType==="input"&&_.columnType==="destination"?(o(),h(e(xe),{key:0,class:B({"opacity-50":!b.enabled}),text:e(t)("standalone.firewall_rules.firewall"),kind:b.enabled?"tertiary":"secondary"},null,8,["class","text","kind"])):b.rulesType==="output"&&_.columnType==="source"?(o(),h(e(xe),{key:1,class:B({"opacity-50":!b.enabled}),text:e(t)("standalone.firewall_rules.firewall"),kind:b.enabled?"tertiary":"secondary"},null,8,["class","text","kind"])):E.value?(o(),S(Y,{key:2},[b.loadingObjects?(o(),h(e($e),{key:0})):U("",!0),i(Ll,{hostSetId:E.value.id,allHostSets:b.hostSets},null,8,["hostSetId","allHostSets"])],64)):l.value?(o(),S(Y,{key:3},[b.loadingObjects?(o(),h(e($e),{key:0})):U("",!0),i(Bl,{domainSetId:l.value.id,allDomainSets:b.domainSets},null,8,["domainSetId","allDomainSets"])],64)):D.value.length?(o(!0),S(Y,{key:4},Ve(D.value.slice(0,2),(I,j)=>(o(),S("p",{key:I.value},[I.label?(o(),h(e(W),{key:0},{trigger:r(()=>[f("span",Zl,c(I.label),1)]),content:r(()=>[k(c(I.value),1)]),_:2},1024)):(o(),S("span",{key:1,class:B({"opacity-50":!b.enabled})},c(I.value),3)),j==1&&D.value.length>2?(o(),h(e(W),{key:2},{trigger:r(()=>[f("span",Hl,c(e(t)("common.plus_num_others",{num:D.value.length-2},D.value.length-2)),1)]),content:r(()=>[f("ul",Nl,[(o(!0),S(Y,null,Ve(D.value.slice(2),(L,C)=>(o(),S("li",{key:C},[L.label?(o(),S(Y,{key:0},[k(c(`${L.label} (${L.value})`),1)],64)):(o(),S(Y,{key:1},[k(c(L.value),1)],64))]))),128))])]),_:2},1024)):U("",!0)]))),128)):y.value=="*"?(o(),S("div",{key:5,class:B({"opacity-50":!b.enabled})},c(e(t)("common.any")),3)):U("",!0),y.value&&y.value!="*"?(o(),h(e(xe),{key:6,text:y.value.toUpperCase(),kind:b.enabled?"custom":"secondary",customColorClasses:e(hl)(y.value)},null,8,["text","kind","customColorClasses"])):U("",!0)]))}}),Jl={key:0},Kl=["colspan"],Wl=["onDragenter","onDrop"],Yl=["colspan"],Gl={key:1,class:"drop-target"},Ql=["colspan"],Xl=["draggable","onDragstart"],et={class:"flex items-center justify-between gap-2 border-r border-gray-200 pr-4 dark:border-gray-600"},lt={key:0},tt={key:1},st={class:"flex justify-end gap-2"},at=["colspan"],ne="!bg-[#fcfdfd] dark:!bg-[#18212f]",ot=ve({__name:"FirewallRulesTable",props:{rules:{type:Array,required:!0},rulesType:{type:String,required:!0},textFilter:{type:String,required:!0},loadingRules:{type:Boolean,required:!0}},emits:["reloadRules","editRule","duplicateRule","deleteRule","orderRules","toggleRule"],setup(b,{emit:_}){const t=b,E=_,{t:l}=ge(),{hostSets:D,listHostSets:y,loadingListHostSets:O,errorListHostSets:T,errorListHostSetsDetails:I}=Vl(),{domainSets:j,listDomainSets:L,loadingListDomainSets:C,errorListDomainSets:R,errorListDomainSetsDetails:Q}=jl(),z=d([]),X=[{key:"vertical-grip"},{label:l("standalone.firewall_rules.name"),key:"name"},{label:l("standalone.firewall_rules.source"),key:"source"},{label:l("standalone.firewall_rules.destination"),key:"destination"},{label:l("standalone.firewall_rules.service"),key:"service"},{label:l("standalone.firewall_rules.action"),key:"action"}],K=d(),J=d(),G=H(()=>t.textFilter?z.value.filter(v=>se(v,t.textFilter)):z.value);function P(v){return!!v.enabled&&!!v.active_zone}he(()=>t.rules,()=>{z.value=t.rules}),We(()=>{y(),L()});function de(v){J.value=void 0,K.value!=null&&K.value!=v&&(K.value-v<0?z.value.splice(v-1,0,...z.value.splice(K.value,1)):z.value.splice(v,0,...z.value.splice(K.value,1)),E("orderRules",z.value))}function be(v){switch(v.ns_service){case"*":return l("common.any");case"custom":return l("standalone.firewall_rules.service_ports",{protocols:v.proto.join("/").toUpperCase(),ports:v.dest_port.join(", ")},v.dest_port.length);default:return v.ns_service}}function Z(v){return[{id:"enableOrDisable",label:v.enabled?l("common.disable"):l("common.enable"),iconStyle:"fas",icon:v.enabled?"circle-xmark":"circle-check",action:()=>E("toggleRule",v)},{id:"duplicate",label:l("standalone.firewall_rules.duplicate"),icon:"copy",iconStyle:"fas",action:()=>E("duplicateRule",v)},{id:"delete",label:l("common.delete"),icon:"trash",iconStyle:"fas",action:()=>E("deleteRule",v),danger:!0}]}function _e(v){switch(v){case"ACCEPT":return"arrow-right";case"DROP":case"REJECT":return"ban";default:return"circle-question"}}function me(v){if(!P(v))return"text-gray-500 dark:text-gray-400";switch(v.target){case"ACCEPT":return"text-green-700 dark:text-green-500";case"DROP":case"REJECT":return"text-rose-700 dark:text-rose-500";default:return""}}function se(v,A){var u,V;const g=/[^a-zA-Z0-9]/g;A=A.replace(g,"");let p=!1;return p=["name","src","dest","ns_service","target"].some($=>{const M=v[$];return new RegExp(A,"i").test(M==null?void 0:M.replace(g,""))}),!!(p||(p=!!((u=v.src_ip)!=null&&u.some($=>Object.values($).some(M=>new RegExp(A,"i").test(M==null?void 0:M.replace(g,""))))),p)||(p=!!((V=v.dest_ip)!=null&&V.some($=>Object.values($).some(M=>new RegExp(A,"i").test(M==null?void 0:M.replace(g,""))))),p)||(p=["proto","dest_port","ns_tag"].some($=>{const M=v[$];return M==null?void 0:M.some(q=>new RegExp(A,"i").test(q==null?void 0:q.replace(g,"")))}),p))}return(v,A)=>{const g=Le("FontAwesomeIcon"),p=Le("font-awesome-icon");return o(),S("div",null,[e(T)?(o(),h(e(ee),{key:0,kind:"error",title:e(l)("error.cannot_retrieve_host_sets"),description:e(T),class:"mb-5"},te({_:2},[e(I)?{name:"details",fn:r(()=>[k(c(e(I)),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),e(R)?(o(),h(e(ee),{key:1,kind:"error",title:e(l)("error.cannot_retrieve_domain_sets"),description:e(R),class:"mb-5"},te({_:2},[e(Q)?{name:"details",fn:r(()=>[k(c(e(Q)),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),b.loadingRules||!e(Me)(G.value)?(o(),h(xl,{key:2,data:G.value,headers:X,style:"card",class:"!border-spacing-y-1"},{tbody:r(()=>[f("tbody",null,[b.loadingRules?(o(),S("tr",Jl,[f("td",{colspan:X.length},[i(e($e),{lines:8,size:"lg"})],8,Kl)])):(o(!0),S(Y,{key:1},Ve(G.value,(u,V)=>(o(),S(Y,{key:u.id},[b.textFilter?(o(),S("tr",Gl,[f("td",{colspan:X.length+1},null,8,Ql)])):(o(),S("tr",{key:0,class:B([[J.value==V?"drop-over drop-target":"",K.value!=null?"drop-active":""],"drop-target"]),onDragenter:$=>J.value=V,onDragleave:A[0]||(A[0]=$=>J.value=void 0),onDrop:fe($=>de(V),["prevent"]),onDragover:A[1]||(A[1]=fe(()=>{},["prevent"]))},[f("td",{colspan:X.length+1},null,8,Yl)],42,Wl)),f("tr",{class:B({"opacity-30":K.value==V}),draggable:!b.textFilter,onDragend:A[2]||(A[2]=$=>K.value=void 0),onDragstart:$=>K.value=V},[b.textFilter?(o(),S("td",{key:1,class:B(P(u)?"":ne)},[i(e(W),{triggerEvent:"mouseenter focus",placement:"top-start"},{trigger:r(()=>[i(g,{icon:e(Ze),class:"cursor-not-allowed opacity-50"},null,8,["icon"])]),content:r(()=>[k(c(e(l)("standalone.firewall_rules.clear_filter_to_sort_rules")),1)]),_:1})],2)):(o(),S("td",{key:0,class:B(["cursor-move text-center hover:bg-opacity-50 hover:dark:bg-opacity-70",P(u)?"":ne])},[i(g,{icon:e(Ze)},null,8,["icon"])],2)),f("td",{class:B(P(u)?"":ne)},[f("div",et,[f("div",null,[f("div",{class:B({"opacity-50":!P(u)})},c(u.name),3),u.active_zone?u.enabled?U("",!0):(o(),S("div",tt,[i(e(W),{triggerEvent:"mouseenter focus",placement:"top-start"},{trigger:r(()=>[i(e(xe),{kind:"secondary",size:"xs",class:"mt-2",icon:["fas","circle-xmark"],text:e(l)("common.disabled")},null,8,["text"])]),content:r(()=>[k(c(e(l)("standalone.firewall_rules.disabled_rule")),1)]),_:1})])):(o(),S("div",lt,[i(e(W),{triggerEvent:"mouseenter focus",placement:"top-start"},{trigger:r(()=>[i(e(xe),{kind:"warning",size:"xs",class:"mt-2",icon:["fas","triangle-exclamation"],text:e(l)("standalone.firewall_rules.inactive")},null,8,["text"])]),content:r(()=>[k(c(e(l)("standalone.firewall_rules.zone_no_longer_exists")),1)]),_:1})]))]),i(e(W),null,{trigger:r(()=>[i(e(Ke),null,{default:r(()=>[i(g,{icon:["fas","magnifying-glass-plus"]})]),_:1})]),content:r(()=>{var $;return[f("div",null,[f("span",null,c(e(l)("standalone.firewall_rules.tags"))+": ",1),f("span",null,c((($=u.ns_tag)==null?void 0:$.join(", "))||"-"),1)]),f("div",null,[f("span",null,c(e(l)("standalone.firewall_rules.logging"))+": ",1),f("span",null,c(u.log?e(l)("common.enabled"):e(l)("common.disabled")),1)])]}),_:2},1024)])],2),f("td",{class:B(P(u)?"":ne)},[i(Je,{rule:u,columnType:"source",rulesType:b.rulesType,enabled:P(u),hostSets:e(D),domainSets:e(j),loadingObjects:e(O)||e(C)},null,8,["rule","rulesType","enabled","hostSets","domainSets","loadingObjects"])],2),f("td",{class:B(P(u)?"":ne)},[i(Je,{rule:u,columnType:"destination",rulesType:b.rulesType,enabled:P(u),hostSets:e(D),domainSets:e(j),loadingObjects:e(O)||e(C)},null,8,["rule","rulesType","enabled","hostSets","domainSets","loadingObjects"])],2),f("td",{class:B(P(u)?"":ne)},[f("span",{class:B({"opacity-50":!P(u)})},c(be(u)),3)],2),f("td",{class:B(P(u)?"":ne)},[f("span",{class:B(["flex items-center gap-x-2",{"opacity-50":!P(u)}])},[i(p,{icon:["fas",_e(u.target)],class:B(me(u))},null,8,["icon","class"]),k(" "+c(u.target),1)],2)],2),f("td",{class:B(P(u)?"":ne)},[f("div",st,[i(e(ie),{kind:"tertiary",onClick:$=>E("editRule",u)},{prefix:r(()=>[i(p,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:r(()=>[k(" "+c(e(l)("common.edit")),1)]),_:2},1032,["onClick"]),i(e(Rl),{items:Z(u),alignToRight:!0},null,8,["items"])])],2)],42,Xl)],64))),128)),f("tr",{class:B([[J.value==z.value.length?"drop-over":"",K.value!=null?"drop-active":""],"drop-target"]),onDragenter:A[3]||(A[3]=u=>J.value=z.value.length),onDragleave:A[4]||(A[4]=u=>J.value=void 0),onDrop:A[5]||(A[5]=fe(u=>de(z.value.length),["prevent"])),onDragover:A[6]||(A[6]=fe(()=>{},["prevent"]))},[f("td",{colspan:X.length},null,8,at)],34)])]),_:1},8,["data"])):U("",!0)])}}}),nt=Tl(ot,[["__scopeId","data-v-d99f7218"]]),it={class:"text-sm"},rt={class:"mb-8 flex items-start justify-between"},ut={class:"max-w-2xl text-gray-500 dark:text-gray-400"},dt={class:"mb-5 flex items-center gap-4"},ct=ve({__name:"FirewallRulesContent",props:{rulesType:{type:String,required:!0}},setup(b){const _=b,{t}=ge(),E=Ye(),l=wl(),D=d([]),y=d(void 0),O=d(!1),T=d(!1),I=d(!1),j=d([]),L=d(""),C=d({listRules:!1,orderRules:!1,enableOrDisableRule:!1}),R=d({listRules:"",listRulesDetails:"",orderRules:"",orderRulesDetails:"",enableOrDisableRule:"",enableOrDisableRuleDetails:""}),Q=H(()=>{switch(_.rulesType){case"forward":return"list-forward-rules";case"input":return"list-input-rules";default:return"list-output-rules"}}),z=H(()=>{switch(_.rulesType){case"forward":return t("standalone.firewall_rules.forward_rules_description");case"input":return t("standalone.firewall_rules.input_rules_description");default:return t("standalone.firewall_rules.output_rules_description")}}),X=H(()=>{switch(_.rulesType){case"forward":return t("standalone.firewall_rules.add_forward_rule");case"input":return t("standalone.firewall_rules.add_input_rule");default:return t("standalone.firewall_rules.add_output_rule")}}),K=H(()=>{switch(_.rulesType){case"forward":return t("standalone.firewall_rules.no_forward_rule");case"input":return t("standalone.firewall_rules.no_input_rule");default:return t("standalone.firewall_rules.no_output_rule")}}),J=H(()=>L.value?D.value.filter(g=>A(g,L.value)):D.value);he(()=>_.rulesType,()=>{G()}),We(()=>{G()});async function G(){P(),E.fetch(),l.getChanges()}async function P(){C.value.listRules=!0,D.value=[],R.value.listRules="",R.value.listRulesDetails="";try{const g=await re("ns.firewall",Q.value);D.value=g.data.rules;const p=Cl(D.value.map(u=>u.ns_tag).flat());j.value=p.map(u=>({id:u,label:u}))}catch(g){console.error(g),R.value.listRules=t(ue(g)),R.value.listRulesDetails=g.toString()}finally{C.value.listRules=!1}}async function de(g){C.value.orderRules=!0,R.value.orderRules="",R.value.orderRulesDetails="";try{await re("ns.firewall","order-rules",{order:g.map(p=>p.id),type:_.rulesType}),l.getChanges()}catch(p){console.error(p),R.value.orderRules=t(ue(p)),R.value.orderRulesDetails=p.toString()}finally{C.value.orderRules=!1}}async function be(g){C.value.enableOrDisableRule=!0,R.value.enableOrDisableRule="",R.value.enableOrDisableRuleDetails="";const p=g.enabled?"disable-rule":"enable-rule";try{await re("ns.firewall",p,{id:g.id}),G()}catch(u){console.error(u),R.value.enableOrDisableRule=t(ue(u)),R.value.enableOrDisableRuleDetails=u.toString()}finally{C.value.enableOrDisableRule=!1}}function Z(){y.value=void 0,O.value=!1,T.value=!0}function _e(g){y.value=g,O.value=!1,T.value=!0}function me(g){y.value=g,O.value=!0,T.value=!0}function se(g){y.value=g,I.value=!0}function v(){T.value=!1}function A(g,p){var $,M;const u=/[^a-zA-Z0-9]/g;p=p.replace(u,"");let V=!1;return V=["name","src","dest","ns_service","target"].some(q=>{const m=g[q];return new RegExp(p,"i").test(m==null?void 0:m.replace(u,""))}),!!(V||(V=!!(($=g.src_ip)!=null&&$.some(q=>Object.values(q).some(m=>new RegExp(p,"i").test(m==null?void 0:m.replace(u,""))))),V)||(V=!!((M=g.dest_ip)!=null&&M.some(q=>Object.values(q).some(m=>new RegExp(p,"i").test(m==null?void 0:m.replace(u,""))))),V)||(V=["proto","dest_port","ns_tag"].some(q=>{const m=g[q];return m==null?void 0:m.some(ae=>new RegExp(p,"i").test(ae==null?void 0:ae.replace(u,"")))}),V))}return(g,p)=>{const u=Le("FontAwesomeIcon");return o(),S("div",it,[f("div",rt,[f("div",ut,c(z.value),1),C.value.listRules||D.value.length?(o(),h(e(ie),{key:0,kind:"secondary",size:"lg",onClick:Z,class:"ml-6 shrink-0"},{prefix:r(()=>[i(u,{icon:["fas","circle-plus"],"aria-hidden":"true"})]),default:r(()=>[k(" "+c(X.value),1)]),_:1})):U("",!0)]),R.value.listRules?(o(),h(e(ee),{key:0,kind:"error",title:e(t)("error.cannot_retrieve_firewall_rules"),description:R.value.listRules,class:"mb-5"},te({_:2},[R.value.listRulesDetails?{name:"details",fn:r(()=>[k(c(R.value.listRulesDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),R.value.enableOrDisableRule?(o(),h(e(ee),{key:1,kind:"error",title:e(t)("error.cannot_enable_or_disable_firewall_rule"),description:R.value.enableOrDisableRule,class:"mb-5"},te({_:2},[R.value.enableOrDisableRuleDetails?{name:"details",fn:r(()=>[k(c(R.value.enableOrDisableRuleDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):U("",!0),R.value.orderRules?(o(),h(e(ee),{key:2,kind:"error",title:e(t)("error.cannot_reorder_firewall_rules"),description:R.value.orderRules,class:"mb-5"},te({_:2},[R.value.orderRulesDetails?{name:"details",fn:r(()=>[k(c(R.value.orderRulesDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):(o(),S(Y,{key:3},[f("div",dt,[i(e(Oe),{placeholder:e(t)("standalone.firewall_rules.filter_rules"),modelValue:L.value,"onUpdate:modelValue":p[0]||(p[0]=V=>L.value=V),modelModifiers:{trim:!0},disabled:C.value.listRules,class:"max-w-xs"},null,8,["placeholder","modelValue","disabled"]),i(e(ie),{kind:"tertiary",onClick:p[1]||(p[1]=V=>L.value=""),disabled:C.value.listRules||!L.value},{default:r(()=>[k(c(e(t)("standalone.firewall_rules.clear_filter")),1)]),_:1},8,["disabled"])]),!C.value.listRules&&e(Me)(D.value)?(o(),h(e(He),{key:0,title:K.value,icon:["fas","block-brick-fire"],class:"mt-4"},{default:r(()=>[i(e(ie),{kind:"primary",size:"lg",onClick:Z},{prefix:r(()=>[i(u,{icon:["fas","circle-plus"],"aria-hidden":"true"})]),default:r(()=>[k(" "+c(X.value),1)]),_:1})]),_:1},8,["title"])):!C.value.listRules&&e(Me)(J.value)?(o(),h(e(He),{key:1,title:e(t)("standalone.firewall_rules.no_rule_found"),description:e(t)("standalone.firewall_rules.try_changing_search_filter"),icon:["fas","circle-info"],class:"mt-4"},{default:r(()=>[i(e(ie),{kind:"tertiary",onClick:p[2]||(p[2]=V=>L.value="")},{default:r(()=>[k(c(e(t)("standalone.firewall_rules.clear_filter")),1)]),_:1})]),_:1},8,["title","description"])):U("",!0),i(nt,{rulesType:b.rulesType,rules:D.value,textFilter:L.value,loadingRules:C.value.listRules,onReloadRules:G,onEditRule:_e,onDuplicateRule:me,onDeleteRule:se,onOrderRules:de,onToggleRule:be},null,8,["rulesType","rules","textFilter","loadingRules"])],64)),i(El,{ruleType:b.rulesType,currentRule:y.value,isDuplicatingRule:O.value,isShown:T.value,knownTags:j.value,onClose:v,onReloadData:G},null,8,["ruleType","currentRule","isDuplicatingRule","isShown","knownTags"]),i(Fl,{visible:I.value,rule:y.value,onClose:p[3]||(p[3]=V=>I.value=!1),onReloadData:G},null,8,["visible","rule"])])}}}),pt={class:"text-sm"},Ot=ve({__name:"FirewallRulesView",setup(b){const{t:_}=ge(),{tabs:t,selectedTab:E}=Dl([{name:"forwardRules",label:_("standalone.firewall_rules.forward_rules")},{name:"inputRules",label:_("standalone.firewall_rules.input_rules")},{name:"outputRules",label:_("standalone.firewall_rules.output_rules")}]),l=H(()=>{switch(E.value){case"forwardRules":return"forward";case"inputRules":return"input";default:return"output"}});return(D,y)=>(o(),S("div",pt,[i(e(kl),{tag:"h3",class:"mb-7"},{default:r(()=>[k(c(e(_)("standalone.firewall_rules.title")),1)]),_:1}),i(e(Sl),{tabs:e(t),selected:e(E),srTabsLabel:e(_)("ne_tabs.tabs"),srSelectTabLabel:e(_)("ne_tabs.select_a_tab"),onSelectTab:y[0]||(y[0]=O=>E.value=O),class:"mb-8"},null,8,["tabs","selected","srTabsLabel","srSelectTabLabel"]),i(ct,{rulesType:l.value},null,8,["rulesType"])]))}});export{Ot as default};
