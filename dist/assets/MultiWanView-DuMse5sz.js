var Ie=Object.defineProperty;var Ke=(F,a,l)=>a in F?Ie(F,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):F[a]=l;var ge=(F,a,l)=>Ke(F,typeof a!="symbol"?a+"":a,l);import{d as X,u as Y,U as ke,r as g,aa as te,o as be,h as i,i as $,l as e,y as _e,q as U,L as oe,n as P,k as n,w as _,j as y,a1 as xe,m as M,t as V,z as q,ad as ee,Q as G,_ as B,F as N,a0 as W,e as H,V as ie,a8 as Be,x as Te,J as de,c as re,b2 as $e,b3 as ce,ar as ue,ae as Oe,ai as fe,S as ae,Y as Ce,b4 as ve,av as ye,R as pe,b5 as Ae,ap as Fe,aM as ze,b6 as Le,b7 as he,Z as K,s as se,a5 as je,ag as Se,b as Ne,B as Ge,b8 as We,b9 as qe,C as He,ba as Ye,bb as Je,W as Qe,a9 as Xe}from"./index-BlEQ5104.js";import{_ as we}from"./FormLayout.vue_vue_type_script_setup_true_lang-DaMAl8E3.js";import{_ as Ue}from"./NeTable.vue_vue_type_script_setup_true_lang-BDPau7Vg.js";/* empty css                                                */import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Re}from"./firewall-C9mbeSo1.js";import{_ as Ve}from"./ObjectTooltip.vue_vue_type_script_setup_true_lang-DvwD7JWX.js";import{u as Ze}from"./useObjects-D-lIOcFM.js";import{u as el}from"./useTabs-BeLQ169O.js";import"./objects-B0tOUNaX.js";const ll={key:1,class:"max-w-3xl space-y-8"},al={class:"space-y-4"},tl={class:"grow"},ol={class:"text-xs font-normal"},nl={key:0,class:"text-sm text-rose-700 dark:text-rose-400"},sl={class:"flex"},il={class:"space-y-3"},dl={class:"space-y-3"},ul=X({__name:"MultiWanGeneralSettings",setup(F){const{t:a}=Y(),l=ke(),d=g({track_ip:[],ping_timeout:"",ping_interval:"",ping_failure_interval:"",interface_down_threshold:"",interface_up_threshold:""}),v=g(),s=g(!1),L=g(new te),o=g(!1);function w(u){return Array.from(u,t=>t>=60*60?{id:t.toString(),label:`${a("standalone.multi_wan.hours",t/60/60)}`}:t>=60?{id:t.toString(),label:`${a("standalone.multi_wan.minutes",t/60)}`}:{id:t.toString(),label:`${a("standalone.multi_wan.seconds",t)}`})}function h(u){return Array.from(u,t=>({id:t.toString(),label:`${a("standalone.multi_wan.ping_test",t)}`}))}function C(){s.value=!0,v.value=void 0,H("ns.mwan","get_default_config").then(u=>{d.value={track_ip:u.data.values.track_ip,ping_timeout:String(u.data.values.ping_timeout),ping_interval:String(u.data.values.ping_interval),ping_failure_interval:String(u.data.values.ping_failure_interval),interface_down_threshold:String(u.data.values.interface_down_threshold),interface_up_threshold:String(u.data.values.interface_up_threshold)}}).catch(u=>{v.value=new Error(a(ie(u)))}).then(()=>{s.value=!1})}function f(){return L.value.clear(),d.value.track_ip.length==0&&L.value.set("track_ip",[a("standalone.validation.required")]),d.value.track_ip.forEach((u,t)=>{const{valid:c,errMessage:r}=Be(u);c||L.value.set(`track_ip.${t}`,[a(r)])}),L.value.size==0}function b(){o.value=!0,f()&&H("ns.mwan","set_default_config",d.value).then(()=>{l.getChanges()}).catch(u=>{v.value=new Error(a(ie(u)))}).finally(()=>{o.value=!1,C()})}return be(()=>{C()}),(u,t)=>s.value?(i(),$(e(_e),{key:0,lines:20})):(i(),U("div",ll,[v.value?(i(),$(e(oe),{key:0,kind:"error",title:v.value.message},null,8,["title"])):P("",!0),n(we,{description:e(a)("standalone.multi_wan.tracking_hostnames_or_ips_description"),title:e(a)("standalone.multi_wan.tracking_hostnames_or_ips_title")},{default:_(()=>{var c;return[y("div",al,[n(e(xe),{class:"mb-0"},{default:_(()=>[M(V(e(a)("standalone.multi_wan.tracking_hostnames_or_ips")),1)]),_:1}),d.value.track_ip.length>0?(i(!0),U(q,{key:0},ee(d.value.track_ip.keys(),r=>{var k;return i(),U("div",{key:r,class:"flex items-center"},[y("div",tl,[n(e(G),{modelValue:d.value.track_ip[r],"onUpdate:modelValue":S=>d.value.track_ip[r]=S,modelModifiers:{trim:!0},disabled:o.value,"invalid-message":(k=L.value.get(`track_ip.${r}`))==null?void 0:k[0]},null,8,["modelValue","onUpdate:modelValue","disabled","invalid-message"])]),n(e(B),{disabled:o.value,class:"ml-2 h-8 w-8",kind:"tertiary",size:"lg",onClick:S=>d.value.track_ip.splice(r,1)},{default:_(()=>[n(e(N),{icon:["fas","trash"],"aria-hidden":"true"})]),_:2},1032,["disabled","onClick"])])}),128)):(i(),U(q,{key:1},[y("p",ol,V(e(a)("standalone.multi_wan.no_hostnames_or_ips")),1),L.value.has("track_ip")?(i(),U("p",nl,V((c=L.value.get("track_ip"))==null?void 0:c[0]),1)):P("",!0)],64)),y("div",sl,[n(e(B),{disabled:o.value,class:"ml-auto",onClick:t[0]||(t[0]=r=>d.value.track_ip.push(""))},{prefix:_(()=>[n(e(N),{icon:"add"})]),default:_(()=>[M(" "+V(e(a)("standalone.multi_wan.add_hostname_or_ip")),1)]),_:1},8,["disabled"])])])]}),_:1},8,["description","title"]),t[7]||(t[7]=y("hr",null,null,-1)),n(we,{description:e(a)("standalone.multi_wan.ping_settings_description"),title:e(a)("standalone.multi_wan.ping_settings_title")},{default:_(()=>{var c;return[y("div",il,[n(e(W),{modelValue:d.value.ping_timeout,"onUpdate:modelValue":t[1]||(t[1]=r=>d.value.ping_timeout=r),disabled:o.value,"invalid-message":(c=L.value.get("ping.timeout"))==null?void 0:c[0],label:e(a)("standalone.multi_wan.ping_timeout"),options:w([1,2,3,4,5,6,7,8,9,10]),noResultsLabel:e(a)("ne_combobox.no_results"),limitedOptionsLabel:e(a)("ne_combobox.limited_options_label"),noOptionsLabel:e(a)("ne_combobox.no_options_label"),"selected-label":e(a)("ne_combobox.selected"),"user-input-label":e(a)("ne_combobox.user_input_label"),optionalLabel:e(a)("common.optional")},null,8,["modelValue","disabled","invalid-message","label","options","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(W),{modelValue:d.value.ping_interval,"onUpdate:modelValue":t[2]||(t[2]=r=>d.value.ping_interval=r),modelModifiers:{number:!0},disabled:o.value,label:e(a)("standalone.multi_wan.ping_interval"),options:w([1,3,5,10,20,30,60,300,600,900,1800,3600]),noResultsLabel:e(a)("ne_combobox.no_results"),limitedOptionsLabel:e(a)("ne_combobox.limited_options_label"),noOptionsLabel:e(a)("ne_combobox.no_options_label"),"selected-label":e(a)("ne_combobox.selected"),"user-input-label":e(a)("ne_combobox.user_input_label"),optionalLabel:e(a)("common.optional")},null,8,["modelValue","disabled","label","options","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(W),{modelValue:d.value.ping_failure_interval,"onUpdate:modelValue":t[3]||(t[3]=r=>d.value.ping_failure_interval=r),modelModifiers:{number:!0},disabled:o.value,label:e(a)("standalone.multi_wan.ping_failure_interval"),options:w([1,3,5,10,20,30,60,300,600,900,1800,3600]),noResultsLabel:e(a)("ne_combobox.no_results"),limitedOptionsLabel:e(a)("ne_combobox.limited_options_label"),noOptionsLabel:e(a)("ne_combobox.no_options_label"),"selected-label":e(a)("ne_combobox.selected"),"user-input-label":e(a)("ne_combobox.user_input_label"),optionalLabel:e(a)("common.optional")},null,8,["modelValue","disabled","label","options","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"])])]}),_:1},8,["description","title"]),t[8]||(t[8]=y("hr",null,null,-1)),n(we,{description:e(a)("standalone.multi_wan.interface_recovery_description"),title:e(a)("standalone.multi_wan.interface_recovery_title")},{default:_(()=>[y("div",dl,[n(e(W),{modelValue:d.value.interface_down_threshold,"onUpdate:modelValue":t[4]||(t[4]=c=>d.value.interface_down_threshold=c),disabled:o.value,label:e(a)("standalone.multi_wan.interface_down"),options:h([1,2,3,4,5,6,7,8,9,10]),noResultsLabel:e(a)("ne_combobox.no_results"),limitedOptionsLabel:e(a)("ne_combobox.limited_options_label"),noOptionsLabel:e(a)("ne_combobox.no_options_label"),"selected-label":e(a)("ne_combobox.selected"),"user-input-label":e(a)("ne_combobox.user_input_label"),optionalLabel:e(a)("common.optional")},null,8,["modelValue","disabled","label","options","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(W),{modelValue:d.value.interface_up_threshold,"onUpdate:modelValue":t[5]||(t[5]=c=>d.value.interface_up_threshold=c),disabled:o.value,label:e(a)("standalone.multi_wan.interface_up"),options:h([1,2,3,4,5,6,7,8,9,10]),noResultsLabel:e(a)("ne_combobox.no_results"),limitedOptionsLabel:e(a)("ne_combobox.limited_options_label"),noOptionsLabel:e(a)("ne_combobox.no_options_label"),"selected-label":e(a)("ne_combobox.selected"),"user-input-label":e(a)("ne_combobox.user_input_label"),optionalLabel:e(a)("common.optional")},null,8,["modelValue","disabled","label","options","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"])])]),_:1},8,["description","title"]),t[9]||(t[9]=y("hr",null,null,-1)),n(e(B),{disabled:o.value,loading:o.value,kind:"primary",onClick:t[6]||(t[6]=c=>b())},{default:_(()=>[M(V(e(a)("common.save")),1)]),_:1},8,["disabled","loading"])]))}});function rl(){const F=g(!0),a=g(),l=g([]),d=g([]);async function v(){return await Promise.all([H("ns.mwan","index_rules").then(s=>d.value=s.data.values),H("ns.mwan","index_policies").then(s=>l.value=s.data.values)]).catch(s=>a.value=s)}return be(()=>{v().finally(()=>F.value=!1)}),{loading:F,fetch:v,policies:l,rules:d,error:a}}const cl={},bl={class:"-mx-4 bg-gray-100 px-6 py-4 dark:bg-gray-800 sm:mx-0 sm:rounded-md sm:shadow"};function ml(F,a){return i(),U("div",bl,[Te(F.$slots,"default")])}const De=Me(cl,[["render",ml]]);class Q{constructor(a="",l="100"){ge(this,"id");ge(this,"weight");this.id=a,this.weight=l}}const pl=[{id:"balance",label:"standalone.multi_wan.behave_picker.balance"},{id:"backup",label:"standalone.multi_wan.behave_picker.backup"},{id:"custom",label:"standalone.multi_wan.behave_picker.custom"}];function Pe(F){const{t:a}=Y(),l=g(""),d=g("balance"),v=g([[new Q,new Q]]);de(F,()=>{var f,b;if(F.value!=null){l.value=F.value.label??"";const u=Object.values((f=F.value)==null?void 0:f.members).flat().map(t=>t.metric);u.every((t,c,r)=>t==r[0])?d.value="balance":u.every((t,c,r)=>r.indexOf(t)==c)?d.value="backup":d.value="custom",v.value=[],Object.values((b=F.value)==null?void 0:b.members).forEach((t,c)=>{v.value[c]=t.map(r=>new Q(r.interface,String(r.weight)))})}}),de(d,f=>{if(f=="backup"){v.value=v.value.map(b=>b.map(u=>[u])).flat(1);for(let b=v.value.length;b<2;b++)v.value.push([new Q])}else if(f=="balance"){v.value=[v.value.flat(1)];for(let b=v.value[0].length;b<2;b++)v.value[0].push(new Q)}else v.value.forEach((b,u)=>{v.value[u]=b.filter(t=>t.id!="")}),v.value=v.value.filter(b=>b.filter(u=>u.id!="").length>0),v.value.length==0&&(v.value=[[new Q]])});const s=re(()=>d.value=="balance"?v.value[0].length<3:d.value=="backup"?v.value.length<3:!1),L=pl.map(f=>(f.label=a(f.label),f));function o(f,b){v.value[f].splice(b,1),v.value=v.value.filter(u=>u.length>0)}function w(){v.value.push([new Q])}function h(f){v.value[f].push(new Q)}function C(){l.value="",d.value="balance",v.value=[[new Q,new Q]]}return{label:l,selection:d,priorities:v,policyOptionSelection:L,isTrashButtonDisabled:s,removePriority:o,addPriority:w,addGateway:h,cleanForm:C}}const vl={key:1,class:"space-y-8"},_l={class:"flex justify-end gap-4"},fl=X({__name:"PolicyCreator",props:{isShown:{type:Boolean,required:!0},createDefault:{type:Boolean,default:!1}},emits:["success","close"],setup(F,{emit:a}){const{t:l}=Y(),d=Re(),v=F,s=$e(Pe(ce(()=>{}))),L=g(!1),o=g(new te),w=g(),h=g(null),C=re(()=>d.zonesWithoutAliases.filter(t=>t.configName=="ns_wan").map(t=>t.interfaces).flat().map(t=>({id:t,label:t})));de(()=>v.isShown,()=>{s.cleanForm(),o.value.clear(),v.createDefault&&(s.label="Default"),v.isShown&&!v.createDefault&&setTimeout(()=>{var t;return(t=h.value)==null?void 0:t.focus()},50)});const f=a;be(()=>{d.fetch()});function b(){var c;o.value=new te;let t=ae(s.label).errMessage;return t&&(o.value.set("name",[t.valueOf()]),(c=h.value)==null||c.focus()),s.priorities.flat().forEach((r,k)=>{t=ae(r.id).errMessage,t&&o.value.set(`interfaces.${k}.name`,[t.valueOf()])}),!(o.value.size>0)}function u(){b()&&(L.value=!0,H("ns.mwan","store_policy",{name:s.label,interfaces:s.priorities.map((t,c)=>t.map(r=>({name:r.id,metric:(c+1)*10,weight:r.weight}))).flat()}).then(()=>{f("success"),s.cleanForm()}).catch(t=>{o.value=t.errorBag}).catch(t=>{w.value=t}).finally(()=>{L.value=!1}))}return(t,c)=>(i(),$(e(fe),{"is-shown":F.isShown,title:e(l)("standalone.multi_wan.create_policy",{name:s.label}),onClose:c[5]||(c[5]=r=>t.$emit("close"))},{default:_(()=>[e(d).error?(i(),$(e(oe),{key:0,kind:"error",title:e(d).error.message},null,8,["title"])):(i(),U("div",vl,[n(e(G),{ref_key:"labelElement",ref:h,modelValue:s.label,"onUpdate:modelValue":c[0]||(c[0]=r=>s.label=r),modelModifiers:{trim:!0},disabled:F.createDefault,"invalid-message":e(l)(o.value.getFirstI18nKeyFor("name")),label:e(l)("standalone.multi_wan.label_input_label")},null,8,["modelValue","disabled","invalid-message","label"]),n(e(ue),{modelValue:s.selection,"onUpdate:modelValue":c[1]||(c[1]=r=>s.selection=r),label:e(l)("standalone.multi_wan.behave_picker.choose_behaviour"),options:s.policyOptionSelection,"screen-reader-help-text":e(l)("standalone.multi_wan.behave_picker.choose_behaviour_sr")},null,8,["modelValue","label","options","screen-reader-help-text"]),e(d).loading?(i(),$(e(_e),{key:0,lines:10})):(i(!0),U(q,{key:1},ee(s.priorities,(r,k)=>(i(),U("div",{key:k,class:"space-y-4"},[s.priorities.length>1?(i(),$(e(xe),{key:0},{default:_(()=>[M(V(e(l)("standalone.multi_wan.priority",k+1)),1)]),_:2},1024)):P("",!0),(i(!0),U(q,null,ee(r,(S,E)=>(i(),U("div",{key:E,class:"flex gap-x-4"},[n(e(W),{modelValue:S.id,"onUpdate:modelValue":R=>S.id=R,"invalid-message":e(l)(o.value.getFirstI18nKeyFor(`interfaces.${E}.name`)),options:C.value,placeholder:e(l)("standalone.multi_wan.choose_gateway"),class:"grow",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","onUpdate:modelValue","invalid-message","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),s.selection!="backup"?(i(),$(e(G),{key:0,modelValue:S.weight,"onUpdate:modelValue":R=>S.weight=R,modelModifiers:{number:!0},"invalid-message":e(l)(o.value.getFirstI18nKeyFor(`interfaces.${E}.weight`)),placeholder:e(l)("standalone.multi_wan.weight")},null,8,["modelValue","onUpdate:modelValue","invalid-message","placeholder"])):P("",!0),n(e(B),{disabled:s.isTrashButtonDisabled,onClick:R=>s.removePriority(k,E)},{default:_(()=>[n(e(N),{icon:["fas","trash"]})]),_:2},1032,["disabled","onClick"])]))),128)),s.selection!="backup"?(i(),$(e(B),{key:1,kind:"tertiary",onClick:S=>s.addGateway(k)},{default:_(()=>[M(V(e(l)("standalone.multi_wan.add_gateway")),1)]),_:2},1032,["onClick"])):P("",!0)]))),128)),s.selection!="balance"?(i(),$(e(B),{key:2,onClick:c[2]||(c[2]=r=>s.addPriority())},{prefix:_(()=>[n(e(N),{icon:e(Oe)},null,8,["icon"])]),default:_(()=>[c[6]||(c[6]=M(" Add Priority level "))]),_:1})):P("",!0),c[7]||(c[7]=y("hr",null,null,-1)),y("div",_l,[n(e(B),{disabled:L.value,kind:"tertiary",onClick:c[3]||(c[3]=r=>t.$emit("close"))},{default:_(()=>[M(V(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),n(e(B),{disabled:L.value,kind:"primary",loading:L.value,onClick:c[4]||(c[4]=r=>u())},{default:_(()=>[M(V(e(l)("common.save")),1)]),_:1},8,["disabled","loading"])])]))]),_:1},8,["is-shown","title"]))}}),gl=X({__name:"PolicyDeleter",props:{policy:{type:Object}},emits:["close","success"],setup(F,{emit:a}){const{t:l}=Y(),d=F,v=a,s=g(!1),L=g();function o(){var h;s.value=!0,H("ns.mwan","delete_policy",{name:(h=d.policy)==null?void 0:h.name}).then(()=>v("success")).catch(C=>L.value=C).finally(()=>s.value=!1)}function w(){s.value||v("close")}return(h,C)=>{var f,b;return i(),$(e(Ce),{"primary-button-disabled":s.value,"primary-button-loading":s.value,"primary-label":e(l)("standalone.multi_wan.delete_policy_modal.button"),"secondary-button-disabled":s.value,title:e(l)("standalone.multi_wan.delete_policy_modal.title",{name:((f=F.policy)==null?void 0:f.label)??((b=F.policy)==null?void 0:b.name)}),visible:F.policy!=null,kind:"warning","primary-button-kind":"danger","close-aria-label":e(l)("common.close"),onClose:C[0]||(C[0]=u=>w()),onPrimaryClick:C[1]||(C[1]=u=>o())},{default:_(()=>[L.value?(i(),$(e(oe),{key:0,title:e(l)(e(ie)(L.value)),kind:"error"},null,8,["title"])):P("",!0)]),_:1},8,["primary-button-disabled","primary-button-loading","primary-label","secondary-button-disabled","title","visible","close-aria-label"])}}}),yl={key:1,class:"space-y-8"},wl={class:"flex justify-end gap-4"},kl=X({__name:"PolicyEditor",props:{policy:{type:Object}},emits:["close","success"],setup(F,{emit:a}){const{t:l}=Y(),d=Re(),v=g(null);be(()=>{d.fetch()});const s=F,L=a,o=$e(Pe(ce(()=>s.policy))),w=g(new te),h=g(!1),C=g(),f=re(()=>d.zonesWithoutAliases.filter(r=>r.configName=="ns_wan").map(r=>r.interfaces).flat().map(r=>({id:r,label:r})));function b(){L("close"),u()}function u(){o.cleanForm(),w.value.clear()}function t(){var k;w.value=new te;let r=ae(o.label).errMessage;return r&&(w.value.set("name",[r.valueOf()]),(k=v.value)==null||k.focus()),o.priorities.flat().forEach((S,E)=>{r=ae(S.id).errMessage,r&&w.value.set(`interfaces.${E}.name`,[r.valueOf()])}),!(w.value.size>0)}function c(){var r;t()&&H("ns.mwan","edit_policy",{name:(r=s.policy)==null?void 0:r.name,label:o.label,interfaces:o.priorities.map((k,S)=>k.map(E=>({name:E.id,metric:(S+1)*10,weight:E.weight}))).flat()}).then(()=>{L("success")}).catch(k=>{w.value=k.errorBag}).catch(k=>{C.value=k}).finally(()=>{h.value=!1})}return(r,k)=>(i(),$(e(fe),{"is-shown":F.policy!=null,title:e(l)("standalone.multi_wan.edit_policy",{name:o.label}),onClose:k[5]||(k[5]=S=>b())},{default:_(()=>[e(d).error?(i(),$(e(oe),{key:0,kind:"error",title:e(d).error.message},null,8,["title"])):(i(),U("div",yl,[n(e(G),{ref_key:"labelElement",ref:v,modelValue:o.label,"onUpdate:modelValue":k[0]||(k[0]=S=>o.label=S),modelModifiers:{trim:!0},disabled:"","invalid-message":w.value.getFirstI18nKeyFor("name"),label:e(l)("standalone.multi_wan.label_input_label")},null,8,["modelValue","invalid-message","label"]),n(e(ue),{modelValue:o.selection,"onUpdate:modelValue":k[1]||(k[1]=S=>o.selection=S),label:e(l)("standalone.multi_wan.behave_picker.choose_behaviour"),options:o.policyOptionSelection,"screen-reader-help-text":e(l)("standalone.multi_wan.behave_picker.choose_behaviour_sr")},null,8,["modelValue","label","options","screen-reader-help-text"]),e(d).loading?(i(),$(e(_e),{key:0,lines:10})):(i(!0),U(q,{key:1},ee(o.priorities,(S,E)=>(i(),U("div",{key:E,class:"space-y-4"},[o.priorities.length>1?(i(),$(e(xe),{key:0},{default:_(()=>[M(V(e(l)("standalone.multi_wan.priority",E+1)),1)]),_:2},1024)):P("",!0),(i(!0),U(q,null,ee(S,(R,I)=>(i(),U("div",{key:I,class:"flex gap-x-4"},[n(e(W),{modelValue:R.id,"onUpdate:modelValue":x=>R.id=x,"invalid-message":e(l)(w.value.getFirstI18nKeyFor(`interfaces.${I}.name`)),options:f.value,placeholder:e(l)("standalone.multi_wan.choose_gateway"),class:"grow",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","onUpdate:modelValue","invalid-message","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),o.selection!="backup"?(i(),$(e(G),{key:0,modelValue:R.weight,"onUpdate:modelValue":x=>R.weight=x,modelModifiers:{number:!0},"invalid-message":e(l)(w.value.getFirstI18nKeyFor(`interfaces.${I}.weight`)),placeholder:e(l)("standalone.multi_wan.weight")},null,8,["modelValue","onUpdate:modelValue","invalid-message","placeholder"])):P("",!0),n(e(B),{disabled:o.isTrashButtonDisabled,onClick:x=>o.removePriority(E,I)},{default:_(()=>[n(e(N),{icon:["fas","trash"]})]),_:2},1032,["disabled","onClick"])]))),128)),o.selection!="backup"?(i(),$(e(B),{key:1,kind:"tertiary",onClick:R=>o.addGateway(E)},{default:_(()=>[M(V(e(l)("standalone.multi_wan.add_gateway")),1)]),_:2},1032,["onClick"])):P("",!0)]))),128)),o.selection!="balance"?(i(),$(e(B),{key:2,onClick:k[2]||(k[2]=S=>o.addPriority())},{prefix:_(()=>[n(e(N),{icon:e(Oe)},null,8,["icon"])]),default:_(()=>[k[6]||(k[6]=M(" Add Priority level "))]),_:1})):P("",!0),k[7]||(k[7]=y("hr",null,null,-1)),y("div",wl,[n(e(B),{disabled:h.value,kind:"tertiary",onClick:k[3]||(k[3]=S=>b())},{default:_(()=>[M(V(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),n(e(B),{disabled:h.value,kind:"primary",loading:h.value,onClick:k[4]||(k[4]=S=>c())},{default:_(()=>[M(V(e(l)("common.edit")),1)]),_:1},8,["disabled","loading"])])]))]),_:1},8,["is-shown","title"]))}}),xl={key:1},Ll={key:0},hl=["colspan"],Vl=["onDragenter","onDrop"],$l=["colspan"],Ol=["onDragstart"],Cl={class:"cursor-move text-center hover:bg-opacity-50 hover:dark:bg-opacity-70"},Fl={key:0},jl={key:1},Sl={key:2},Ul={key:3},Ml={class:"flex justify-start gap-2"},Rl=["colspan"],Dl=X({__name:"RuleManager",props:{rules:{},policiesExist:{type:Boolean},loading:{type:Boolean,default:!1}},emits:["create","edit","delete"],setup(F){const{t:a}=Y(),l=ke(),d=[{key:"vertical-grip"},{label:"Name",key:"name"},{label:"Policy",key:"policy.name"},{label:"Source",key:"source"},{label:"Destination",key:"destination"},{label:"Protocol",key:"protocol"},{label:"Actions",key:"actions"}],v=F,s=g([]),L=g(),o=g(),w=g();de(()=>v.rules,()=>{s.value=v.rules});function h(f){w.value=void 0,o.value!=null&&o.value!=f&&(o.value-f<0?s.value.splice(f-1,0,...s.value.splice(o.value,1)):s.value.splice(f,0,...s.value.splice(o.value,1)),C())}function C(){H("ns.mwan","order_rules",{rules:s.value.map(f=>f.name)}).then(()=>l.getChanges()).catch(f=>L.value=new Error(ie(f)))}return(f,b)=>L.value?(i(),$(e(oe),{key:0,kind:"error",class:"mb-4"},{default:_(()=>[M(V(L.value.message),1)]),_:1})):!f.loading&&f.rules.length<1?(i(),$(De,{key:1,class:"space-y-4 text-center"},{default:_(()=>[y("p",null,V(e(a)("standalone.multi_wan.no_rule_found")),1),f.policiesExist?(i(),$(e(B),{key:0,kind:"primary",onClick:b[0]||(b[0]=u=>f.$emit("create"))},{prefix:_(()=>[n(e(N),{icon:e(ve)},null,8,["icon"])]),default:_(()=>[M(" "+V(e(a)("standalone.multi_wan.create_default_policy")),1)]),_:1})):(i(),U("p",xl,V(e(a)("standalone.multi_wan.create_policy_before")),1))]),_:1})):(i(),$(Ue,{key:2,data:f.rules,headers:d,loading:f.loading,style:"card",class:"!border-spacing-y-1"},{tbody:_(()=>[y("tbody",null,[f.loading?(i(),U("tr",Ll,[y("td",{colspan:d.length},[n(e(_e),{lines:3})],8,hl)])):(i(!0),U(q,{key:1},ee(s.value,(u,t)=>(i(),U(q,{key:u.key},[y("tr",{class:ye([[w.value==t?"drop-over drop-target":"",o.value!=null?"drop-active":""],"drop-target"]),onDragenter:c=>w.value=t,onDragleave:b[1]||(b[1]=c=>w.value=void 0),onDrop:pe(c=>h(t),["prevent"]),onDragover:b[2]||(b[2]=pe(()=>{},["prevent"]))},[y("td",{colspan:d.length},null,8,$l)],42,Vl),y("tr",{class:ye({"opacity-30":o.value==t}),draggable:"true",onDragend:b[3]||(b[3]=c=>o.value=void 0),onDragstart:c=>o.value=t},[y("td",Cl,[n(e(N),{icon:e(Ae)},null,8,["icon"])]),y("td",null,V(u.label??u.name),1),y("td",null,V(u.policy.label??u.policy.name),1),u.ns_src?(i(),U("td",Fl,[n(Ve,{"object-id":u.ns_src},null,8,["object-id"])])):(i(),U("td",jl,V(u.source_address??e(a)("standalone.multi_wan.any")),1)),u.ns_dst?(i(),U("td",Sl,[n(Ve,{"object-id":u.ns_dst},null,8,["object-id"])])):(i(),U("td",Ul,V(u.destination_address??e(a)("standalone.multi_wan.any")),1)),y("td",null,V(u.protocol?e(a)(`standalone.multi_wan.protocol_${u.protocol}`):e(a)("standalone.multi_wan.all")),1),y("td",null,[y("div",Ml,[n(e(B),{kind:"tertiary",onClick:c=>f.$emit("edit",u)},{prefix:_(()=>[n(e(N),{icon:["fas","edit"]})]),default:_(()=>[M(" "+V(e(a)("Edit")),1)]),_:2},1032,["onClick"]),n(e(Fe),{items:[{id:"delete",action:()=>f.$emit("delete",u),label:e(a)("common.delete"),disabled:u.name=="ns_default_rule",danger:!0}],"align-to-right":""},null,8,["items"])])])],42,Ol)],64))),128)),y("tr",{class:ye([[w.value==s.value.length?"drop-over":"",o.value!=null?"drop-active":""],"drop-target"]),onDragenter:b[4]||(b[4]=u=>w.value=s.value.length),onDragleave:b[5]||(b[5]=u=>w.value=void 0),onDrop:b[6]||(b[6]=pe(u=>h(s.value.length),["prevent"])),onDragover:b[7]||(b[7]=pe(()=>{},["prevent"]))},[y("td",{colspan:d.length},null,8,Rl)],34)])]),_:1},8,["data","loading"]))}}),Pl=Me(Dl,[["__scopeId","data-v-9a0c4cb9"]]);function Ee(F,a){const{t:l}=Y(),d=[{id:"all",label:l("standalone.multi_wan.all_protocols")},{id:"tcp",label:"TCP"},{id:"udp",label:"UDP"},{id:"icmp",label:"ICMP"},{id:"esp",label:"ESP"}],v=re(()=>F.value.map(m=>({id:m.name,label:m.label??m.name}))),s=re(()=>v.value.length<3?l("standalone.multi_wan.select_policy"):v.value.map(m=>m.label).join(", ")+",...");de(()=>a==null?void 0:a.value,()=>{(a==null?void 0:a.value)!=null&&(L.value=a.value.label??"",o.value=a.value.policy.name,w.value=a.value.protocol??d[0].id,h.value=a.value.source_address??"",C.value=a.value.source_port??"",f.value=a.value.destination_address??"",b.value=a.value.destination_port??"",u.value=a.value.sticky,S.value=a.value.ns_src,E.value=a.value.ns_dst,S.value!=null?r.value="object":h.value!=""?r.value="address":r.value="any",E.value!=null?k.value="object":f.value!=""?k.value="address":k.value="any")});const L=g(""),o=g(""),w=g(""),h=g(""),C=g(""),f=g(""),b=g(""),u=g(!1),t=[{id:"address",label:l("standalone.multi_wan.address_options_address")},{id:"any",label:l("standalone.multi_wan.address_options_any_src")},{id:"object",label:l("standalone.multi_wan.address_options_object")}],c=[{id:"address",label:l("standalone.multi_wan.address_options_address")},{id:"any",label:l("standalone.multi_wan.address_options_any_dst")},{id:"object",label:l("standalone.multi_wan.address_options_object")}],r=g("address"),k=g("address"),S=g(),E=g(),R=g(),I=g(!0),x=g([]),O=g([]),{getObjectIcon:z}=Ze();H("ns.mwan","list_object_suggestions").then(m=>{x.value=m.data.objects.ns_src.map(A=>({id:A.id,label:A.name,description:l(`standalone.objects.subtype_${A.subtype}`),icon:z(A.subtype)})),O.value=m.data.objects.ns_dst.map(A=>({id:A.id,label:A.name,description:l(`standalone.objects.subtype_${A.subtype}`),icon:z(A.subtype)}))}).catch(()=>{R.value=Error("standalone.multi_wan.error_fetching_objects")}).finally(()=>{I.value=!1});const T=g(new te);function Z(){T.value.clear();let m=ae(o.value);if(m.valid||T.value.set("policy",String(m.errMessage)),m=ae(o.value),m.valid||T.value.set("policy",String(m.errMessage)),L.value!="Default Rule"){m=ae(L.value),m.valid||T.value.set("name",String(m.errMessage));const{valid:A,errMessage:ne,i18Params:le}=ze(L.value,12);A||T.value.set("name",l(ne,le))}return h.value!=""&&(m=Le(h.value),m.valid||T.value.set("source_address",String(m.errMessage))),f.value!=""&&(m=Le(f.value),m.valid||T.value.set("destination_address",String(m.errMessage))),(w.value=="tcp"||w.value=="udp")&&(C.value!=""&&(m=he(C.value),m.valid||T.value.set("source_port",String(m.errMessage))),b.value!=""&&(m=he(b.value),m.valid||T.value.set("destination_port",String(m.errMessage)))),T.value.size<1}return{protocolOptions:d,policyDropdownOptions:v,policyDropdownPlaceholder:s,name:L,policy:o,protocol:w,sourceAddress:h,sourcePort:C,destinationAddress:f,destinationPort:b,validationErrors:T,sticky:u,isValid:Z,srcType:r,dstType:k,srcAddressOptions:t,dstAddressOptions:c,objectsLoading:I,objectsError:R,srcObject:S,srcObjectOptions:x,dstObject:E,dstObjectOptions:O}}const El={class:"space-y-8"},Il={class:"flex justify-end gap-4"},Kl=X({__name:"RuleCreator",props:{isShown:{type:Boolean},policies:{}},emits:["success","cancel"],setup(F,{emit:a}){const{t:l}=Y(),d=a,v=F,{policyDropdownOptions:s,protocolOptions:L,policyDropdownPlaceholder:o,name:w,policy:h,protocol:C,sourceAddress:f,sourcePort:b,destinationAddress:u,destinationPort:t,sticky:c,validationErrors:r,isValid:k,srcAddressOptions:S,dstAddressOptions:E,srcType:R,dstType:I,objectsLoading:x,srcObject:O,srcObjectOptions:z,dstObject:T,dstObjectOptions:Z}=Ee(ce(()=>v.policies)),m=g(!1),A=g();function ne(){d("cancel"),le()}function le(){w.value="",h.value="",C.value="",f.value="",b.value="",u.value="",t.value="",r.value.clear(),c.value=!1,R.value="address",I.value="address",O.value="",T.value=""}function me(){if(k()){m.value=!0;const J={name:w.value,policy:h.value,protocol:C.value,source_port:b.value,destination_port:t.value,sticky:c.value};switch(R.value){case"address":J.source_address=f.value;break;case"object":J.ns_src=O.value;break;default:J.source_address="";break}switch(I.value){case"address":J.destination_address=u.value;break;case"object":J.ns_dst=T.value;break;default:J.destination_address="";break}H("ns.mwan","store_rule",J).then(()=>d("success")).catch(j=>{j instanceof Se?r.value=j.errorBag:A.value=j}).finally(()=>{m.value=!1,le()})}}return(J,j)=>(i(),$(e(fe),{"is-shown":J.isShown,title:e(l)("standalone.multi_wan.create_new_rule"),onClose:j[14]||(j[14]=p=>ne())},{default:_(()=>[y("div",El,[n(e(G),{modelValue:e(w),"onUpdate:modelValue":j[0]||(j[0]=p=>K(w)?w.value=p:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(r).getFirstFor("name"),label:e(l)("standalone.multi_wan.rule_name"),placeholder:e(l)("standalone.multi_wan.rule_name"),name:"rule_name"},null,8,["modelValue","disabled","invalid-message","label","placeholder"]),n(e(W),{modelValue:e(h),"onUpdate:modelValue":j[1]||(j[1]=p=>K(h)?h.value=p:null),disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("policy")),label:e(l)("standalone.multi_wan.assigned_policy"),options:e(s),placeholder:e(o),name:"policy",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","disabled","invalid-message","label","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(W),{modelValue:e(C),"onUpdate:modelValue":j[2]||(j[2]=p=>K(C)?C.value=p:null),disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("protocol")),label:e(l)("standalone.multi_wan.protocol"),options:e(L),placeholder:e(L)[0].label,name:"protocol",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","disabled","invalid-message","label","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(ue),{modelValue:e(R),"onUpdate:modelValue":j[3]||(j[3]=p=>K(R)?R.value=p:null),disabled:m.value,label:e(l)("standalone.multi_wan.source_type"),options:e(S)},null,8,["modelValue","disabled","label","options"]),e(R)=="address"?(i(),$(e(G),{key:0,modelValue:e(f),"onUpdate:modelValue":j[4]||(j[4]=p=>K(f)?f.value=p:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("source_address")),label:e(l)("standalone.multi_wan.source_address"),name:"source_address"},null,8,["modelValue","disabled","invalid-message","label"])):P("",!0),e(R)=="object"?(i(),$(e(W),{key:1,modelValue:e(O),"onUpdate:modelValue":j[5]||(j[5]=p=>K(O)?O.value=p:null),disabled:m.value,label:e(l)("standalone.multi_wan.source_object"),options:e(z),placeholder:e(x)?e(l)("common.loading"):e(l)("ne_combobox.choose"),"invalid-message":e(l)(e(r).getFirstI18nKeyFor("ns_src")),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label")},null,8,["modelValue","disabled","label","options","placeholder","invalid-message","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"])):P("",!0),e(C)=="tcp"||e(C)=="udp"?(i(),$(e(G),{key:2,modelValue:e(b),"onUpdate:modelValue":j[6]||(j[6]=p=>K(b)?b.value=p:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("source_port")),label:e(l)("standalone.multi_wan.source_port"),placeholder:e(l)("standalone.multi_wan.any"),name:"source_port"},{tooltip:_(()=>[n(e(se),null,{content:_(()=>[M(V(e(l)("standalone.multi_wan.ports_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label","placeholder"])):P("",!0),n(e(ue),{modelValue:e(I),"onUpdate:modelValue":j[7]||(j[7]=p=>K(I)?I.value=p:null),disabled:m.value,label:e(l)("standalone.multi_wan.destination_type"),options:e(E)},null,8,["modelValue","disabled","label","options"]),e(I)=="address"?(i(),$(e(G),{key:3,modelValue:e(u),"onUpdate:modelValue":j[8]||(j[8]=p=>K(u)?u.value=p:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("destination_address")),label:e(l)("standalone.multi_wan.destination_address"),name:"destination_address"},null,8,["modelValue","disabled","invalid-message","label"])):P("",!0),e(I)=="object"?(i(),$(e(W),{key:4,modelValue:e(T),"onUpdate:modelValue":j[9]||(j[9]=p=>K(T)?T.value=p:null),disabled:m.value,label:e(l)("standalone.multi_wan.destination_object"),options:e(Z),placeholder:e(x)?e(l)("common.loading"):e(l)("ne_combobox.choose"),"invalid-message":e(l)(e(r).getFirstI18nKeyFor("ns_dst")),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label")},null,8,["modelValue","disabled","label","options","placeholder","invalid-message","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"])):P("",!0),e(C)=="tcp"||e(C)=="udp"?(i(),$(e(G),{key:5,modelValue:e(t),"onUpdate:modelValue":j[10]||(j[10]=p=>K(t)?t.value=p:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(r).getFirstI18nKeyFor("destination_port")),label:e(l)("standalone.multi_wan.destination_port"),placeholder:e(l)("standalone.multi_wan.any"),name:"destination_port"},{tooltip:_(()=>[n(e(se),null,{content:_(()=>[M(V(e(l)("standalone.multi_wan.ports_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label","placeholder"])):P("",!0),n(e(je),{modelValue:e(c),"onUpdate:modelValue":j[11]||(j[11]=p=>K(c)?c.value=p:null),topLabel:e(l)("standalone.multi_wan.sticky"),label:e(c)?e(l)("common.enabled"):e(l)("common.disabled")},{topTooltip:_(()=>[n(e(se),{placement:"top-start"},{content:_(()=>[M(V(e(l)("standalone.multi_wan.sticky_tooltip")),1)]),_:1})]),_:1},8,["modelValue","topLabel","label"]),j[15]||(j[15]=y("hr",null,null,-1)),y("div",Il,[n(e(B),{disabled:m.value,kind:"secondary",onClick:j[12]||(j[12]=p=>ne())},{default:_(()=>[M(V(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),n(e(B),{disabled:m.value,kind:"primary",loading:m.value,onClick:j[13]||(j[13]=p=>me())},{default:_(()=>[M(V(e(l)("common.save")),1)]),_:1},8,["disabled","loading"])])])]),_:1},8,["is-shown","title"]))}}),Bl=X({__name:"RuleDeleter",props:{rule:{}},emits:["success","cancel"],setup(F,{emit:a}){const{t:l}=Y(),d=F,v=a,s=g(!1),L=g(),o=g(""),w=g("");de(()=>d.rule,()=>{d.rule!=null&&(o.value=d.rule.name,w.value=d.rule.label??d.rule.name,s.value=!1)});function h(){s.value||v("cancel")}function C(){s.value=!0,H("ns.mwan","delete_rule",{name:o.value}).then(()=>v("success")).catch(f=>{L.value=f,s.value=!1})}return(f,b)=>(i(),$(e(Ce),{visible:d.rule!=null,kind:"warning",onClose:b[0]||(b[0]=u=>h()),"primary-button-kind":"danger",title:e(l)("standalone.multi_wan.delete_rule_modal.title",{name:w.value}),"primary-label":e(l)("standalone.multi_wan.delete_rule_modal.button"),"primary-button-disabled":s.value,"primary-button-loading":s.value,"secondary-button-disabled":s.value,"close-aria-label":e(l)("common.close"),onPrimaryClick:b[1]||(b[1]=u=>C())},{default:_(()=>[L.value?(i(),$(e(oe),{key:0,kind:"error",title:e(l)(e(ie)(L.value))},null,8,["title"])):P("",!0)]),_:1},8,["visible","title","primary-label","primary-button-disabled","primary-button-loading","secondary-button-disabled","close-aria-label"]))}}),Tl={class:"space-y-8"},Al={class:"flex justify-end gap-4"},zl=X({__name:"RuleEditor",props:{rule:{},policies:{}},emits:["close","success"],setup(F,{emit:a}){const{t:l}=Y(),d=F,{policyDropdownOptions:v,protocolOptions:s,policyDropdownPlaceholder:L,name:o,policy:w,protocol:h,sourceAddress:C,sourcePort:f,destinationAddress:b,destinationPort:u,sticky:t,validationErrors:c,isValid:r,srcAddressOptions:k,dstAddressOptions:S,srcType:E,dstType:R,objectsLoading:I,srcObject:x,srcObjectOptions:O,dstObject:z,dstObjectOptions:T}=Ee(ce(()=>d.policies),ce(()=>d.rule)),Z=a,m=g(!1),A=g(new te),ne=g();function le(){Z("close"),me()}function me(){o.value="",w.value="",h.value="",C.value="",f.value="",b.value="",u.value="",x.value="",z.value="",c.value.clear()}function J(){var j;if(r()){m.value=!0;const p={name:(j=d.rule)==null?void 0:j.name,label:o.value,policy:w.value,protocol:h.value,source_port:f.value,destination_port:u.value,sticky:t.value};switch(E.value){case"address":p.source_address=C.value;break;case"object":p.ns_src=x.value;break;default:p.source_address="";break}switch(R.value){case"address":p.destination_address=b.value;break;case"object":p.ns_dst=z.value;break;default:p.destination_address="";break}H("ns.mwan","edit_rule",p).then(()=>Z("success")).catch(D=>{D instanceof Se?A.value=D.errorBag:ne.value=D}).finally(()=>{m.value=!1,me()})}}return(j,p)=>(i(),$(e(fe),{"is-shown":j.rule!=null,title:e(l)("standalone.multi_wan.edit_rule",{name:e(o)}),onClose:p[14]||(p[14]=D=>le())},{default:_(()=>[y("div",Tl,[n(e(G),{modelValue:e(o),"onUpdate:modelValue":p[0]||(p[0]=D=>K(o)?o.value=D:null),modelModifiers:{trim:!0},disabled:"","invalid-message":e(l)(e(c).getFirstI18nKeyFor("name")),label:e(l)("standalone.multi_wan.rule_name"),placeholder:e(l)("standalone.multi_wan.rule_name"),name:"rule_name"},null,8,["modelValue","invalid-message","label","placeholder"]),n(e(W),{modelValue:e(w),"onUpdate:modelValue":p[1]||(p[1]=D=>K(w)?w.value=D:null),disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("policy")),label:e(l)("standalone.multi_wan.assigned_policy"),options:e(v),placeholder:e(L),name:"policy",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","disabled","invalid-message","label","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(W),{modelValue:e(h),"onUpdate:modelValue":p[2]||(p[2]=D=>K(h)?h.value=D:null),disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("protocol")),label:e(l)("standalone.multi_wan.protocol"),options:e(s),placeholder:e(s)[0].label,name:"protocol",noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","disabled","invalid-message","label","options","placeholder","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label","optionalLabel"]),n(e(ue),{modelValue:e(E),"onUpdate:modelValue":p[3]||(p[3]=D=>K(E)?E.value=D:null),disabled:m.value,label:e(l)("standalone.multi_wan.source_type"),options:e(k)},null,8,["modelValue","disabled","label","options"]),e(E)=="address"?(i(),$(e(G),{key:0,modelValue:e(C),"onUpdate:modelValue":p[4]||(p[4]=D=>K(C)?C.value=D:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("source_address")),label:e(l)("standalone.multi_wan.source_address"),name:"source_address",placeholder:"any"},null,8,["modelValue","disabled","invalid-message","label"])):P("",!0),e(E)=="object"?(i(),$(e(W),{key:1,modelValue:e(x),"onUpdate:modelValue":p[5]||(p[5]=D=>K(x)?x.value=D:null),disabled:m.value,label:e(l)("standalone.multi_wan.source_object"),options:e(O),placeholder:e(I)?e(l)("common.loading"):e(l)("ne_combobox.choose"),"invalid-message":e(l)(e(c).getFirstI18nKeyFor("ns_src")),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label")},null,8,["modelValue","disabled","label","options","placeholder","invalid-message","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"])):P("",!0),e(h)=="tcp"||e(h)=="udp"?(i(),$(e(G),{key:2,modelValue:e(f),"onUpdate:modelValue":p[6]||(p[6]=D=>K(f)?f.value=D:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("source_port")),label:e(l)("standalone.multi_wan.source_port"),placeholder:e(l)("standalone.multi_wan.any"),name:"source_port"},{tooltip:_(()=>[n(e(se),null,{content:_(()=>[M(V(e(l)("standalone.multi_wan.ports_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label","placeholder"])):P("",!0),n(e(ue),{modelValue:e(R),"onUpdate:modelValue":p[7]||(p[7]=D=>K(R)?R.value=D:null),disabled:m.value,label:e(l)("standalone.multi_wan.destination_type"),options:e(S)},null,8,["modelValue","disabled","label","options"]),e(R)=="address"?(i(),$(e(G),{key:3,modelValue:e(b),"onUpdate:modelValue":p[8]||(p[8]=D=>K(b)?b.value=D:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("destination_address")),label:e(l)("standalone.multi_wan.destination_address"),placeholder:e(l)("standalone.multi_wan.any"),name:"destination_address"},null,8,["modelValue","disabled","invalid-message","label","placeholder"])):P("",!0),e(R)=="object"?(i(),$(e(W),{key:4,modelValue:e(z),"onUpdate:modelValue":p[9]||(p[9]=D=>K(z)?z.value=D:null),disabled:m.value,label:e(l)("standalone.multi_wan.destination_object"),options:e(T),placeholder:e(I)?e(l)("common.loading"):e(l)("ne_combobox.choose"),"invalid-message":e(l)(e(c).getFirstI18nKeyFor("ns_dst")),optionalLabel:e(l)("common.optional"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label")},null,8,["modelValue","disabled","label","options","placeholder","invalid-message","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","user-input-label"])):P("",!0),e(h)=="tcp"||e(h)=="udp"?(i(),$(e(G),{key:5,modelValue:e(u),"onUpdate:modelValue":p[10]||(p[10]=D=>K(u)?u.value=D:null),modelModifiers:{trim:!0},disabled:m.value,"invalid-message":e(l)(e(c).getFirstI18nKeyFor("destination_port")),label:e(l)("standalone.multi_wan.destination_port"),placeholder:e(l)("standalone.multi_wan.any"),name:"destination_port"},{tooltip:_(()=>[n(e(se),null,{content:_(()=>[M(V(e(l)("standalone.multi_wan.ports_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","invalid-message","label","placeholder"])):P("",!0),n(e(je),{modelValue:e(t),"onUpdate:modelValue":p[11]||(p[11]=D=>K(t)?t.value=D:null),topLabel:e(l)("standalone.multi_wan.sticky"),label:e(t)?e(l)("common.enabled"):e(l)("common.disabled")},{topTooltip:_(()=>[n(e(se),{placement:"top-start"},{content:_(()=>[M(V(e(l)("standalone.multi_wan.sticky_tooltip")),1)]),_:1})]),_:1},8,["modelValue","topLabel","label"]),p[15]||(p[15]=y("hr",null,null,-1)),y("div",Al,[n(e(B),{disabled:m.value,kind:"secondary",onClick:p[12]||(p[12]=D=>le())},{default:_(()=>[M(V(e(l)("common.cancel")),1)]),_:1},8,["disabled"]),n(e(B),{disabled:m.value,kind:"primary",loading:m.value,onClick:p[13]||(p[13]=D=>J())},{default:_(()=>[M(V(e(l)("common.save")),1)]),_:1},8,["disabled","loading"])])])]),_:1},8,["is-shown","title"]))}}),Nl={class:"space-y-16"},Gl={class:"space-y-8"},Wl={class:"flex flex-wrap gap-y-4"},ql={class:"mr-auto"},Hl={class:"mb-2 text-xl font-medium text-gray-900 dark:text-gray-50"},Yl={class:"max-w-2xl text-sm text-gray-500 dark:text-gray-400"},Jl={class:"flex items-center gap-4 border-r pr-8 dark:border-gray-600"},Ql={key:0,class:"flex h-8 w-8 items-center justify-center rounded-full dark:bg-gray-50 dark:text-gray-600"},Xl={class:"flex items-center"},Zl={class:"space-y-4"},ea={key:0},la={class:"flex flex-wrap gap-4"},aa={class:"flex items-center justify-end"},ta={class:"space-y-6"},oa={class:"flex flex-wrap gap-y-4"},na={class:"mr-auto"},sa={class:"mb-2 text-xl font-medium text-gray-900 dark:text-gray-50"},ia={class:"max-w-2xl text-sm text-gray-500 dark:text-gray-400"},da=X({__name:"MultiWanManager",setup(F){const{t:a}=Y(),l=g(rl()),d=ke(),v=g(!1),s=g(),L=g(),o=g(!1),w=g(),h=g();let C;be(()=>{C=setInterval(()=>{l.value.fetch()},5e3)}),Ne(()=>{clearInterval(C)});function f(){v.value=!1,k()}function b(){s.value=void 0,k()}function u(){L.value=void 0,k()}function t(){o.value=!1,k()}function c(){w.value=void 0,k()}function r(){h.value=void 0,k()}function k(){l.value.fetch(),d.getChanges()}function S(I){switch(I.status){case"online":return Je;case"offline":return Ye;case"disconnecting":case"connecting":return He;case"disabled":return qe;default:return We}}function E(I){switch(I.status){case"online":return"success";case"offline":return"error";case"disconnecting":case"connecting":return"warning";default:return}}function R(I){switch(I.type){case"balance":return["fas","scale-balanced"];case"backup":return["fas","layer-group"];default:return["fas","user-gear"]}}return(I,x)=>(i(),U(q,null,[y("div",Nl,[y("div",Gl,[y("div",Wl,[y("div",ql,[y("h6",Hl,V(e(a)("standalone.multi_wan.policy")),1),y("p",Yl,V(e(a)("standalone.multi_wan.policy_description")),1)]),l.value.policies.length>0?(i(),$(e(B),{key:0,class:"self-start",kind:"secondary",onClick:x[0]||(x[0]=O=>v.value=!0)},{prefix:_(()=>[n(e(N),{icon:e(ve)},null,8,["icon"])]),default:_(()=>[M(" "+V(e(a)("standalone.multi_wan.create_policy")),1)]),_:1})):P("",!0)]),l.value.error?(i(),$(e(oe),{key:0,title:e(a)(e(ie)(l.value.error)),kind:"error"},null,8,["title"])):(i(),U(q,{key:1},[!l.value.loading&&l.value.policies.length<1?(i(),$(De,{key:0,class:"space-y-4 text-center"},{default:_(()=>[y("p",null,V(e(a)("standalone.multi_wan.no_policy_found")),1),n(e(B),{kind:"primary",onClick:x[1]||(x[1]=O=>v.value=!0)},{prefix:_(()=>[n(e(N),{icon:e(ve)},null,8,["icon"])]),default:_(()=>[M(" "+V(e(a)("standalone.multi_wan.create_default_policy")),1)]),_:1})]),_:1})):(i(),$(Ue,{key:1,data:l.value.policies,headers:[{key:"label",label:"Policy Name"},{key:"type"},{key:"gateways",label:"Gateways"},{key:"actions"}],loading:l.value.loading,"skeleton-lines":3,style:"card"},{label:_(({item:O})=>[y("div",Jl,[O.name=="ns_default"?(i(),U("div",Ql,[n(e(N),{icon:["fas","lock"]})])):P("",!0),y("p",null,V(O.label??O.name),1)])]),type:_(({item:O})=>[y("div",Xl,[n(e(N),{icon:R(O),class:"mr-2"},null,8,["icon"]),y("p",null,V(e(a)(`standalone.multi_wan.modes.${O.type}`)),1)])]),gateways:_(({item:O})=>[y("div",Zl,[(i(!0),U(q,null,ee(Object.entries(O.members),([z,T],Z)=>(i(),U("div",{key:z,class:"flex flex-wrap items-center gap-4"},[Object.entries(O.members).length>1?(i(),U("div",ea,V(e(a)("standalone.multi_wan.priority",Z+1)),1)):P("",!0),y("div",la,[(i(!0),U(q,null,ee(T,(m,A)=>(i(),$(e(Ge),{key:A,icon:S(m),kind:E(m),label:T.length>1?`weight: ${m.weight}`:"",text:m.interface},null,8,["icon","kind","label","text"]))),128))])]))),128))])]),actions:_(({item:O})=>[y("div",aa,[n(e(B),{kind:"tertiary",onClick:z=>L.value=O},{prefix:_(()=>[n(e(N),{icon:["fas","edit"]})]),default:_(()=>[M(" "+V(e(a)("common.edit")),1)]),_:2},1032,["onClick"]),n(e(Fe),{items:[{id:"delete",label:e(a)("common.delete"),disabled:O.name=="ns_default"||l.value.rules.some(z=>z.policy.name===O.name),action:()=>s.value=O,danger:!0}],"align-to-right":""},null,8,["items"])])]),_:1},8,["data","loading"]))],64))]),y("div",null,[y("div",ta,[y("div",oa,[y("div",na,[y("h6",sa,V(e(a)("standalone.multi_wan.rules")),1),y("p",ia,V(e(a)("standalone.multi_wan.rules_description")),1)]),l.value.policies.length>0?(i(),$(e(B),{key:0,kind:"secondary",class:"self-start",onClick:x[2]||(x[2]=O=>o.value=!0)},{prefix:_(()=>[n(e(N),{icon:e(ve)},null,8,["icon"])]),default:_(()=>[M(" "+V(e(a)("standalone.multi_wan.create_rule")),1)]),_:1})):P("",!0)]),y("div",null,[n(Pl,{loading:l.value.loading,"policies-exist":l.value.policies.length>0,rules:l.value.rules,onDelete:x[3]||(x[3]=O=>w.value=O),onEdit:x[4]||(x[4]=O=>h.value=O)},null,8,["loading","policies-exist","rules"])])])])]),n(fl,{"create-default":l.value.policies.length<1,"is-shown":v.value,onClose:x[5]||(x[5]=O=>v.value=!1),onSuccess:x[6]||(x[6]=O=>f())},null,8,["create-default","is-shown"]),n(gl,{policy:s.value,onClose:x[7]||(x[7]=O=>s.value=void 0),onSuccess:x[8]||(x[8]=O=>b())},null,8,["policy"]),n(kl,{policy:L.value,onClose:x[9]||(x[9]=O=>L.value=void 0),onSuccess:x[10]||(x[10]=O=>u())},null,8,["policy"]),n(Kl,{"is-shown":o.value,policies:l.value.policies,onCancel:x[11]||(x[11]=O=>o.value=!1),onSuccess:x[12]||(x[12]=O=>t())},null,8,["is-shown","policies"]),n(Bl,{rule:w.value,onCancel:x[13]||(x[13]=O=>w.value=void 0),onSuccess:x[14]||(x[14]=O=>c())},null,8,["rule"]),n(zl,{policies:l.value.policies,rule:h.value,onClose:x[15]||(x[15]=O=>h.value=void 0),onSuccess:x[16]||(x[16]=O=>r())},null,8,["policies","rule"])],64))}}),wa=X({__name:"MultiWanView",setup(F){const{t:a}=Y(),{tabs:l,selectedTab:d}=el([{name:"multi-wan-manager",label:a("standalone.multi_wan.tabs.multi_wan_manager")},{name:"general-settings",label:a("standalone.multi_wan.tabs.general_settings")}]);return(v,s)=>(i(),U(q,null,[n(e(Qe),{tag:"h3",class:"mb-7"},{default:_(()=>[M(V(e(a)("standalone.multi_wan.title")),1)]),_:1}),y("div",null,[n(e(Xe),{selected:e(d),srSelectTabLabel:e(a)("ne_tabs.select_a_tab"),srTabsLabel:e(a)("ne_tabs.tabs"),tabs:e(l),class:"mb-8",onSelectTab:s[0]||(s[0]=L=>d.value=L)},null,8,["selected","srSelectTabLabel","srTabsLabel","tabs"]),e(d)=="multi-wan-manager"?(i(),$(da,{key:0})):P("",!0),e(d)=="general-settings"?(i(),$(ul,{key:1})):P("",!0)])],64))}});export{wa as default};
