import{d as I,u as P,r as g,aI as U,g as j,h as c,i as v,w as a,k as n,l as e,aK as W,al as C,m as s,t as o,ak as Y,q as T,ad as E,z as M,am as Q,aq as G,an as J,ao as h,H as R,j as L,_ as $,L as A,M as K,n as V,Y as O,e as N,V as q,ac as X,o as Z,c as ee,W as te,Q as ae,y as ne,aj as F}from"./index-BlEQ5104.js";const oe={class:"align-center -ml-2.5 flex xl:ml-0 xl:justify-end"},le=I({__name:"ConntrackRecordsTable",props:{conntrackRecords:{}},emits:["delete"],setup(B,{emit:D}){const{t}=P(),_=B,p=D,i=g(10),{currentPage:d,paginatedItems:b}=U(()=>_.conntrackRecords,{itemsPerPage:i});return(y,r)=>{const k=j("font-awesome-icon");return c(),v(e(G),{ariaLabel:e(t)("standalone.dns_dhcp.scan_conntrackRecords"),cardBreakpoint:"xl",skeletonColumns:5,skeletonRows:5},{paginator:a(()=>[n(e(W),{"current-page":e(d),"total-rows":_.conntrackRecords.length,"page-size":i.value,"nav-pagination-label":e(t)("ne_table.pagination"),"next-label":e(t)("ne_table.go_to_next_page"),"previous-label":e(t)("ne_table.go_to_previous_page"),"range-of-total-label":e(t)("ne_table.of"),"page-size-label":e(t)("ne_table.show"),onSelectPage:r[0]||(r[0]=l=>{d.value=l}),onSelectPageSize:r[1]||(r[1]=l=>{i.value=l})},null,8,["current-page","total-rows","page-size","nav-pagination-label","next-label","previous-label","range-of-total-label","page-size-label"])]),default:a(()=>[n(e(Y),null,{default:a(()=>[n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.source")),1)]),_:1}),n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.destination")),1)]),_:1}),n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.protocol")),1)]),_:1}),n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.download"))+" / "+o(e(t)("standalone.conntrack.upload")),1)]),_:1}),n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.state")),1)]),_:1}),n(e(C),null,{default:a(()=>[s(o(e(t)("standalone.conntrack.timeout")),1)]),_:1}),n(e(C))]),_:1}),n(e(Q),null,{default:a(()=>[(c(!0),T(M,null,E(e(b),l=>(c(),v(e(J),{key:l.source_port},{default:a(()=>[n(e(h),{"data-label":e(t)("standalone.conntrack.source")},{default:a(()=>[s(o(l.source)+":"+o(l.source_port),1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":e(t)("standalone.conntrack.destination")},{default:a(()=>[s(o(l.destination)+":"+o(l.destination_port),1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":e(t)("standalone.conntrack.protocol")},{default:a(()=>[s(o(l.protocol.toUpperCase()),1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":`${e(t)("standalone.conntrack.download")} / ${e(t)("standalone.conntrack.upload")}`},{default:a(()=>[s(o(e(R)(l.source_stats.bytes))+" / "+o(e(R)(l.destination_stats.bytes)),1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":e(t)("standalone.conntrack.state")},{default:a(()=>[s(o(l.state||"-"),1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":e(t)("standalone.conntrack.timeout")},{default:a(()=>[s(o(l.timeout)+" s ",1)]),_:2},1032,["data-label"]),n(e(h),{"data-label":e(t)("common.actions")},{default:a(()=>[L("div",oe,[n(e($),{kind:"tertiary",onClick:S=>p("delete",l)},{prefix:a(()=>[n(k,{icon:["fas","trash"],class:"h-4 w-4","aria-hidden":"true"})]),default:a(()=>[s(" "+o(e(t)("common.delete")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel"])}}}),ie={key:0},se={key:1},re=I({__name:"DeleteConntrackRecordModal",props:{visible:{type:Boolean},itemToDelete:{}},emits:["close","record-deleted"],setup(B,{emit:D}){const{t}=P(),_=B,p=D,i=g({notificationDescription:"",notificationDetails:""}),d=g(!1);async function b(){i.value={notificationDescription:"",notificationDetails:""},d.value=!0;try{_.itemToDelete!==void 0?await N("ns.conntrack","drop",{id:_.itemToDelete.id}):await N("ns.conntrack","drop_all",{}),p("record-deleted")}catch(r){i.value.notificationDescription=t(q(r)),i.value.notificationDetails=r.toString()}finally{d.value=!1}}function y(){i.value={notificationDescription:"",notificationDetails:""},p("close")}return(r,k)=>(c(),v(e(O),{visible:r.visible,kind:"warning",title:e(t)("standalone.conntrack.delete_conntrack_record"),primaryLabel:e(t)("common.delete"),secondaryLabel:e(t)("common.cancel"),primaryButtonKind:"danger",secondaryButtonKind:"tertiary",primaryButtonDisabled:d.value,primaryButtonLoading:d.value,"close-aria-label":e(t)("common.close"),onPrimaryClick:k[0]||(k[0]=l=>b()),onClose:k[1]||(k[1]=l=>y()),onSecondaryClick:k[2]||(k[2]=l=>y())},{default:a(()=>{var l,S,z,x;return[r.itemToDelete!==void 0?(c(),T("span",ie,o(e(t)("standalone.conntrack.delete_conntrack_record_message",{source:((l=r.itemToDelete)==null?void 0:l.destination)+":"+((S=r.itemToDelete)==null?void 0:S.destination_port)||"",destination:((z=r.itemToDelete)==null?void 0:z.source)+":"+((x=r.itemToDelete)==null?void 0:x.source_port)||""})),1)):(c(),T("span",se,o(e(t)("standalone.conntrack.delete_all_record_message")),1)),i.value.notificationDescription?(c(),v(e(A),{key:2,kind:"error",title:e(t)("error.cannot_delete_conntrack_record"),description:i.value.notificationDescription},K({_:2},[i.value.notificationDetails?{name:"details",fn:a(()=>[s(o(i.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):V("",!0)]}),_:1},8,["visible","title","primaryLabel","secondaryLabel","primaryButtonDisabled","primaryButtonLoading","close-aria-label"]))}}),ce={class:"flex flex-col gap-y-6"},de={class:"mb-4 flex flex-row justify-between"},ue={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},fe={class:"shrink-0"},_e={class:"flex items-center gap-4"},pe=I({__name:"ConntrackContent",setup(B){const D=X(),{t}=P(),_=g(!1),p=g([]),i=g({notificationDescription:"",notificationDetails:"",notificationTitle:""}),d=g(""),b=g(!1);Z(()=>{r()});const y=g();async function r(){i.value.notificationDescription="",i.value.notificationDetails="";try{_.value=!0,p.value=(await N("ns.conntrack","list")).data.data}catch(w){i.value.notificationDescription=t(q(w)),i.value.notificationDetails=w.toString()}finally{_.value=!1}}function k(w,u){const m=u.toLowerCase();return w.filter(f=>f.source.toLowerCase().includes(m)||f.destination.toLowerCase().includes(m)||f.protocol.toLowerCase().includes(m)||(f.state??"").toLowerCase().includes(m)||(f.source_port??"").toLowerCase().includes(m)||(f.destination_port??"").toLowerCase().includes(m))}function l(){y.value=void 0,b.value=!0}function S(w){y.value=w,b.value=!0}function z(){b.value=!1}const x=ee(()=>d.value===""?p.value:k(p.value,d.value));function H(){y.value?setTimeout(()=>{D.createNotification({title:t("standalone.conntrack.conntrack_record_removed"),kind:"success"})},500):setTimeout(()=>{D.createNotification({title:t("standalone.conntrack.conntrack_record_all_removed"),kind:"success"})},500),z(),r()}return(w,u)=>{const m=j("FontAwesomeIcon");return c(),T(M,null,[n(e(te),{tag:"h3",class:"mb-7"},{default:a(()=>[s(o(e(t)("standalone.conntrack.title")),1)]),_:1}),L("div",ce,[L("div",de,[L("p",ue,o(e(t)("standalone.conntrack.conntrack_description")),1),L("div",fe,[p.value.length>0?(c(),v(e($),{key:0,kind:"tertiary",size:"lg",onClick:u[0]||(u[0]=f=>l()),class:"ml-4 shrink-0"},{prefix:a(()=>[n(m,{icon:["fas","trash"],"aria-hidden":"true"})]),default:a(()=>[s(" "+o(e(t)("standalone.conntrack.delete_all")),1)]),_:1})):V("",!0),n(e($),{kind:"secondary",size:"lg",onClick:u[1]||(u[1]=f=>r()),class:"ml-2 shrink-0"},{prefix:a(()=>[n(m,{icon:["fas","fa-refresh"],"aria-hidden":"true"})]),default:a(()=>[s(" "+o(e(t)("standalone.conntrack.refresh_page")),1)]),_:1})])]),L("div",_e,[n(e(ae),{class:"max-w-xs",placeholder:e(t)("common.filter"),modelValue:d.value,"onUpdate:modelValue":u[2]||(u[2]=f=>d.value=f)},null,8,["placeholder","modelValue"]),n(e($),{kind:"tertiary",onClick:u[3]||(u[3]=f=>d.value=""),disabled:_.value||!d.value},{default:a(()=>[s(o(e(t)("common.clear_filter")),1)]),_:1},8,["disabled"])]),i.value.notificationDescription?(c(),v(e(A),{key:0,kind:"error",title:i.value.notificationTitle,description:i.value.notificationDescription},K({_:2},[i.value.notificationDetails?{name:"details",fn:a(()=>[s(o(i.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):V("",!0),_.value?(c(),v(e(ne),{key:1,lines:10,size:"lg"})):(c(),T(M,{key:2},[p.value.length==0?(c(),v(e(F),{key:0,title:e(t)("standalone.conntrack.no_connection_found"),icon:["fas","chain"]},{default:a(()=>[n(e($),{kind:"tertiary",onClick:r},{prefix:a(()=>[n(m,{icon:["fas","fa-refresh"],"aria-hidden":"true"})]),default:a(()=>[s(o(e(t)("standalone.conntrack.refresh_page")),1)]),_:1})]),_:1},8,["title"])):x.value.length==0?(c(),v(e(F),{key:1,title:e(t)("standalone.conntrack.no_connection_found"),description:e(t)("standalone.conntrack.filter_change_suggestion"),icon:["fas","chain"]},{default:a(()=>[n(e($),{kind:"tertiary",onClick:u[4]||(u[4]=f=>d.value="")},{default:a(()=>[s(o(e(t)("common.clear_filter")),1)]),_:1})]),_:1},8,["title","description"])):V("",!0),x.value.length>0?(c(),v(le,{key:2,"conntrack-records":x.value,onDelete:S},null,8,["conntrack-records"])):V("",!0)],64))]),n(re,{visible:b.value,onClose:z,onRecordDeleted:H,"item-to-delete":y.value},null,8,["visible","item-to-delete"])],64)}}}),me=I({__name:"ConntrackView",setup(B){return(D,t)=>(c(),T("div",null,[n(pe)]))}});export{me as default};
