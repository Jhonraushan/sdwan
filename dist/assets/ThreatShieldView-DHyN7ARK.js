import{d as N,u as z,r,h as c,i as y,w as s,m as D,t as g,l as e,L as U,M as P,n as L,Y as ue,e as F,V as M,aa as ae,J as ce,j as w,k as l,Q as W,s as R,_ as I,ai as ve,ag as _e,S as be,bW as fe,aI as me,g as j,aK as pe,ak as he,al as Z,am as ge,q as C,z as A,ad as ke,an as ye,ao as ee,ap as we,aq as De,U as J,ac as le,o as Q,y as G,aj as Y,a as Se,c as te,B as xe,v as Ve,a5 as K,a0 as Te,W as Le,a9 as $e}from"./index-BlEQ5104.js";import{u as Ce}from"./useTabs-BeLQ169O.js";import{_ as Ee}from"./BlocklistTable.vue_vue_type_script_setup_true_lang-DVIfmwgd.js";import{_ as q}from"./FormLayout.vue_vue_type_script_setup_true_lang-DaMAl8E3.js";import{_ as Ae}from"./NeMultiTextInput.vue_vue_type_script_setup_true_lang-DwfeP71-.js";import"./isArrayLikeObject-CpCvCe5A.js";const se=N({__name:"DeleteAddressModal",props:{visible:{type:Boolean},itemToDelete:{},addressKind:{}},emits:["close","address-deleted"],setup(B,{emit:t}){const _=B,o=t,{t:i}=z(),v=r({notificationDescription:"",notificationDetails:""}),u=r(!1);async function h(){if(_.itemToDelete){v.value.notificationDescription="",v.value.notificationDetails="",u.value=!0;const b=_.addressKind==="block"?"delete-blocked":"delete-allowed";try{await F("ns.threatshield",b,{address:_.itemToDelete.address}),o("address-deleted"),f()}catch(m){v.value.notificationDescription=i(M(m)),v.value.notificationDetails=m.toString()}finally{u.value=!1}}}function f(){v.value.notificationDescription="",v.value.notificationDetails="",o("close")}return(b,m)=>(c(),y(e(ue),{visible:b.visible,kind:"warning",primaryButtonKind:"danger",title:e(i)("standalone.threat_shield.delete_address"),primaryLabel:e(i)("common.delete"),primaryButtonDisabled:u.value,primaryButtonLoading:u.value,"close-aria-label":e(i)("common.close"),onPrimaryClick:m[0]||(m[0]=S=>h()),onClose:m[1]||(m[1]=S=>f())},{default:s(()=>{var S;return[D(g(e(i)("standalone.threat_shield.delete_address_message",{address:((S=b.itemToDelete)==null?void 0:S.address)??""}))+" ",1),v.value.notificationDescription?(c(),y(e(U),{key:0,kind:"error",title:e(i)("error.cannot_delete_address"),description:v.value.notificationDescription,class:"my-2"},P({_:2},[v.value.notificationDetails?{name:"details",fn:s(()=>[D(g(v.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0)]}),_:1},8,["visible","title","primaryLabel","primaryButtonDisabled","primaryButtonLoading","close-aria-label"]))}}),Be={class:"flex flex-col gap-y-6"},Ke={class:"flex justify-end"},ie=N({__name:"CreateOrEditAddressDrawer",props:{isShown:{type:Boolean},itemToEdit:{},addressKind:{}},emits:["close","add-address","edit-address"],setup(B,{emit:t}){const _=B,{t:o}=z(),i=t,v=r(!1),u=r({notificationTitle:"",notificationDescription:"",notificationDetails:""}),h=r(new ae),f=r(""),b=r("");async function m(){var p,d;f.value=((p=_.itemToEdit)==null?void 0:p.address)??"",b.value=((d=_.itemToEdit)==null?void 0:d.description)??""}function S(){const p=be(f.value),d=fe(f.value);return p.valid?d.valid?!0:(h.value.set("address",d.errMessage),!1):(h.value.set("address",p.errMessage),!1)}async function V(){u.value.notificationTitle="",u.value.notificationDescription="",u.value.notificationDetails="";const p=!!_.itemToEdit;let d="";if(_.addressKind=="block"?d=p?"edit-blocked":"add-blocked":d=p?"edit-allowed":"add-allowed",!!S()){v.value=!0;try{await F("ns.threatshield",d,{address:f.value,description:b.value}),v.value=!1,i(p?"edit-address":"add-address"),T()}catch(a){a instanceof _e?h.value=a.errorBag:(u.value.notificationTitle=o(p?"error.cannot_edit_address":"error.cannot_create_address"),u.value.notificationDescription=o(M(a)),u.value.notificationDetails=a.toString()),v.value=!1;return}}}function T(){v.value||(h.value.clear(),u.value.notificationTitle="",u.value.notificationDescription="",u.value.notificationDetails="",i("close"))}return ce(()=>_.isShown,()=>{_.isShown&&m()}),(p,d)=>(c(),y(e(ve),{"is-shown":p.isShown,onClose:d[4]||(d[4]=a=>T()),closeAriaLabel:e(o)("common.shell.close_side_drawer"),title:p.itemToEdit?e(o)("standalone.threat_shield.edit_address"):e(o)("standalone.threat_shield.add_address")},{default:s(()=>[u.value.notificationTitle?(c(),y(e(U),{key:0,title:u.value.notificationTitle,description:u.value.notificationDescription,class:"mb-6",kind:"error"},P({_:2},[u.value.notificationDetails?{name:"details",fn:s(()=>[D(g(u.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0),w("div",Be,[l(e(W),{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=a=>f.value=a),label:p.addressKind=="block"?e(o)("standalone.threat_shield.blocked_address"):e(o)("standalone.threat_shield.allowed_address"),"invalid-message":e(o)(h.value.getFirstI18nKeyFor("address")),disabled:!!p.itemToEdit},{tooltip:s(()=>[l(e(R),null,{content:s(()=>[D(g(e(o)("standalone.threat_shield.address_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","invalid-message","disabled"]),l(e(W),{modelValue:b.value,"onUpdate:modelValue":d[1]||(d[1]=a=>b.value=a),label:e(o)("standalone.threat_shield.description"),"invalid-message":e(o)(h.value.getFirstI18nKeyFor("description")),optional:!0,"optional-label":e(o)("common.optional")},null,8,["modelValue","label","invalid-message","optional-label"]),d[5]||(d[5]=w("hr",null,null,-1)),w("div",Ke,[l(e(I),{kind:"tertiary",class:"mr-4",onClick:d[2]||(d[2]=a=>T())},{default:s(()=>[D(g(e(o)("common.cancel")),1)]),_:1}),l(e(I),{kind:"primary",onClick:d[3]||(d[3]=a=>V()),disabled:v.value,loading:v.value},{default:s(()=>[D(g(p.itemToEdit?e(o)("common.save"):e(o)("standalone.threat_shield.add_address")),1)]),_:1},8,["disabled","loading"])])])]),_:1},8,["is-shown","closeAriaLabel","title"]))}}),Fe={class:"-ml-2.5 flex gap-2 md:justify-end xl:ml-0"},ne=N({__name:"AddressTable",props:{addressList:{},addressKind:{}},emits:["delete","edit"],setup(B,{emit:t}){const{t:_}=z(),o=B,i=r(10),{currentPage:v,paginatedItems:u}=me(()=>o.addressList,{itemsPerPage:i}),h=t;function f(b){return[{id:"delete",label:_("common.delete"),iconStyle:"fas",icon:"trash",danger:!0,action:()=>{h("delete",b)}}]}return(b,m)=>{const S=j("font-awesome-icon");return c(),y(e(De),{ariaLabel:b.addressKind=="block"?e(_)("standalone.threat_shield.blocked_addresses"):e(_)("standalone.threat_shield.allowed_addresses"),class:"z-10"},{paginator:s(()=>[l(e(pe),{"current-page":e(v),"total-rows":o.addressList.length,"page-size":i.value,"nav-pagination-label":e(_)("ne_table.pagination"),"next-label":e(_)("ne_table.go_to_next_page"),"previous-label":e(_)("ne_table.go_to_previous_page"),"range-of-total-label":e(_)("ne_table.of"),"page-size-label":e(_)("ne_table.show"),onSelectPage:m[0]||(m[0]=V=>{v.value=V}),onSelectPageSize:m[1]||(m[1]=V=>{i.value=V})},null,8,["current-page","total-rows","page-size","nav-pagination-label","next-label","previous-label","range-of-total-label","page-size-label"])]),default:s(()=>[l(e(he),null,{default:s(()=>[l(e(Z),null,{default:s(()=>[D(g(b.addressKind=="block"?e(_)("standalone.threat_shield.blocked_address"):e(_)("standalone.threat_shield.allowed_address")),1)]),_:1}),l(e(Z),null,{default:s(()=>[D(g(e(_)("standalone.threat_shield.description")),1)]),_:1}),l(e(Z))]),_:1}),l(e(ge),null,{default:s(()=>[(c(!0),C(A,null,ke(e(u),(V,T)=>(c(),y(e(ye),{key:T},{default:s(()=>[l(e(ee),{"data-label":b.addressKind=="block"?e(_)("standalone.threat_shield.blocked_address"):e(_)("standalone.threat_shield.allowed_address")},{default:s(()=>[D(g(V.address),1)]),_:2},1032,["data-label"]),l(e(ee),{"data-label":e(_)("standalone.threat_shield.description")},{default:s(()=>[D(g(V.description?V.description:"-"),1)]),_:2},1032,["data-label"]),l(e(ee),{"data-label":e(_)("common.actions")},{default:s(()=>[w("div",Fe,[l(e(I),{kind:"tertiary",onClick:p=>h("edit",V)},{prefix:s(()=>[l(S,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(" "+g(e(_)("common.edit")),1)]),_:2},1032,["onClick"]),l(e(we),{items:f(V),"align-to-right":!0},null,8,["items"])])]),_:2},1032,["data-label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["ariaLabel"])}}}),Ie={class:"flex flex-col gap-y-6"},Ue={class:"flex flex-row items-center justify-between"},Me={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},Ne=N({__name:"AllowlistTab",setup(B){const{t}=z(),_=J(),o=le(),i=r({notificationDescription:"",notificationDetails:""}),v=r(!1),u=r([]),h=r(),f=r(!1),b=r(!1),m=r(!1);function S(d){h.value=d,m.value=!0}function V(d){h.value=d,b.value=!0}async function T(){i.value.notificationDescription="",i.value.notificationDetails="",v.value=!1;try{f.value=!0,u.value=(await F("ns.threatshield","list-allowed")).data.data}catch(d){i.value.notificationDescription=t(M(d)),i.value.notificationDetails=d.toString(),v.value=!0}finally{f.value=!1}}async function p(){await _.getChanges(),T()}return Q(()=>{T()}),(d,a)=>{const k=j("font-awesome-icon");return c(),C(A,null,[w("div",Ie,[w("div",Ue,[w("p",Me,g(e(t)("standalone.threat_shield.allowlist_description")),1),u.value.length>0?(c(),y(e(I),{key:0,kind:"secondary",onClick:a[0]||(a[0]=$=>S())},{prefix:s(()=>[l(k,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(g(e(t)("standalone.threat_shield.add_address")),1)]),_:1})):L("",!0)]),i.value.notificationDescription?(c(),y(e(U),{key:0,title:e(t)("error.cannot_retrieve_allowlist"),description:i.value.notificationDescription,class:"mb-6",kind:"error"},P({_:2},[i.value.notificationDetails?{name:"details",fn:s(()=>[D(g(i.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0),f.value?(c(),y(e(G),{key:1,lines:6,size:"lg"})):v.value?L("",!0):(c(),C(A,{key:2},[u.value.length==0?(c(),y(e(Y),{key:0,title:e(t)("standalone.threat_shield.allowlist_is_empty"),icon:["fas","shield"]},{default:s(()=>[l(e(I),{kind:"secondary",onClick:a[1]||(a[1]=$=>S())},{prefix:s(()=>[l(k,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(g(e(t)("standalone.threat_shield.add_address")),1)]),_:1})]),_:1},8,["title"])):(c(),y(ne,{key:1,addressList:u.value,addressKind:"allow",onDelete:V,onEdit:S},null,8,["addressList"]))],64))]),l(se,{visible:b.value,"item-to-delete":h.value,addressKind:"allow",onAddressDeleted:a[2]||(a[2]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_deleted")}),p()}),onClose:a[3]||(a[3]=$=>b.value=!1)},null,8,["visible","item-to-delete"]),l(ie,{"is-shown":m.value,"item-to-edit":h.value,addressKind:"allow",onClose:a[4]||(a[4]=$=>m.value=!1),onAddAddress:a[5]||(a[5]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_added")}),p()}),onEditAddress:a[6]||(a[6]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_edited")}),p()})},null,8,["is-shown","item-to-edit"])],64)}}}),ze={key:1,class:"flex flex-col gap-y-6"},Pe={class:"flex flex-row items-start justify-between"},Oe={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},je={key:0,class:"mt-2 flex flex-row gap-x-2"},qe=N({__name:"BlocklistTab",setup(B){const{t}=z(),_=J(),o=Se(),i=r({notificationTitle:"",notificationDescription:"",notificationDetails:""}),v=r(!1),u=r(!0),h=r(!1),f=r([]),b=r(""),m=r(!1),S=te(()=>b.value?f.value.filter(a=>a.name.includes(b.value)||a.description.includes(b.value)||a.type.includes(b.value)):f.value),V=te(()=>f.value.some(a=>a.type==="enterprise"));function T(){i.value={notificationTitle:"",notificationDescription:"",notificationDetails:""}}async function p(){T(),v.value=!1;try{u.value=!0,f.value=(await F("ns.threatshield","list-blocklist")).data.data,m.value=(await F("ns.threatshield","list-settings")).data.data.enabled}catch(a){i.value.notificationTitle=t("error.cannot_retrieve_blocklists"),i.value.notificationDescription=t(M(a)),i.value.notificationDetails=a.toString(),v.value=!0}finally{u.value=!1}}async function d(a){T();try{h.value=!0,await F("ns.threatshield","edit-blocklist",{blocklist:a.name,enabled:a.enabled}),await _.getChanges()}catch(k){i.value.notificationTitle=a.enabled?t("error.cannot_enable_blocklist"):t("error.cannot_disable_blocklist"),i.value.notificationDescription=t(M(k)),i.value.notificationDetails=k.toString();let $=f.value[f.value.findIndex(O=>O.name===a.name)];$.enabled=!$.enabled}finally{h.value=!1}}return Q(()=>{p()}),(a,k)=>{const $=j("FontAwesomeIcon"),O=j("font-awesome-icon");return u.value?(c(),y(e(G),{key:0,lines:8,size:"lg"})):(c(),C("div",ze,[i.value.notificationTitle?(c(),y(e(U),{key:0,kind:"error",title:i.value.notificationTitle,description:i.value.notificationDescription,class:"my-2"},P({_:2},[i.value.notificationDetails?{name:"details",fn:s(()=>[D(g(i.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0),v.value?L("",!0):(c(),C(A,{key:1},[w("div",Pe,[w("div",null,[w("p",Oe,g(e(t)("standalone.threat_shield.blocklist_description")),1),V.value?(c(),C("div",je,[l($,{icon:["fas","circle-info"],class:"h-4 w-4 text-indigo-500 dark:text-indigo-300"}),w("p",null,g(e(t)("standalone.threat_shield.blocklist_subscription_description")),1)])):L("",!0)]),m.value?(c(),y(e(xe),{key:0,icon:["fas","check"],text:e(t)("standalone.threat_shield.threat_shield_enabled"),kind:"success"},null,8,["text"])):L("",!0)]),m.value?(c(),C(A,{key:1},[l(e(W),{class:"max-w-xs sm:max-w-sm",placeholder:e(t)("standalone.threat_shield.filter_blocklists"),modelValue:b.value,"onUpdate:modelValue":k[1]||(k[1]=H=>b.value=H),"is-search":""},null,8,["placeholder","modelValue"]),S.value.length>0?(c(),y(Ee,{key:0,blocklists:S.value,"disable-toggles":h.value,kind:"ip",onToggleBlocklist:d},null,8,["blocklists","disable-toggles"])):(c(),y(e(Y),{key:1,title:e(t)("standalone.threat_shield.no_blacklists_found"),icon:["fas","shield"]},null,8,["title"]))],64)):(c(),y(e(Y),{key:0,title:e(t)("standalone.threat_shield.threat_shield_disabled"),icon:["fas","shield"],class:"pb-8"},{default:s(()=>[l(e(I),{kind:"primary",onClick:k[0]||(k[0]=()=>{e(o).push(`${e(Ve)()}/security/threat-shield-ip?tab=settings`)})},{prefix:s(()=>[l(O,{icon:["fas","arrow-right"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(g(e(t)("standalone.threat_shield.go_to_settings")),1)]),_:1})]),_:1},8,["title"]))],64))]))}}}),Re={key:1,class:"max-w-4xl"},We={class:"space-y-8"},Ye={class:"mb-8 space-y-6"},Je={class:"mb-8 space-y-6"},Qe={class:"mb-8 space-y-6"},Ge={class:"mb-8 space-y-6"},He=N({__name:"SettingsTab",setup(B){const{t}=z(),_=J(),o=r(!1),i=r(!1),v=r(!1),u=r(!1),h=r(!1),f=r(!1),b=r(""),m=r(""),S=r([""]),V=r(!1),T=r(!1),p=r(!1),d=r(new ae),a=r({listSettings:!1,editSettings:!1}),k=r({listSettings:"",listSettingsDetails:"",editSettings:"",editSettingsDetails:""}),$=r([{id:"10m",label:t("standalone.threat_shield.ten_minutes")},{id:"30m",label:t("standalone.threat_shield.thirty_minutes")},{id:"1h",label:t("standalone.threat_shield.one_hour")},{id:"6h",label:t("standalone.threat_shield.six_hours")},{id:"12h",label:t("standalone.threat_shield.twelve_hours")},{id:"1d",label:t("standalone.threat_shield.one_day")},{id:"3d",label:t("standalone.threat_shield.three_days")}]);async function O(){try{a.value.listSettings=!0;const n=(await F("ns.threatshield","list-settings")).data.data;o.value=n.enabled,i.value=n.ban_logprerouting,v.value=n.ban_loginput,u.value=n.ban_logforwardwan,h.value=n.ban_logforwardlan,f.value=n.ban_loglimit,b.value=n.ban_nftexpiry,m.value=n.ban_logcount.toString(),S.value=n.ban_logterm,V.value=n.ban_icmplimit,T.value=n.ban_synlimit,p.value=n.ban_udplimit}catch(E){k.value.listSettings=t(M(E)),k.value.listSettingsDetails=E.toString()}finally{a.value.listSettings=!1}}async function H(){await _.getChanges(),await O()}function oe(){k.value.listSettings="",k.value.listSettingsDetails="",k.value.editSettings="",k.value.editSettingsDetails=""}function de(){oe(),d.value.clear();let E=!0;return f.value&&((isNaN(Number(m.value))||Number(m.value)<1)&&(d.value.set("maxFailedAccess",[t("standalone.threat_shield.enter_a_number_greater_than_0")]),E&&(E=!1)),(S.value.length===0||!S.value[0])&&(d.value.set("attackPatterns",[t("error.required")]),E&&(E=!1))),E}async function re(){if(de())try{a.value.editSettings=!0;const n=S.value.filter(X=>X);await F("ns.threatshield","edit-settings",{enabled:o.value,ban_logprerouting:i.value,ban_loginput:v.value,ban_logforwardwan:u.value,ban_logforwardlan:h.value,ban_loglimit:f.value,ban_nftexpiry:b.value,ban_logcount:Number(m.value),ban_logterm:n,ban_icmplimit:V.value,ban_synlimit:T.value,ban_udplimit:p.value}),H()}catch(n){k.value.editSettings=t(M(n)),k.value.editSettingsDetails=n.toString()}finally{a.value.editSettings=!1}}return Q(()=>{O()}),(E,n)=>{const X=j("font-awesome-icon");return a.value.listSettings?(c(),y(e(G),{key:0,lines:6,size:"lg"})):(c(),C("div",Re,[w("div",We,[k.value.listSettings?(c(),y(e(U),{key:0,kind:"error",title:e(t)("error.cannot_retrieve_threat_shield_settings"),description:k.value.listSettings},P({_:2},[k.value.listSettingsDetails?{name:"details",fn:s(()=>[D(g(k.value.listSettingsDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):(c(),C(A,{key:1},[w("div",null,[l(q,{title:e(t)("standalone.threat_shield.threat_shield_status"),description:e(t)("standalone.threat_shield.threat_shield_status_description")},{default:s(()=>[l(e(K),{"top-label":e(t)("standalone.threat_shield.status"),label:o.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=x=>o.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"])]),_:1},8,["title","description"]),n[13]||(n[13]=w("hr",null,null,-1))]),o.value?(c(),C(A,{key:0},[w("div",null,[l(q,{title:e(t)("standalone.threat_shield.logging"),description:e(t)("standalone.threat_shield.logging_description")},{default:s(()=>[w("div",Ye,[!i.value&&!v.value&&!u.value&&!h.value?(c(),y(e(U),{key:0,kind:"warning",title:e(t)("standalone.threat_shield.threats_monitoring_disabled"),description:e(t)("standalone.threat_shield.threats_monitoring_disabled_message"),closeAriaLabel:e(t)("common.close")},null,8,["title","description","closeAriaLabel"])):L("",!0),l(e(K),{"top-label":e(t)("standalone.threat_shield.log_prerouting_chain"),label:i.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=x=>i.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"]),l(e(K),{"top-label":e(t)("standalone.threat_shield.log_input_chain"),label:v.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:v.value,"onUpdate:modelValue":n[2]||(n[2]=x=>v.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"]),l(e(K),{"top-label":e(t)("standalone.threat_shield.log_forward_chain"),label:u.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=x=>u.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"]),l(e(K),{"top-label":e(t)("standalone.threat_shield.log_forward_lan_chain"),label:h.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:h.value,"onUpdate:modelValue":n[4]||(n[4]=x=>h.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"])])]),_:1},8,["title","description"]),n[14]||(n[14]=w("hr",null,null,-1))]),w("div",null,[l(q,{title:e(t)("standalone.threat_shield.block_brute_force"),description:e(t)("standalone.threat_shield.block_brute_force_description")},{default:s(()=>[w("div",Je,[l(e(K),{"top-label":e(t)("standalone.threat_shield.block_brute_force"),label:f.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:f.value,"onUpdate:modelValue":n[5]||(n[5]=x=>f.value=x),disabled:a.value.editSettings},{topTooltip:s(()=>[l(e(R),null,{content:s(()=>[D(g(e(t)("standalone.threat_shield.block_brute_force_tooltip")),1)]),_:1})]),_:1},8,["top-label","label","modelValue","disabled"]),f.value?(c(),C(A,{key:0},[l(e(W),{label:e(t)("standalone.threat_shield.ban_after_n_attempts"),modelValue:m.value,"onUpdate:modelValue":n[6]||(n[6]=x=>m.value=x),modelModifiers:{number:!0},type:"number",min:"1",max:"100",disabled:a.value.editSettings,invalidMessage:d.value.getFirstFor("maxFailedAccess")},{tooltip:s(()=>[l(e(R),null,{content:s(()=>[D(g(e(t)("standalone.threat_shield.ban_after_n_attempts_tooltip")),1)]),_:1})]),_:1},8,["label","modelValue","disabled","invalidMessage"]),l(e(Te),{modelValue:b.value,"onUpdate:modelValue":n[7]||(n[7]=x=>b.value=x),disabled:a.value.editSettings,label:e(t)("standalone.threat_shield.ban_time"),options:$.value,placeholder:e(t)("ne_combobox.choose"),optionalLabel:e(t)("common.optional"),noResultsLabel:e(t)("ne_combobox.no_results"),limitedOptionsLabel:e(t)("ne_combobox.limited_options_label"),noOptionsLabel:e(t)("ne_combobox.no_options_label"),"selected-label":e(t)("ne_combobox.selected"),userInputLabel:e(t)("ne_combobox.user_input_label")},{tooltip:s(()=>[l(e(R),null,{content:s(()=>[D(g(e(t)("standalone.threat_shield.ban_time_tooltip")),1)]),_:1})]),_:1},8,["modelValue","disabled","label","options","placeholder","optionalLabel","noResultsLabel","limitedOptionsLabel","noOptionsLabel","selected-label","userInputLabel"]),l(Ae,{modelValue:S.value,"onUpdate:modelValue":n[8]||(n[8]=x=>S.value=x),"add-item-label":e(t)("standalone.threat_shield.add_pattern"),title:e(t)("standalone.threat_shield.attack_patterns"),required:"",disabledInputs:a.value.editSettings,generalInvalidMessage:d.value.getFirstFor("attackPatterns")},{tooltip:s(()=>[l(e(R),null,{content:s(()=>[D(g(e(t)("standalone.threat_shield.attack_patterns_tooltip")),1)]),_:1})]),_:1},8,["modelValue","add-item-label","title","disabledInputs","generalInvalidMessage"])],64)):L("",!0)])]),_:1},8,["title","description"]),n[15]||(n[15]=w("hr",null,null,-1))]),w("div",null,[l(q,{title:e(t)("standalone.threat_shield.block_dos"),description:e(t)("standalone.threat_shield.block_dos_description")},{default:s(()=>[w("div",Qe,[l(e(K),{"top-label":e(t)("standalone.threat_shield.block_icmp_dos"),label:V.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:V.value,"onUpdate:modelValue":n[9]||(n[9]=x=>V.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"]),l(e(K),{"top-label":e(t)("standalone.threat_shield.block_syn_dos"),label:T.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:T.value,"onUpdate:modelValue":n[10]||(n[10]=x=>T.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"]),l(e(K),{"top-label":e(t)("standalone.threat_shield.block_udp_dos"),label:p.value?e(t)("common.enabled"):e(t)("common.disabled"),modelValue:p.value,"onUpdate:modelValue":n[11]||(n[11]=x=>p.value=x),disabled:a.value.editSettings},null,8,["top-label","label","modelValue","disabled"])])]),_:1},8,["title","description"]),n[16]||(n[16]=w("hr",null,null,-1))])],64)):L("",!0),l(q,null,{default:s(()=>[w("div",Ge,[k.value.editSettings?(c(),y(e(U),{key:0,kind:"error",title:e(t)("error.cannot_save_threat_shield_settings"),description:k.value.editSettings},P({_:2},[k.value.editSettingsDetails?{name:"details",fn:s(()=>[D(g(k.value.editSettingsDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0),l(e(I),{kind:"primary",disabled:a.value.editSettings,loading:a.value.editSettings,onClick:n[12]||(n[12]=x=>re())},{prefix:s(()=>[l(X,{icon:["fas","floppy-disk"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(" "+g(e(t)("common.save")),1)]),_:1},8,["disabled","loading"])])]),_:1})],64))])]))}}}),Xe={class:"flex flex-col gap-y-6"},Ze={class:"flex flex-row items-center justify-between"},et={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},tt=N({__name:"LocalBlocklistTab",setup(B){const{t}=z(),_=J(),o=le(),i=r({notificationDescription:"",notificationDetails:""}),v=r(!1),u=r([]),h=r(),f=r(!1),b=r(!1),m=r(!1);function S(d){h.value=d,m.value=!0}function V(d){h.value=d,b.value=!0}async function T(){i.value.notificationDescription="",i.value.notificationDetails="",v.value=!1;try{f.value=!0,u.value=(await F("ns.threatshield","list-blocked")).data.data}catch(d){i.value.notificationDescription=t(M(d)),i.value.notificationDetails=d.toString(),v.value=!0}finally{f.value=!1}}async function p(){await _.getChanges(),T()}return Q(()=>{T()}),(d,a)=>{const k=j("font-awesome-icon");return c(),C(A,null,[w("div",Xe,[w("div",Ze,[w("p",et,g(e(t)("standalone.threat_shield.local_blocklist_description")),1),u.value.length>0?(c(),y(e(I),{key:0,kind:"secondary",onClick:a[0]||(a[0]=$=>S())},{prefix:s(()=>[l(k,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(g(e(t)("standalone.threat_shield.add_address")),1)]),_:1})):L("",!0)]),i.value.notificationDescription?(c(),y(e(U),{key:0,title:e(t)("error.cannot_retrieve_local_blocklist"),description:i.value.notificationDescription,class:"mb-6",kind:"error"},P({_:2},[i.value.notificationDetails?{name:"details",fn:s(()=>[D(g(i.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):L("",!0),f.value?(c(),y(e(G),{key:1,lines:6,size:"lg"})):v.value?L("",!0):(c(),C(A,{key:2},[u.value.length==0?(c(),y(e(Y),{key:0,title:e(t)("standalone.threat_shield.local_blocklist_is_empty"),icon:["fas","shield"]},{default:s(()=>[l(e(I),{kind:"secondary",onClick:a[1]||(a[1]=$=>S())},{prefix:s(()=>[l(k,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:s(()=>[D(g(e(t)("standalone.threat_shield.add_address")),1)]),_:1})]),_:1},8,["title"])):(c(),y(ne,{key:1,addressList:u.value,addressKind:"block",onDelete:V,onEdit:S},null,8,["addressList"]))],64))]),l(se,{visible:b.value,"item-to-delete":h.value,addressKind:"block",onAddressDeleted:a[2]||(a[2]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_deleted")}),p()}),onClose:a[3]||(a[3]=$=>b.value=!1)},null,8,["visible","item-to-delete"]),l(ie,{"is-shown":m.value,"item-to-edit":h.value,addressKind:"block",onClose:a[4]||(a[4]=$=>m.value=!1),onAddAddress:a[5]||(a[5]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_added")}),p()}),onEditAddress:a[6]||(a[6]=()=>{e(o).createNotification({kind:"success",title:e(t)("standalone.threat_shield.address_edited")}),p()})},null,8,["is-shown","item-to-edit"])],64)}}}),dt=N({__name:"ThreatShieldView",setup(B){const{t}=z(),{tabs:_,selectedTab:o}=Ce([{name:"blocklist",label:t("standalone.threat_shield.blocklist")},{name:"allowlist",label:t("standalone.threat_shield.allowlist")},{name:"localBlocklist",label:t("standalone.threat_shield.local_blocklist")},{name:"settings",label:t("standalone.threat_shield.settings")}]);return(i,v)=>(c(),C(A,null,[l(e(Le),{tag:"h3",class:"mb-7"},{default:s(()=>[D(g(e(t)("standalone.threat_shield.title")),1)]),_:1}),w("div",null,[l(e($e),{selected:e(o),srSelectTabLabel:e(t)("ne_tabs.select_a_tab"),srTabsLabel:e(t)("ne_tabs.tabs"),tabs:e(_),class:"mb-8",onSelectTab:v[0]||(v[0]=u=>o.value=u)},null,8,["selected","srSelectTabLabel","srTabsLabel","tabs"]),e(o)==="blocklist"?(c(),y(qe,{key:0})):L("",!0),e(o)==="allowlist"?(c(),y(Ne,{key:1})):L("",!0),e(o)==="localBlocklist"?(c(),y(tt,{key:2})):L("",!0),e(o)==="settings"?(c(),y(He,{key:3})):L("",!0)])],64))}});export{dt as default};
