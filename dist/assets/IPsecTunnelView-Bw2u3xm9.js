import{d as se,u as fe,g as Le,h as p,i as T,w as d,j as g,t as c,av as R,q as y,ad as ve,z as U,k as o,l as e,m as w,_ as le,ap as De,P as Ke,c0 as $e,n as ne,r as i,aa as Be,J as Pe,L as Oe,M as Me,y as Te,a1 as pe,a5 as me,Q as $,a0 as S,s as be,ar as je,W as _e,ai as qe,e as B,V as P,aP as we,S as L,a8 as He,bN as ze,bk as xe,U as Ge,o as We,b as Je,aj as Qe}from"./index-BlEQ5104.js";import{_ as Xe}from"./NeTable.vue_vue_type_script_setup_true_lang-BDPau7Vg.js";/* empty css                                                */import{_ as Ye}from"./DeleteTunnelModal.vue_vue_type_script_setup_true_lang-2XdVzv1U.js";import{_ as Ze}from"./NeMultiTextInput.vue_vue_type_script_setup_true_lang-DwfeP71-.js";import{_ as el}from"./NeCopyField.vue_vue_type_style_index_0_lang-D72fhwZm.js";import"./isArrayLikeObject-CpCvCe5A.js";const ll={class:"align-center flex justify-end"},nl=se({__name:"TunnelTable",props:{tunnels:{}},emits:["tunnel-delete","tunnel-edit","tunnel-toggle-enable"],setup(ae,{emit:b}){const{t:v}=fe(),l=b,F=[{label:v("standalone.ipsec_tunnel.name"),key:"name"},{label:v("standalone.ipsec_tunnel.local_networks"),key:"local_networks"},{label:v("standalone.ipsec_tunnel.remote_networks"),key:"remote_networks"},{label:v("standalone.ipsec_tunnel.status"),key:"status"},{label:v("standalone.ipsec_tunnel.connection"),key:"connection"},{label:"",key:"menu"}];function O(u){return[{id:"enable_disable",label:u.enabled==="1"?v("standalone.ipsec_tunnel.disable"):v("standalone.ipsec_tunnel.enable"),iconStyle:"fas",icon:u.enabled==="1"?"circle-xmark":"circle-check",action:()=>{l("tunnel-toggle-enable",u)}},{id:"delete",label:v("common.delete"),iconStyle:"fas",icon:"trash",danger:!0,action:()=>{l("tunnel-delete",u)}}]}function k(u){return u.enabled==="0"?["text-gray-400","dark:text-gray-700"]:[]}return(u,h)=>{const s=Le("font-awesome-icon");return p(),T(Xe,{data:u.tunnels,headers:F},{name:d(({item:r})=>[g("p",{class:R([...k(r)])},c(r.name),3)]),local_networks:d(({item:r})=>[r.local.length>0?(p(!0),y(U,{key:0},ve(r.local.slice(0,2),(x,V)=>(p(),y("p",{key:x,class:R([...k(r)])},c(x)+c(r.local.length>2&&V==1?"...":""),3))),128)):(p(),y("p",{key:1,class:R([...k(r)])},"-",2))]),remote_networks:d(({item:r})=>[r.remote.length>0?(p(!0),y(U,{key:0},ve(r.remote.slice(0,2),(x,V)=>(p(),y("p",{key:x,class:R([...k(r)])},c(x)+c(r.remote.length>2&&V==1?"...":""),3))),128)):(p(),y("p",{key:1,class:R([...k(r)])},"-",2))]),status:d(({item:r})=>[g("div",{class:R(["flex","flex-row","items-center",...k(r)])},[o(s,{icon:["fas",r.enabled==="1"?"circle-check":"circle-xmark"],class:"mr-2 h-5 w-5","aria-hidden":"true"},null,8,["icon"]),g("p",null,c(r.enabled==="1"?e(v)("standalone.ipsec_tunnel.enabled"):e(v)("standalone.ipsec_tunnel.disabled")),1)],2)]),connection:d(({item:r})=>[g("div",{class:R(["flex","flex-row","items-center",...k(r)])},[o(s,{icon:["fas",r.connected?"circle-check":"circle-xmark"],class:R(["mr-2","h-5","w-5",r.enabled==="0"?"text-gray-400 dark:text-gray-700":r.connected?"text-green-500":"text-rose-500"]),"aria-hidden":"true"},null,8,["icon","class"]),g("p",null,c(r.connected?e(v)("standalone.ipsec_tunnel.connected"):e(v)("standalone.ipsec_tunnel.not_connected")),1)],2)]),menu:d(({item:r})=>[g("div",ll,[o(e(le),{kind:"tertiary",onClick:x=>l("tunnel-edit",r)},{prefix:d(()=>[o(s,{icon:["fas","pen-to-square"],class:"h-4 w-4","aria-hidden":"true"})]),default:d(()=>[w(" "+c(e(v)("common.edit")),1)]),_:2},1032,["onClick"]),o(e(De),{items:O(r),"align-to-right":!0},null,8,["items"])])]),_:1},8,["data"])}}}),al={class:"mt-2 flex flex-row"},tl={key:0,class:"text-xs font-semibold text-primary-400"},ol=se({__name:"NeStepper",props:{totalSteps:{},currentStep:{},stepLabel:{}},setup(ae){return(b,v)=>(p(),y("div",null,[o(e(Ke),{progress:b.currentStep/b.totalSteps*100,size:"sm"},null,8,["progress"]),g("div",al,[(p(!0),y(U,null,ve(e($e)(1,b.totalSteps+1),l=>(p(),y("div",{key:l,class:"flex grow basis-0 justify-center"},[l==b.currentStep?(p(),y("p",tl,c(b.stepLabel)+" "+c(b.currentStep)+"/"+c(b.totalSteps),1)):ne("",!0)]))),128))])]))}}),il={key:2,class:"flex flex-col gap-y-6"},sl={class:"flex justify-end"},ul=se({__name:"CreateOrEditTunnelDrawer",props:{isShown:{type:Boolean},itemToEdit:{}},emits:["close","add-edit-tunnel"],setup(ae,{emit:b}){const v=ae,{t:l}=fe(),F=b,O=i(!1),k=i(!1),u=i({notificationTitle:"",notificationDescription:"",notificationDetails:""}),h=i(1),s=i(new Be),r=i([]),x=i([]),V=i(""),j=i(""),I=i(!0),N=i(""),E=i(""),f=i(""),_=i([]),C=i([""]),A=i(""),q=i(""),D=i("generate"),H=i(""),W=i(!1),J=i(!1),Q=i(""),X=i("aes256"),Y=i("sha256"),te=i("modp2048"),z=i("3600"),Z=i("aes256"),ee=i("sha256"),oe=i("modp2048"),G=i("3600"),ge=[{id:"ike",label:"IKEv1 & IKEv2"},{id:"ikev1",label:"IKEv1"},{id:"ikev2",label:"IKEv2"}],Fe=[{id:"generate",label:l("standalone.ipsec_tunnel.use_generated_key"),icon:"key"},{id:"import",label:l("standalone.ipsec_tunnel.use_custom_key"),icon:"circle-arrow-up"}],ye=i([]),ue=i([]),re=i([]),de=i([]);async function Ee(){try{const n=await B("ns.ipsectunnel","list-wans");ye.value=n.data.wans.map(t=>({id:t.ipaddr,description:t.device,label:t.ipaddr}))}catch(n){throw u.value.notificationTitle=l("error.cannot_retrieve_wan_list"),u.value.notificationDescription=l(P(n)),u.value.notificationDetails=n.toString(),n}try{const n=await B("ns.ipsectunnel","list-algs");ue.value=n.data.encryption.map(t=>({id:t.id,label:t.name})),re.value=n.data.integrity.map(t=>({id:t.id,label:t.name})),de.value=n.data.dh.map(t=>({id:t.id,label:t.name=="-"?l("standalone.ipsec_tunnel.pfs_perfect_forward_secrecy_disabled"):t.name}))}catch(n){throw u.value.notificationTitle=l("error.cannot_retrieve_ipsec_algorithms"),u.value.notificationDescription=l(P(n)),u.value.notificationDetails=n.toString(),n}}async function Se(){var t;h.value=1;let n=null;if(v.itemToEdit)try{n=(await B("ns.ipsectunnel","get-tunnel",{id:v.itemToEdit.id})).data,A.value=n.local_identifier,q.value=n.remote_identifier,H.value=n.pre_shared_key,D.value="import";const a=n==null?void 0:n.local_subnet.map(m=>({id:m,label:m}));_.value=[...a],x.value=[...a]}catch(a){throw u.value.notificationTitle=l("error.cannot_retrieve_tunnel_data"),u.value.notificationDescription=l(P(a)),u.value.notificationDetails=a.toString(),a}else try{const a=await B("ns.ipsectunnel","get-defaults");A.value=a.data.local_identifier,q.value=a.data.remote_identifier,j.value=a.data.pre_shared_key,D.value="generate",H.value="";const m=a.data.local_networks.map(K=>({id:K,label:K}));x.value=[...m],_.value=[...m]}catch(a){throw u.value.notificationTitle=l("error.cannot_retrieve_tunnel_defaults"),u.value.notificationDescription=l(P(a)),u.value.notificationDetails=a.toString(),a}V.value=((t=v.itemToEdit)==null?void 0:t.id)??"",N.value=(n==null?void 0:n.ns_name)??"",I.value=n?n.enabled==="1":!0,E.value=(n==null?void 0:n.local_ip)??"",f.value=(n==null?void 0:n.gateway)??"",C.value=(n==null?void 0:n.remote_subnet)??[""],W.value=n?n.dpdaction=="restart":!1,J.value=n?n.ipcomp==="true":!1,Q.value=(n==null?void 0:n.keyexchange)??ge[0].id,X.value=(n==null?void 0:n.ike.encryption_algorithm)??"aes256",Y.value=(n==null?void 0:n.ike.hash_algorithm)??"sha256",te.value=(n==null?void 0:n.ike.dh_group)??"modp2048",z.value=(n==null?void 0:n.ike.rekeytime)??"3600",Z.value=(n==null?void 0:n.esp.encryption_algorithm)??"aes256",ee.value=(n==null?void 0:n.esp.hash_algorithm)??"sha256",oe.value=(n==null?void 0:n.esp.dh_group)??"modp2048",G.value=(n==null?void 0:n.esp.rekeytime)??"3600"}function ke(n,t){for(let a of n)a.valid||s.value.set(t,[l(a.errMessage)]);return n.every(a=>a.valid)}function Ie(n,t){let a=[],m=!0;if(n.forEach(()=>{a.push("")}),n.length==0)return s.value.set(t,[l("error.required")]),[!1,[]];for(let[K,M]of n.entries())if(M){let ie=we(M);ie.valid?_.value.find(Ne=>Ne.id===M)&&(a[K]=l("standalone.ipsec_tunnel.ipsec_network_already_used_in_local_networks"),m=!1):(a[K]=l(ie.errMessage),m=!1)}else a[K]=l("error.required"),m=!1;return[m,a]}function Ce(n){if(n==1){const[t,a]=Ie(C.value,"remoteNetworks");r.value=a;const m=_.value.map(M=>we(M.id));return[[[L(N.value)],"name"],[[L(E.value)],"wanIpAddress"],[[L(f.value),He(f.value)],"remoteIpAddress"],[[ze(_.value),m.find(M=>!M.valid)??{valid:!0}],"localNetworks"],[[L(A.value)],"localIdentifier"],[[L(q.value)],"remoteIdentifier"]].map(([M,ie])=>ke(M,ie)).every(M=>M)&&t}else if(n==2){if(D.value==="generate")return!0;{const t=L(H.value);return t.valid?!0:(s.value.set("presharedKey",[l(t.errMessage)]),!1)}}else return[[[L(Q.value)],"ikeVersion"],[[L(X.value)],"ikeEncryptionAlgorithm"],[[L(Y.value)],"ikeIntegrityAlgorithm"],[[L(z.value),xe(z.value)],"ikeKeyLifetime"],[[L(Z.value)],"espEncryptionAlgorithm"],[[L(ee.value)],"espIntegrityAlgorithm"],[[L(G.value),xe(G.value)],"espKeyLifetime"]].map(([a,m])=>ke(a,m)).every(a=>a)}function Ae(){he(),Ce(h.value)&&(h.value==3?Ue():h.value++)}function Re(){h.value==1?ce():h.value--}async function Ue(){u.value.notificationTitle="",u.value.notificationDescription="";const n=V.value!="",t=n?"edit-tunnel":"add-tunnel",a={ns_name:N.value,ike:{hash_algorithm:Y.value,encryption_algorithm:X.value,dh_group:te.value,rekeytime:z.value},esp:{hash_algorithm:ee.value,encryption_algorithm:Z.value,dh_group:oe.value,rekeytime:G.value},ipcomp:J.value?"true":"false",enabled:I.value?"1":"0",dpdaction:W.value?"restart":"none",keyexchange:Q.value,remote_subnet:C.value.filter(m=>m!=""),local_subnet:_.value.filter(m=>m.id!="").map(m=>m.id),gateway:f.value,local_identifier:A.value,remote_identifier:q.value,local_ip:E.value,pre_shared_key:D.value=="import"?H.value:j.value};n&&(a.id=V.value);try{k.value=!0,await B("ns.ipsectunnel",t,a),F("add-edit-tunnel"),ce()}catch(m){u.value.notificationTitle=l(n?"error.cannot_edit_tunnel":"error.cannot_create_tunnel"),u.value.notificationDescription=l(P(m)),u.value.notificationDetails=m.toString()}finally{k.value=!1}}function he(){s.value.clear(),r.value=[]}function ce(){he(),u.value.notificationTitle="",u.value.notificationDescription="",F("close")}return Pe(()=>v.isShown,()=>{v.isShown&&(O.value=!0,Ee().then(()=>{Se().then(()=>{O.value=!1})}))}),(n,t)=>(p(),T(e(qe),{"is-shown":n.isShown,onClose:t[22]||(t[22]=a=>ce()),closeAriaLabel:e(l)("common.shell.close_side_drawer"),title:V.value?e(l)("standalone.ipsec_tunnel.edit_ipsec_tunnel"):e(l)("standalone.ipsec_tunnel.add_ipsec_tunnel")},{default:d(()=>[u.value.notificationTitle?(p(),T(e(Oe),{key:0,title:u.value.notificationTitle,description:u.value.notificationDescription,class:"mb-6",kind:"error"},Me({_:2},[u.value.notificationDetails?{name:"details",fn:d(()=>[w(c(u.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):ne("",!0),O.value?(p(),T(e(Te),{key:1,lines:20})):(p(),y("div",il,[o(ol,{currentStep:h.value,totalSteps:3,stepLabel:e(l)("common.step")},null,8,["currentStep","stepLabel"]),h.value==1?(p(),y(U,{key:0},[g("div",null,[o(e(pe),null,{default:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.status")),1)]),_:1}),o(e(me),{label:I.value?e(l)("standalone.ipsec_tunnel.enabled"):e(l)("standalone.ipsec_tunnel.disabled"),modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=a=>I.value=a)},null,8,["label","modelValue"])]),o(e($),{modelValue:N.value,"onUpdate:modelValue":t[1]||(t[1]=a=>N.value=a),disabled:V.value!="",label:e(l)("standalone.ipsec_tunnel.tunnel_name"),invalidMessage:s.value.getFirstFor("name")},null,8,["modelValue","disabled","label","invalidMessage"]),o(e(S),{modelValue:E.value,"onUpdate:modelValue":t[2]||(t[2]=a=>E.value=a),label:e(l)("standalone.ipsec_tunnel.wan_ip_address"),placeholder:e(l)("standalone.ipsec_tunnel.choose_wan"),invalidMessage:s.value.getFirstFor("wanIpAddress"),options:ye.value,noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","placeholder","invalidMessage","options","noOptionsLabel","noResultsLabel","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e($),{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=a=>f.value=a),label:e(l)("standalone.ipsec_tunnel.remote_ip_address"),invalidMessage:s.value.getFirstFor("remoteIpAddress")},{tooltip:d(()=>[o(e(be),null,{content:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.remote_ip_address_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","invalidMessage"]),o(e(S),{label:e(l)("standalone.ipsec_tunnel.local_networks"),placeholder:e(l)("standalone.ipsec_tunnel.choose_network"),multiple:!0,options:x.value,modelValue:_.value,"onUpdate:modelValue":t[4]||(t[4]=a=>_.value=a),"invalid-message":s.value.getFirstFor("localNetworks"),"no-options-label":e(l)("ne_combobox.no_options_label"),"no-results-label":e(l)("ne_combobox.no_results"),"show-selected-label":!0,"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),"accept-user-input":!0,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),optionalLabel:e(l)("common.optional")},null,8,["label","placeholder","options","modelValue","invalid-message","no-options-label","no-results-label","selected-label","user-input-label","limitedOptionsLabel","optionalLabel"]),o(Ze,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=a=>C.value=a),"add-item-label":e(l)("standalone.ipsec_tunnel.add_network"),title:e(l)("standalone.ipsec_tunnel.remote_networks"),"invalid-messages":r.value,"general-invalid-message":s.value.getFirstFor("remoteNetworks"),onAddItem:t[6]||(t[6]=a=>s.value.delete("remoteNetworks"))},null,8,["modelValue","add-item-label","title","invalid-messages","general-invalid-message"]),o(e($),{modelValue:A.value,"onUpdate:modelValue":t[7]||(t[7]=a=>A.value=a),label:e(l)("standalone.ipsec_tunnel.local_identifier"),invalidMessage:s.value.getFirstFor("localIdentifier")},{tooltip:d(()=>[o(e(be),null,{content:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.local_identifier_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","invalidMessage"]),o(e($),{modelValue:q.value,"onUpdate:modelValue":t[8]||(t[8]=a=>q.value=a),label:e(l)("standalone.ipsec_tunnel.remote_identifier"),invalidMessage:s.value.getFirstFor("remoteIdentifier")},null,8,["modelValue","label","invalidMessage"])],64)):h.value==2?(p(),y(U,{key:1},[V.value?ne("",!0):(p(),T(e(je),{key:0,label:e(l)("standalone.ipsec_tunnel.pre_shared_key"),options:Fe,modelValue:D.value,"onUpdate:modelValue":t[9]||(t[9]=a=>D.value=a),card:!0,"grid-style":"grid-cols-1 sm:grid-cols-2 gap-3"},null,8,["label","modelValue"])),D.value=="import"?(p(),T(e($),{key:1,modelValue:H.value,"onUpdate:modelValue":t[10]||(t[10]=a=>H.value=a),invalidMessage:s.value.getFirstFor("presharedKey"),label:V.value?e(l)("standalone.ipsec_tunnel.pre_shared_key"):""},null,8,["modelValue","invalidMessage","label"])):(p(),T(el,{key:2,value:j.value},null,8,["value"])),g("div",null,[o(e(pe),null,{default:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.dpd_dead_peer_detection")),1)]),_:1}),o(e(me),{label:W.value?e(l)("standalone.ipsec_tunnel.enabled"):e(l)("standalone.ipsec_tunnel.disabled"),modelValue:W.value,"onUpdate:modelValue":t[11]||(t[11]=a=>W.value=a)},null,8,["label","modelValue"])]),g("div",null,[o(e(pe),null,{default:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.compression")),1)]),_:1}),o(e(me),{label:J.value?e(l)("standalone.ipsec_tunnel.enabled"):e(l)("standalone.ipsec_tunnel.disabled"),modelValue:J.value,"onUpdate:modelValue":t[12]||(t[12]=a=>J.value=a)},null,8,["label","modelValue"])])],64)):(p(),y(U,{key:2},[o(e(_e),{tag:"h6",class:"mb-1.5"},{default:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.phase_one_ike")),1)]),_:1}),o(e(S),{modelValue:Q.value,"onUpdate:modelValue":t[13]||(t[13]=a=>Q.value=a),label:e(l)("standalone.ipsec_tunnel.ike_version"),invalidMessage:s.value.getFirstFor("ikeVersion"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:ge,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e(S),{modelValue:X.value,"onUpdate:modelValue":t[14]||(t[14]=a=>X.value=a),label:e(l)("standalone.ipsec_tunnel.encryption_algorithm"),invalidMessage:s.value.getFirstFor("ikeEncryptionAlgorithm"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:ue.value,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e(S),{modelValue:Y.value,"onUpdate:modelValue":t[15]||(t[15]=a=>Y.value=a),label:e(l)("standalone.ipsec_tunnel.integrity_algorithm"),invalidMessage:s.value.getFirstFor("ikeIntegrityAlgorithm"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:re.value,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e(S),{modelValue:te.value,"onUpdate:modelValue":t[16]||(t[16]=a=>te.value=a),label:e(l)("standalone.ipsec_tunnel.diffie_hellman_group"),invalidMessage:s.value.getFirstFor("ikeDiffieHellmanGroup"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:de.value.filter(a=>a.id!=""),limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e($),{modelValue:z.value,"onUpdate:modelValue":t[17]||(t[17]=a=>z.value=a),type:"number",label:e(l)("standalone.ipsec_tunnel.key_life_time_seconds"),invalidMessage:s.value.getFirstFor("ikeKeyLifetime")},null,8,["modelValue","label","invalidMessage"]),o(e(_e),{tag:"h6",class:"mb-1.5"},{default:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.phase_two_esp")),1)]),_:1}),o(e(S),{modelValue:Z.value,"onUpdate:modelValue":t[18]||(t[18]=a=>Z.value=a),label:e(l)("standalone.ipsec_tunnel.encryption_algorithm"),invalidMessage:s.value.getFirstFor("espEncryptionAlgorithm"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:ue.value,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e(S),{modelValue:ee.value,"onUpdate:modelValue":t[19]||(t[19]=a=>ee.value=a),label:e(l)("standalone.ipsec_tunnel.integrity_algorithm"),invalidMessage:s.value.getFirstFor("espIntegrityAlgorithm"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:re.value,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},null,8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e(S),{modelValue:oe.value,"onUpdate:modelValue":t[20]||(t[20]=a=>oe.value=a),label:e(l)("standalone.ipsec_tunnel.diffie_hellman_group_pfs"),invalidMessage:s.value.getFirstFor("espDiffieHellmanGroup"),noOptionsLabel:e(l)("ne_combobox.no_options_label"),noResultsLabel:e(l)("ne_combobox.no_results"),options:de.value,limitedOptionsLabel:e(l)("ne_combobox.limited_options_label"),"selected-label":e(l)("ne_combobox.selected"),"user-input-label":e(l)("ne_combobox.user_input_label"),optionalLabel:e(l)("common.optional")},{tooltip:d(()=>[o(e(be),null,{content:d(()=>[w(c(e(l)("standalone.ipsec_tunnel.diffie_hellman_group_tooltip")),1)]),_:1})]),_:1},8,["modelValue","label","invalidMessage","noOptionsLabel","noResultsLabel","options","limitedOptionsLabel","selected-label","user-input-label","optionalLabel"]),o(e($),{modelValue:G.value,"onUpdate:modelValue":t[21]||(t[21]=a=>G.value=a),type:"number",label:e(l)("standalone.ipsec_tunnel.key_life_time_seconds"),invalidMessage:s.value.getFirstFor("espKeyLifetime")},null,8,["modelValue","label","invalidMessage"])],64)),t[23]||(t[23]=g("hr",null,null,-1)),g("div",sl,[o(e(le),{kind:"tertiary",class:"mr-4",onClick:Re},{default:d(()=>[w(c(h.value==1?e(l)("common.cancel"):e(l)("common.previous")),1)]),_:1}),o(e(le),{kind:"primary",onClick:Ae,disabled:k.value,loading:k.value},{default:d(()=>[w(c(h.value===3?V.value?e(l)("common.save"):e(l)("standalone.ipsec_tunnel.add_tunnel"):e(l)("common.next")),1)]),_:1},8,["disabled","loading"])])]))]),_:1},8,["is-shown","closeAriaLabel","title"]))}}),rl={class:"flex flex-col"},dl={class:"flex flex-col justify-between md:flex-row md:items-center"},cl={class:"mb-6 text-sm text-gray-500 dark:text-gray-400"},pl={class:"space-y-6"},ml={class:"flex flex-col items-start justify-between gap-6 lg:flex-row"},bl={class:"max-w-2xl text-sm font-normal text-gray-500 dark:text-gray-400"},vl={key:0,class:"flex shrink-0 flex-col gap-x-0 gap-y-2 sm:flex-row sm:gap-x-2 sm:gap-y-0"},Ve=1e4,xl=se({__name:"IPsecTunnelView",setup(ae){const{t:b}=fe(),v=Ge(),l=i(!0),F=i([]),O=i(null),k=i(!1),u=i(!1),h=i(0),s=i({notificationTitle:"",notificationDescription:"",notificationDetails:""});async function r(f=!0){try{f&&(l.value=!0),F.value=(await B("ns.ipsectunnel","list-tunnels")).data.tunnels,l.value=!1}catch(_){s.value.notificationTitle=b("error.cannot_retrieve_ipsec_tunnels"),s.value.notificationDescription=b(P(_)),s.value.notificationDetails=_.toString()}finally{f&&(l.value=!1)}}function x(f){O.value=f,k.value=!0}function V(f){O.value=f,u.value=!0}function j(){O.value=null,u.value=!1,k.value=!1}function I(){s.value={notificationTitle:"",notificationDescription:"",notificationDetails:""}}async function N(f){try{I(),await B("ns.ipsectunnel",f.enabled==="1"?"disable-tunnel":"enable-tunnel",{id:f.id}),await E()}catch(_){s.value.notificationTitle=b(f.enabled?"error.cannot_disable_tunnel":"error.cannot_enable_tunnel"),s.value.notificationDescription=b(P(_)),s.value.notificationDetails=_.toString()}}async function E(){I(),await r(),await v.getChanges()}return We(()=>{r(),h.value=setInterval(()=>r(!1),Ve)}),Je(()=>{h.value&&clearInterval(h.value)}),(f,_)=>{const C=Le("font-awesome-icon");return p(),y(U,null,[g("div",rl,[g("div",dl,[o(e(_e),{tag:"h3",class:"mb-7"},{default:d(()=>[w(c(e(b)("standalone.ipsec_tunnel.title")),1)]),_:1}),g("div",cl,c(e(b)("common.data_updated_every_seconds",{seconds:Ve/1e3})),1)]),g("div",pl,[g("div",ml,[g("p",bl,c(e(b)("standalone.ipsec_tunnel.description")),1),F.value.length>0?(p(),y("div",vl,[o(e(le),{kind:"secondary",onClick:_[0]||(_[0]=A=>x(null))},{prefix:d(()=>[o(C,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:d(()=>[w(" "+c(e(b)("standalone.ipsec_tunnel.add_ipsec_tunnel")),1)]),_:1})])):ne("",!0)]),s.value.notificationTitle?(p(),T(e(Oe),{key:0,kind:"error",title:s.value.notificationTitle,description:s.value.notificationDescription},Me({_:2},[s.value.notificationDetails?{name:"details",fn:d(()=>[w(c(s.value.notificationDetails),1)]),key:"0"}:void 0]),1032,["title","description"])):ne("",!0),l.value?(p(),T(e(Te),{key:1,lines:8,size:"lg"})):(p(),y(U,{key:2},[F.value.length==0?(p(),T(e(Qe),{key:0,title:e(b)("standalone.ipsec_tunnel.no_tunnel_found"),icon:["fas","globe"]},{default:d(()=>[o(e(le),{kind:"primary",onClick:_[1]||(_[1]=A=>x(null))},{prefix:d(()=>[o(C,{icon:["fas","circle-plus"],class:"h-4 w-4","aria-hidden":"true"})]),default:d(()=>[w(c(e(b)("standalone.ipsec_tunnel.add_ipsec_tunnel")),1)]),_:1})]),_:1},8,["title"])):(p(),T(nl,{key:1,tunnels:F.value,onTunnelDelete:V,onTunnelEdit:x,onTunnelToggleEnable:N},null,8,["tunnels"]))],64))])]),o(Ye,{visible:u.value,"item-to-delete":O.value,onClose:j,onTunnelDeleted:E},null,8,["visible","item-to-delete"]),o(ul,{"item-to-edit":O.value,onClose:j,onAddEditTunnel:E,"is-shown":k.value},null,8,["item-to-edit","is-shown"])],64)}}});export{xl as default};
